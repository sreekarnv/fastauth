{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"FastAuth","text":"<p>Production-ready authentication for FastAPI applications</p> <p>FastAuth is a flexible, database-agnostic authentication library for FastAPI that provides secure user authentication, session management, role-based access control, and OAuth 2.0 integration out of the box.</p> <p> </p>"},{"location":"#features","title":"Features","text":""},{"location":"#authentication","title":"\ud83d\udd10 Authentication","text":"<ul> <li>Complete Auth Flow - Registration, login, logout, token refresh</li> <li>Email Verification - Secure email verification with expiring tokens</li> <li>Password Reset - Self-service password reset via email</li> <li>Refresh Tokens - Long-lived refresh tokens with automatic rotation</li> <li>OAuth 2.0 - Third-party authentication (Google, GitHub, etc.)</li> </ul>"},{"location":"#authorization","title":"\ud83d\udc65 Authorization","text":"<ul> <li>RBAC - Role-Based Access Control with permissions</li> <li>Route Protection - Decorator-based route protection</li> <li>Flexible Permissions - Fine-grained permission system</li> </ul>"},{"location":"#session-management","title":"\ud83d\udd27 Session Management","text":"<ul> <li>Multi-Device Support - Track sessions across devices</li> <li>Device Fingerprinting - IP, user agent, device tracking</li> <li>Session Revocation - Individual or bulk session termination</li> <li>Inactive Cleanup - Automatic cleanup of stale sessions</li> </ul>"},{"location":"#account-management","title":"\ud83d\udc64 Account Management","text":"<ul> <li>Password Change - Secure password updates</li> <li>Email Change - Verified email change flow</li> <li>Account Deletion - Soft delete (deactivation) or hard delete</li> <li>OAuth Linking - Link/unlink OAuth accounts</li> </ul>"},{"location":"#security","title":"\ud83d\udee1\ufe0f Security","text":"<ul> <li>Argon2 Hashing - Industry-standard password hashing</li> <li>JWT Tokens - Secure, stateless authentication</li> <li>Rate Limiting - Built-in brute-force protection</li> <li>CSRF Protection - OAuth state tokens</li> <li>PKCE Support - Enhanced OAuth security</li> </ul>"},{"location":"#database-support","title":"\ud83d\uddc4\ufe0f Database Support","text":"<ul> <li>Database Agnostic - Adapter pattern for any database</li> <li>SQLAlchemy - Full SQLAlchemy adapter included</li> <li>Custom Adapters - Easy to implement for MongoDB, etc.</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code>pip install sreekarnv-fastauth\n</code></pre>"},{"location":"#basic-setup","title":"Basic Setup","text":"<pre><code>from fastapi import FastAPI, Depends\nfrom sqlmodel import Session, SQLModel, create_engine\nfrom fastauth import auth_router, sessions_router\nfrom fastauth.api import dependencies\nfrom fastauth.adapters.sqlalchemy.models import User\n\n# Database setup\nDATABASE_URL = \"sqlite:///./app.db\"\nengine = create_engine(DATABASE_URL)\n\ndef init_db():\n    SQLModel.metadata.create_all(engine)\n\ndef get_session():\n    with Session(engine) as session:\n        yield session\n\n# Create app\napp = FastAPI(title=\"My Auth App\")\n\n# Initialize database\n@app.on_event(\"startup\")\ndef on_startup():\n    init_db()\n\n# Include routers\napp.include_router(auth_router)\napp.include_router(sessions_router)\n\n# Override dependencies\napp.dependency_overrides[dependencies.get_session] = get_session\n\n# Protected route\nfrom fastauth.api.dependencies import get_current_user\n\n@app.get(\"/protected\")\ndef protected_route(current_user: User = Depends(get_current_user)):\n    return {\"message\": f\"Hello {current_user.email}!\"}\n</code></pre>"},{"location":"#environment-variables","title":"Environment Variables","text":"<p>Create <code>.env</code>:</p> <pre><code>JWT_SECRET_KEY=your-secret-key\nREQUIRE_EMAIL_VERIFICATION=false\nEMAIL_PROVIDER=console\n</code></pre>"},{"location":"#run-the-application","title":"Run the Application","text":"<pre><code>uvicorn main:app --reload\n</code></pre> <p>Visit http://localhost:8000/docs to see the interactive API documentation.</p>"},{"location":"#whats-next","title":"What's Next?","text":"<ul> <li> <p> Quick Start Guide</p> <p>Get up and running in 10 minutes with our comprehensive quick start guide.</p> <p> Quick Start</p> </li> <li> <p> Architecture</p> <p>Understand FastAuth's design principles and architecture.</p> <p> Architecture</p> </li> <li> <p> OAuth Integration</p> <p>Add Google, GitHub, and other OAuth providers to your application.</p> <p> OAuth Guide</p> </li> <li> <p> API Reference</p> <p>Complete API documentation auto-generated from code.</p> <p> API Reference</p> </li> </ul>"},{"location":"#key-concepts","title":"Key Concepts","text":""},{"location":"#database-agnostic","title":"Database Agnostic","text":"<p>FastAuth's core business logic has zero dependencies on any specific database. All database operations go through abstract adapter interfaces, making it easy to swap databases or implement custom storage solutions.</p> <pre><code># Use SQLAlchemy\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyUserAdapter\n\n# Or implement your own\nclass MongoDBUserAdapter(UserAdapter):\n    def get_by_email(self, email: str):\n        return self.collection.find_one({\"email\": email})\n</code></pre>"},{"location":"#dependency-injection","title":"Dependency Injection","text":"<p>Built on FastAPI's dependency injection system for maximum flexibility:</p> <pre><code>from fastapi import Depends\nfrom fastauth.api.dependencies import get_current_user\n\n@app.get(\"/profile\")\ndef get_profile(user = Depends(get_current_user)):\n    return {\"email\": user.email}\n</code></pre>"},{"location":"#type-safety","title":"Type Safety","text":"<p>Full type hints and Pydantic validation throughout:</p> <pre><code>from fastauth.api.schemas import RegisterRequest\n\n@app.post(\"/register\")\ndef register(payload: RegisterRequest):\n    # payload.email and payload.password are validated\n    ...\n</code></pre>"},{"location":"#why-fastauth","title":"Why FastAuth?","text":"<ul> <li>Production Ready: 85% test coverage, comprehensive error handling, security best practices</li> <li>Flexible: Database-agnostic core, customizable adapters, extensible architecture</li> <li>Complete: Authentication, authorization, sessions, account management, OAuth - all included</li> <li>Modern: Built for FastAPI, uses latest Python features, async-ready</li> <li>Well Documented: Auto-generated API docs, comprehensive guides, real-world examples</li> </ul>"},{"location":"#statistics","title":"Statistics","text":"TestsFeaturesCode Quality <ul> <li>195 tests passing</li> <li>85% coverage</li> <li>CI/CD with GitHub Actions</li> <li>Multiple Python versions (3.11, 3.12, 3.13)</li> </ul> <ul> <li>8 auth endpoints</li> <li>4 session endpoints</li> <li>4 account endpoints</li> <li>4 OAuth endpoints</li> <li>RBAC with roles &amp; permissions</li> </ul> <ul> <li>Type hints throughout</li> <li>Linted with Ruff</li> <li>Formatted with Black</li> <li>Pre-commit hooks configured</li> </ul>"},{"location":"#community","title":"Community","text":"<ul> <li>GitHub: sreekarnv/fastauth</li> <li>Issues: Report bugs or request features</li> <li>Discussions: Ask questions or share ideas</li> <li>PyPI: fastauth</li> </ul>"},{"location":"#license","title":"License","text":"<p>FastAuth is released under the MIT License.</p> <p>Ready to get started? Head over to the Quick Start Guide \u2192</p>"},{"location":"api-reference/","title":"API Reference","text":"<p>Complete reference for FastAuth's public API.</p>"},{"location":"api-reference/#core-module","title":"Core Module","text":""},{"location":"api-reference/#fastauthcoreusers","title":"<code>fastauth.core.users</code>","text":"<p>User management functions.</p>"},{"location":"api-reference/#create_userusers-email-password","title":"<code>create_user(users, email, password)</code>","text":"<p>Create a new user with a hashed password.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter for database operations - <code>email</code> (str): User's email address - <code>password</code> (str): Plain text password (will be hashed)</p> <p>Returns: - User object</p> <p>Raises: - <code>UserAlreadyExistsError</code>: If a user with the email already exists</p> <p>Example: <pre><code>from fastauth.core.users import create_user\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyUserAdapter\n\nuser = create_user(\n    users=user_adapter,\n    email=\"user@example.com\",\n    password=\"securepassword123\"\n)\n</code></pre></p>"},{"location":"api-reference/#authenticate_userusers-email-password","title":"<code>authenticate_user(users, email, password)</code>","text":"<p>Authenticate a user by email and password.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter for database operations - <code>email</code> (str): User's email address - <code>password</code> (str): Plain text password to verify</p> <p>Returns: - User object</p> <p>Raises: - <code>InvalidCredentialsError</code>: If email doesn't exist, password is wrong, or user is inactive - <code>EmailNotVerifiedError</code>: If email verification is required but not completed</p> <p>Example: <pre><code>from fastauth.core.users import authenticate_user\n\nuser = authenticate_user(\n    users=user_adapter,\n    email=\"user@example.com\",\n    password=\"securepassword123\"\n)\n</code></pre></p>"},{"location":"api-reference/#fastauthcorerefresh_tokens","title":"<code>fastauth.core.refresh_tokens</code>","text":"<p>Refresh token management.</p>"},{"location":"api-reference/#create_refresh_tokenrefresh_tokens-user_id-expires_delta","title":"<code>create_refresh_token(refresh_tokens, user_id, expires_delta)</code>","text":"<p>Create a new refresh token for a user.</p> <p>Parameters: - <code>refresh_tokens</code> (RefreshTokenAdapter): Refresh token adapter - <code>user_id</code> (UUID): User's unique identifier - <code>expires_delta</code> (timedelta, optional): Token expiration time</p> <p>Returns: - Tuple of (token string, token hash)</p>"},{"location":"api-reference/#refresh_access_tokenrefresh_tokens-users-refresh_token_str","title":"<code>refresh_access_token(refresh_tokens, users, refresh_token_str)</code>","text":"<p>Generate new access token using a refresh token.</p> <p>Parameters: - <code>refresh_tokens</code> (RefreshTokenAdapter): Refresh token adapter - <code>users</code> (UserAdapter): User adapter - <code>refresh_token_str</code> (str): Refresh token string</p> <p>Returns: - Dict with new access_token and refresh_token</p> <p>Raises: - <code>RefreshTokenError</code>: If token is invalid or expired</p>"},{"location":"api-reference/#fastauthcorepassword_reset","title":"<code>fastauth.core.password_reset</code>","text":"<p>Password reset functionality.</p>"},{"location":"api-reference/#request_password_resetusers-password_resets-email","title":"<code>request_password_reset(users, password_resets, email)</code>","text":"<p>Request a password reset token.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter - <code>password_resets</code> (PasswordResetAdapter): Password reset adapter - <code>email</code> (str): User's email address</p> <p>Returns: - Password reset token string</p>"},{"location":"api-reference/#confirm_password_resetusers-password_resets-token-new_password","title":"<code>confirm_password_reset(users, password_resets, token, new_password)</code>","text":"<p>Reset password using a valid token.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter - <code>password_resets</code> (PasswordResetAdapter): Password reset adapter - <code>token</code> (str): Password reset token - <code>new_password</code> (str): New password (plain text)</p> <p>Raises: - <code>PasswordResetError</code>: If token is invalid or expired</p>"},{"location":"api-reference/#fastauthcoreemail_verification","title":"<code>fastauth.core.email_verification</code>","text":"<p>Email verification functionality.</p>"},{"location":"api-reference/#send_verification_emailusers-email_verifications-email_provider-user_id","title":"<code>send_verification_email(users, email_verifications, email_provider, user_id)</code>","text":"<p>Send email verification token to user.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter - <code>email_verifications</code> (EmailVerificationAdapter): Email verification adapter - <code>email_provider</code>: Email provider instance - <code>user_id</code> (UUID): User's unique identifier</p> <p>Returns: - Verification token string</p>"},{"location":"api-reference/#verify_emailusers-email_verifications-token","title":"<code>verify_email(users, email_verifications, token)</code>","text":"<p>Verify user's email with token.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter - <code>email_verifications</code> (EmailVerificationAdapter): Email verification adapter - <code>token</code> (str): Verification token</p> <p>Raises: - <code>EmailVerificationError</code>: If token is invalid or expired</p>"},{"location":"api-reference/#fastauthcoreroles","title":"<code>fastauth.core.roles</code>","text":"<p>Role-Based Access Control (RBAC) functions.</p>"},{"location":"api-reference/#create_roleroles-name-description","title":"<code>create_role(roles, name, description)</code>","text":"<p>Create a new role.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>name</code> (str): Unique role name - <code>description</code> (str, optional): Role description</p> <p>Returns: - Role object</p> <p>Raises: - <code>RoleAlreadyExistsError</code>: If a role with the name already exists</p> <p>Example: <pre><code>from fastauth.core.roles import create_role\n\nadmin_role = create_role(\n    roles=role_adapter,\n    name=\"admin\",\n    description=\"Administrator role\"\n)\n</code></pre></p>"},{"location":"api-reference/#create_permissionroles-name-description","title":"<code>create_permission(roles, name, description)</code>","text":"<p>Create a new permission.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>name</code> (str): Unique permission name - <code>description</code> (str, optional): Permission description</p> <p>Returns: - Permission object</p> <p>Raises: - <code>PermissionAlreadyExistsError</code>: If a permission with the name already exists</p>"},{"location":"api-reference/#assign_roleroles-user_id-role_name","title":"<code>assign_role(roles, user_id, role_name)</code>","text":"<p>Assign a role to a user.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>role_name</code> (str): Name of the role to assign</p> <p>Raises: - <code>RoleNotFoundError</code>: If the role does not exist</p> <p>Example: <pre><code>from fastauth.core.roles import assign_role\n\nassign_role(\n    roles=role_adapter,\n    user_id=user.id,\n    role_name=\"admin\"\n)\n</code></pre></p>"},{"location":"api-reference/#remove_roleroles-user_id-role_name","title":"<code>remove_role(roles, user_id, role_name)</code>","text":"<p>Remove a role from a user.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>role_name</code> (str): Name of the role to remove</p> <p>Raises: - <code>RoleNotFoundError</code>: If the role does not exist</p>"},{"location":"api-reference/#assign_permission_to_roleroles-role_name-permission_name","title":"<code>assign_permission_to_role(roles, role_name, permission_name)</code>","text":"<p>Assign a permission to a role.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>role_name</code> (str): Name of the role - <code>permission_name</code> (str): Name of the permission to assign</p> <p>Raises: - <code>RoleNotFoundError</code>: If the role does not exist - <code>PermissionNotFoundError</code>: If the permission does not exist</p>"},{"location":"api-reference/#check_permissionroles-user_id-permission_name","title":"<code>check_permission(roles, user_id, permission_name)</code>","text":"<p>Check if a user has a specific permission through any of their roles.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>permission_name</code> (str): Name of the permission to check</p> <p>Returns: - bool: True if user has the permission, False otherwise</p> <p>Example: <pre><code>from fastauth.core.roles import check_permission\n\nhas_access = check_permission(\n    roles=role_adapter,\n    user_id=user.id,\n    permission_name=\"delete:users\"\n)\n</code></pre></p>"},{"location":"api-reference/#get_user_rolesroles-user_id","title":"<code>get_user_roles(roles, user_id)</code>","text":"<p>Get all roles assigned to a user.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>user_id</code> (UUID): User's unique identifier</p> <p>Returns: - List of role objects</p>"},{"location":"api-reference/#get_user_permissionsroles-user_id","title":"<code>get_user_permissions(roles, user_id)</code>","text":"<p>Get all permissions for a user across all their roles.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>user_id</code> (UUID): User's unique identifier</p> <p>Returns: - List of permission objects</p>"},{"location":"api-reference/#get_role_permissionsroles-role_name","title":"<code>get_role_permissions(roles, role_name)</code>","text":"<p>Get all permissions assigned to a role.</p> <p>Parameters: - <code>roles</code> (RoleAdapter): Role adapter for database operations - <code>role_name</code> (str): Name of the role</p> <p>Returns: - List of permission objects</p> <p>Raises: - <code>RoleNotFoundError</code>: If the role does not exist</p>"},{"location":"api-reference/#fastauthcoresessions","title":"<code>fastauth.core.sessions</code>","text":"<p>Session management functions.</p>"},{"location":"api-reference/#create_sessionsessions-users-user_id-device-ip_address-user_agent","title":"<code>create_session(sessions, users, user_id, device, ip_address, user_agent)</code>","text":"<p>Create a new session for a user and update their last login timestamp.</p> <p>Parameters: - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>users</code> (UserAdapter): User adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>device</code> (str, optional): Device information - <code>ip_address</code> (str, optional): IP address of the client - <code>user_agent</code> (str, optional): User agent string</p> <p>Returns: - Session object</p> <p>Example: <pre><code>from fastauth.core.sessions import create_session\n\nsession = create_session(\n    sessions=session_adapter,\n    users=user_adapter,\n    user_id=user.id,\n    device=\"iPhone 13\",\n    ip_address=\"192.168.1.1\",\n    user_agent=\"Mozilla/5.0\"\n)\n</code></pre></p>"},{"location":"api-reference/#get_user_sessionssessions-user_id","title":"<code>get_user_sessions(sessions, user_id)</code>","text":"<p>Get all active sessions for a user.</p> <p>Parameters: - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>user_id</code> (UUID): User's unique identifier</p> <p>Returns: - List of session objects</p> <p>Example: <pre><code>from fastauth.core.sessions import get_user_sessions\n\nsessions_list = get_user_sessions(\n    sessions=session_adapter,\n    user_id=user.id\n)\n</code></pre></p>"},{"location":"api-reference/#delete_sessionsessions-session_id-user_id","title":"<code>delete_session(sessions, session_id, user_id)</code>","text":"<p>Delete a specific session with ownership verification.</p> <p>Parameters: - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>session_id</code> (UUID): Session's unique identifier - <code>user_id</code> (UUID): User's unique identifier (for authorization)</p> <p>Raises: - <code>SessionNotFoundError</code>: If session doesn't exist or doesn't belong to user</p> <p>Example: <pre><code>from fastauth.core.sessions import delete_session\n\ndelete_session(\n    sessions=session_adapter,\n    session_id=session_id,\n    user_id=user.id\n)\n</code></pre></p>"},{"location":"api-reference/#delete_all_user_sessionssessions-user_id-except_session_id","title":"<code>delete_all_user_sessions(sessions, user_id, except_session_id)</code>","text":"<p>Delete all sessions for a user, optionally excluding the current session.</p> <p>Parameters: - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>except_session_id</code> (UUID, optional): Session ID to keep (current session)</p> <p>Example: <pre><code>from fastauth.core.sessions import delete_all_user_sessions\n\n# Delete all sessions except current\ndelete_all_user_sessions(\n    sessions=session_adapter,\n    user_id=user.id,\n    except_session_id=current_session_id\n)\n\n# Delete all sessions\ndelete_all_user_sessions(\n    sessions=session_adapter,\n    user_id=user.id\n)\n</code></pre></p>"},{"location":"api-reference/#update_session_activitysessions-session_id","title":"<code>update_session_activity(sessions, session_id)</code>","text":"<p>Update the last active timestamp for a session.</p> <p>Parameters: - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>session_id</code> (UUID): Session's unique identifier</p>"},{"location":"api-reference/#cleanup_inactive_sessionssessions-inactive_days","title":"<code>cleanup_inactive_sessions(sessions, inactive_days)</code>","text":"<p>Remove sessions that haven't been active for a specified number of days.</p> <p>Parameters: - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>inactive_days</code> (int): Number of days of inactivity before cleanup (default: 30)</p> <p>Example: <pre><code>from fastauth.core.sessions import cleanup_inactive_sessions\n\n# Remove sessions inactive for 30+ days\ncleanup_inactive_sessions(\n    sessions=session_adapter,\n    inactive_days=30\n)\n</code></pre></p>"},{"location":"api-reference/#fastauthcoreoauth","title":"<code>fastauth.core.oauth</code>","text":"<p>OAuth 2.0 authentication functions.</p>"},{"location":"api-reference/#initiate_oauth_flowoauth_states-provider-redirect_uri-state_data-use_pkce","title":"<code>initiate_oauth_flow(oauth_states, provider, redirect_uri, state_data, use_pkce)</code>","text":"<p>Initiate an OAuth 2.0 authorization flow.</p> <p>Parameters: - <code>oauth_states</code> (OAuthStateAdapter): OAuth state adapter for database operations - <code>provider</code> (OAuthProvider): OAuth provider instance (e.g., GoogleOAuthProvider) - <code>redirect_uri</code> (str): Callback URL after OAuth authorization - <code>state_data</code> (dict, optional): Additional data to store in state - <code>use_pkce</code> (bool): Whether to use PKCE (Proof Key for Code Exchange) (default: False)</p> <p>Returns: - Dict with <code>authorization_url</code> (str) and <code>state</code> (str)</p> <p>Example: <pre><code>from fastauth.core.oauth import initiate_oauth_flow\nfrom fastauth.providers import GoogleOAuthProvider\n\nprovider = GoogleOAuthProvider(\n    client_id=\"your-client-id\",\n    client_secret=\"your-client-secret\"\n)\n\nresult = initiate_oauth_flow(\n    oauth_states=oauth_state_adapter,\n    provider=provider,\n    redirect_uri=\"http://localhost:8000/auth/oauth/google/callback\",\n    use_pkce=True\n)\n# result = {\"authorization_url\": \"https://...\", \"state\": \"...\"}\n</code></pre></p>"},{"location":"api-reference/#complete_oauth_flowoauth_states-oauth_accounts-users-provider-code-state-link_user_id","title":"<code>complete_oauth_flow(oauth_states, oauth_accounts, users, provider, code, state, link_user_id)</code>","text":"<p>Complete an OAuth 2.0 authorization flow and create or link account.</p> <p>Parameters: - <code>oauth_states</code> (OAuthStateAdapter): OAuth state adapter - <code>oauth_accounts</code> (OAuthAccountAdapter): OAuth account adapter - <code>users</code> (UserAdapter): User adapter - <code>provider</code> (OAuthProvider): OAuth provider instance - <code>code</code> (str): Authorization code from OAuth provider - <code>state</code> (str): State token to validate - <code>link_user_id</code> (UUID, optional): User ID to link account to (if authenticated)</p> <p>Returns: - Tuple of (User object, bool indicating if new user was created)</p> <p>Raises: - <code>OAuthError</code>: If state is invalid, expired, or code exchange fails</p> <p>Example: <pre><code>from fastauth.core.oauth import complete_oauth_flow\n\nuser, is_new = await complete_oauth_flow(\n    oauth_states=oauth_state_adapter,\n    oauth_accounts=oauth_account_adapter,\n    users=user_adapter,\n    provider=provider,\n    code=\"authorization_code\",\n    state=\"state_token\"\n)\n</code></pre></p>"},{"location":"api-reference/#get_linked_accountsoauth_accounts-user_id","title":"<code>get_linked_accounts(oauth_accounts, user_id)</code>","text":"<p>Get all OAuth accounts linked to a user.</p> <p>Parameters: - <code>oauth_accounts</code> (OAuthAccountAdapter): OAuth account adapter - <code>user_id</code> (UUID): User's unique identifier</p> <p>Returns: - List of OAuthAccount objects</p> <p>Example: <pre><code>from fastauth.core.oauth import get_linked_accounts\n\naccounts = get_linked_accounts(\n    oauth_accounts=oauth_account_adapter,\n    user_id=user.id\n)\n</code></pre></p>"},{"location":"api-reference/#unlink_oauth_accountoauth_accounts-account_id-user_id","title":"<code>unlink_oauth_account(oauth_accounts, account_id, user_id)</code>","text":"<p>Unlink an OAuth account from a user.</p> <p>Parameters: - <code>oauth_accounts</code> (OAuthAccountAdapter): OAuth account adapter - <code>account_id</code> (UUID): OAuth account's unique identifier - <code>user_id</code> (UUID): User's unique identifier (for authorization)</p> <p>Raises: - <code>OAuthAccountNotFoundError</code>: If account doesn't exist or doesn't belong to user</p> <p>Example: <pre><code>from fastauth.core.oauth import unlink_oauth_account\n\nunlink_oauth_account(\n    oauth_accounts=oauth_account_adapter,\n    account_id=account_id,\n    user_id=user.id\n)\n</code></pre></p>"},{"location":"api-reference/#fastauthcoreaccount","title":"<code>fastauth.core.account</code>","text":"<p>Account management functions for authenticated users.</p>"},{"location":"api-reference/#change_passwordusers-sessions-user_id-current_password-new_password-current_session_id","title":"<code>change_password(users, sessions, user_id, current_password, new_password, current_session_id)</code>","text":"<p>Change a user's password with verification.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter for database operations - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>current_password</code> (str): Current password for verification - <code>new_password</code> (str): New password to set - <code>current_session_id</code> (UUID, optional): Session ID to preserve during logout</p> <p>Raises: - <code>UserNotFoundError</code>: If the user doesn't exist - <code>InvalidPasswordError</code>: If the current password is incorrect</p> <p>Example: <pre><code>from fastauth.core.account import change_password\n\nchange_password(\n    users=user_adapter,\n    sessions=session_adapter,\n    user_id=user.id,\n    current_password=\"old_password\",\n    new_password=\"new_password\",\n    current_session_id=current_session.id  # Optional: preserve current session\n)\n</code></pre></p> <p>Note: Automatically invalidates all other sessions for security.</p>"},{"location":"api-reference/#delete_accountusers-sessions-user_id-password-hard_delete","title":"<code>delete_account(users, sessions, user_id, password, hard_delete)</code>","text":"<p>Delete a user account with soft or hard delete.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter for database operations - <code>sessions</code> (SessionAdapter): Session adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>password</code> (str): Password for verification - <code>hard_delete</code> (bool): If True, permanently delete; if False, soft delete (default: False)</p> <p>Raises: - <code>UserNotFoundError</code>: If the user doesn't exist - <code>InvalidPasswordError</code>: If the password is incorrect</p> <p>Example: <pre><code>from fastauth.core.account import delete_account\n\n# Soft delete (deactivate account, preserve data)\ndelete_account(\n    users=user_adapter,\n    sessions=session_adapter,\n    user_id=user.id,\n    password=\"user_password\",\n    hard_delete=False\n)\n\n# Hard delete (permanent removal)\ndelete_account(\n    users=user_adapter,\n    sessions=session_adapter,\n    user_id=user.id,\n    password=\"user_password\",\n    hard_delete=True\n)\n</code></pre></p> <p>Note: Soft delete sets <code>deleted_at</code> timestamp and deactivates account. Hard delete permanently removes user from database. Both invalidate all sessions.</p>"},{"location":"api-reference/#request_email_changeusers-email_changes-user_id-new_email-expires_in_minutes","title":"<code>request_email_change(users, email_changes, user_id, new_email, expires_in_minutes)</code>","text":"<p>Request an email change with verification token.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter for database operations - <code>email_changes</code> (EmailChangeAdapter): Email change adapter for database operations - <code>user_id</code> (UUID): User's unique identifier - <code>new_email</code> (str): New email address - <code>expires_in_minutes</code> (int): Token expiration time in minutes (default: 60)</p> <p>Returns: - Verification token string if successful, None if user not found</p> <p>Raises: - <code>EmailAlreadyExistsError</code>: If the new email already exists</p> <p>Example: <pre><code>from fastauth.core.account import request_email_change\n\ntoken = request_email_change(\n    users=user_adapter,\n    email_changes=email_change_adapter,\n    user_id=user.id,\n    new_email=\"newemail@example.com\",\n    expires_in_minutes=60\n)\n</code></pre></p>"},{"location":"api-reference/#confirm_email_changeusers-email_changes-token","title":"<code>confirm_email_change(users, email_changes, token)</code>","text":"<p>Confirm an email change with verification token.</p> <p>Parameters: - <code>users</code> (UserAdapter): User adapter for database operations - <code>email_changes</code> (EmailChangeAdapter): Email change adapter for database operations - <code>token</code> (str): Verification token</p> <p>Raises: - <code>EmailChangeError</code>: If token is invalid or expired - <code>EmailAlreadyExistsError</code>: If the new email is no longer available</p> <p>Example: <pre><code>from fastauth.core.account import confirm_email_change\n\nconfirm_email_change(\n    users=user_adapter,\n    email_changes=email_change_adapter,\n    token=verification_token\n)\n</code></pre></p> <p>Note: Email change resets <code>is_verified</code> to False, requiring re-verification.</p>"},{"location":"api-reference/#adapters","title":"Adapters","text":""},{"location":"api-reference/#base-adapters","title":"Base Adapters","text":""},{"location":"api-reference/#useradapter","title":"<code>UserAdapter</code>","text":"<p>Abstract base class for user database operations.</p> <p>Methods: - <code>get_by_email(email)</code> - Retrieve user by email - <code>get_by_id(user_id)</code> - Retrieve user by ID - <code>create_user(email, hashed_password)</code> - Create new user - <code>mark_verified(user_id)</code> - Mark email as verified - <code>set_password(user_id, new_password)</code> - Update password - <code>update_last_login(user_id)</code> - Update last login timestamp - <code>update_email(user_id, new_email)</code> - Update user's email address - <code>soft_delete_user(user_id)</code> - Soft delete user (set deleted_at timestamp) - <code>hard_delete_user(user_id)</code> - Permanently delete user from database</p>"},{"location":"api-reference/#refreshtokenadapter","title":"<code>RefreshTokenAdapter</code>","text":"<p>Abstract base class for refresh token operations.</p> <p>Methods: - <code>create(user_id, token_hash, expires_at)</code> - Create refresh token - <code>get_active(token_hash)</code> - Get active token by hash - <code>revoke(token_hash)</code> - Revoke a token</p>"},{"location":"api-reference/#passwordresetadapter","title":"<code>PasswordResetAdapter</code>","text":"<p>Abstract base class for password reset operations.</p> <p>Methods: - <code>create(user_id, token_hash, expires_at)</code> - Create reset token - <code>get_valid(token_hash)</code> - Get valid token by hash - <code>mark_used(token_hash)</code> - Mark token as used</p>"},{"location":"api-reference/#emailverificationadapter","title":"<code>EmailVerificationAdapter</code>","text":"<p>Abstract base class for email verification operations.</p> <p>Methods: - <code>create(user_id, token_hash, expires_at)</code> - Create verification token - <code>get_valid(token_hash)</code> - Get valid token by hash - <code>mark_used(token_hash)</code> - Mark token as used</p>"},{"location":"api-reference/#roleadapter","title":"<code>RoleAdapter</code>","text":"<p>Abstract base class for role and permission operations.</p> <p>Methods: - <code>create_role(name, description)</code> - Create a new role - <code>get_role_by_name(name)</code> - Retrieve role by name - <code>create_permission(name, description)</code> - Create a new permission - <code>get_permission_by_name(name)</code> - Retrieve permission by name - <code>assign_role_to_user(user_id, role_id)</code> - Assign role to user - <code>remove_role_from_user(user_id, role_id)</code> - Remove role from user - <code>get_user_roles(user_id)</code> - Get all roles for a user - <code>assign_permission_to_role(role_id, permission_id)</code> - Assign permission to role - <code>get_role_permissions(role_id)</code> - Get all permissions for a role - <code>get_user_permissions(user_id)</code> - Get all permissions for a user (from all roles)</p>"},{"location":"api-reference/#sessionadapter","title":"<code>SessionAdapter</code>","text":"<p>Abstract base class for session management operations.</p> <p>Methods: - <code>create_session(user_id, device, ip_address, user_agent)</code> - Create a new session - <code>get_session_by_id(session_id)</code> - Retrieve session by ID - <code>get_user_sessions(user_id)</code> - Get all sessions for a user - <code>delete_session(session_id)</code> - Delete a specific session - <code>delete_user_sessions(user_id, except_session_id)</code> - Delete all user sessions (optionally except one) - <code>update_last_active(session_id)</code> - Update session's last active timestamp - <code>cleanup_inactive_sessions(inactive_days)</code> - Remove inactive sessions</p>"},{"location":"api-reference/#emailchangeadapter","title":"<code>EmailChangeAdapter</code>","text":"<p>Abstract base class for email change token operations.</p> <p>Methods: - <code>create(user_id, new_email, token_hash, expires_at)</code> - Create email change request with token - <code>get_valid(token_hash)</code> - Get valid (not used) email change record by token hash - <code>mark_used(token_hash)</code> - Mark email change token as used</p>"},{"location":"api-reference/#oauthaccountadapter","title":"<code>OAuthAccountAdapter</code>","text":"<p>Abstract base class for OAuth account operations.</p> <p>Methods: - <code>create(user_id, provider, provider_user_id, access_token, refresh_token, expires_at)</code> - Create OAuth account link - <code>get_by_provider_user_id(provider, provider_user_id)</code> - Get OAuth account by provider and provider user ID - <code>get_by_user_id(user_id)</code> - Get all OAuth accounts for a user - <code>get_by_id(account_id)</code> - Get OAuth account by ID - <code>delete(account_id)</code> - Delete OAuth account link</p>"},{"location":"api-reference/#oauthstateadapter","title":"<code>OAuthStateAdapter</code>","text":"<p>Abstract base class for OAuth state token operations.</p> <p>Methods: - <code>create(state_hash, provider, redirect_uri, code_verifier, expires_at, state_data)</code> - Create OAuth state token - <code>get_valid(state_hash)</code> - Get valid (not expired) state record by hash - <code>delete(state_hash)</code> - Delete used state token</p>"},{"location":"api-reference/#sqlalchemy-adapters","title":"SQLAlchemy Adapters","text":""},{"location":"api-reference/#sqlalchemyuseradapter","title":"<code>SQLAlchemyUserAdapter</code>","text":"<p>SQLAlchemy implementation of UserAdapter.</p> <p>Example: <pre><code>from sqlmodel import Session\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyUserAdapter\n\nadapter = SQLAlchemyUserAdapter(session)\nuser = adapter.create_user(\n    email=\"user@example.com\",\n    hashed_password=\"hashed...\"\n)\n</code></pre></p>"},{"location":"api-reference/#sqlalchemyrefreshtokenadapter","title":"<code>SQLAlchemyRefreshTokenAdapter</code>","text":"<p>SQLAlchemy implementation of RefreshTokenAdapter.</p>"},{"location":"api-reference/#sqlalchemypasswordresetadapter","title":"<code>SQLAlchemyPasswordResetAdapter</code>","text":"<p>SQLAlchemy implementation of PasswordResetAdapter.</p>"},{"location":"api-reference/#sqlalchemyemailverificationadapter","title":"<code>SQLAlchemyEmailVerificationAdapter</code>","text":"<p>SQLAlchemy implementation of EmailVerificationAdapter.</p>"},{"location":"api-reference/#sqlalchemyroleadapter","title":"<code>SQLAlchemyRoleAdapter</code>","text":"<p>SQLAlchemy implementation of RoleAdapter.</p> <p>Example: <pre><code>from sqlmodel import Session\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyRoleAdapter\n\nrole_adapter = SQLAlchemyRoleAdapter(session)\nrole = role_adapter.create_role(name=\"admin\", description=\"Administrator role\")\n</code></pre></p>"},{"location":"api-reference/#sqlalchemysessionadapter","title":"<code>SQLAlchemySessionAdapter</code>","text":"<p>SQLAlchemy implementation of SessionAdapter.</p> <p>Example: <pre><code>from sqlmodel import Session\nfrom fastauth.adapters.sqlalchemy import SQLAlchemySessionAdapter\n\nsession_adapter = SQLAlchemySessionAdapter(session)\nsession = session_adapter.create_session(\n    user_id=user.id,\n    device=\"iPhone 13\",\n    ip_address=\"192.168.1.1\",\n    user_agent=\"Mozilla/5.0\"\n)\n</code></pre></p>"},{"location":"api-reference/#sqlalchemyemailchangeadapter","title":"<code>SQLAlchemyEmailChangeAdapter</code>","text":"<p>SQLAlchemy implementation of EmailChangeAdapter.</p> <p>Example: <pre><code>from sqlmodel import Session\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyEmailChangeAdapter\n\nemail_change_adapter = SQLAlchemyEmailChangeAdapter(session)\nemail_change_adapter.create(\n    user_id=user.id,\n    new_email=\"newemail@example.com\",\n    token_hash=\"hashed_token\",\n    expires_at=datetime.now(UTC) + timedelta(hours=1)\n)\n</code></pre></p>"},{"location":"api-reference/#sqlalchemyoauthaccountadapter","title":"<code>SQLAlchemyOAuthAccountAdapter</code>","text":"<p>SQLAlchemy implementation of OAuthAccountAdapter.</p> <p>Example: <pre><code>from sqlmodel import Session\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyOAuthAccountAdapter\n\noauth_account_adapter = SQLAlchemyOAuthAccountAdapter(session)\noauth_account = oauth_account_adapter.create(\n    user_id=user.id,\n    provider=\"google\",\n    provider_user_id=\"google_user_123\",\n    access_token=\"encrypted_access_token\",\n    refresh_token=\"encrypted_refresh_token\",\n    expires_at=datetime.now(UTC) + timedelta(hours=1)\n)\n</code></pre></p>"},{"location":"api-reference/#sqlalchemyoauthstateadapter","title":"<code>SQLAlchemyOAuthStateAdapter</code>","text":"<p>SQLAlchemy implementation of OAuthStateAdapter.</p> <p>Example: <pre><code>from sqlmodel import Session\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyOAuthStateAdapter\n\noauth_state_adapter = SQLAlchemyOAuthStateAdapter(session)\noauth_state_adapter.create(\n    state_hash=\"hashed_state_token\",\n    provider=\"google\",\n    redirect_uri=\"http://localhost:8000/callback\",\n    code_verifier=\"pkce_code_verifier\",\n    expires_at=datetime.now(UTC) + timedelta(minutes=10),\n    state_data={\"link_user_id\": str(user.id)}\n)\n</code></pre></p>"},{"location":"api-reference/#api-routes","title":"API Routes","text":""},{"location":"api-reference/#authentication-endpoints","title":"Authentication Endpoints","text":"<p>All routes are prefixed with <code>/auth</code>.</p>"},{"location":"api-reference/#post-authregister","title":"<code>POST /auth/register</code>","text":"<p>Register a new user.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"id\": \"uuid\",\n  \"email\": \"user@example.com\",\n  \"is_verified\": false,\n  \"is_active\": true,\n  \"created_at\": \"2024-01-01T00:00:00\"\n}\n</code></pre></p>"},{"location":"api-reference/#post-authlogin","title":"<code>POST /auth/login</code>","text":"<p>Login with email and password.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"access_token\": \"eyJ...\",\n  \"refresh_token\": \"eyJ...\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p>"},{"location":"api-reference/#post-authlogout","title":"<code>POST /auth/logout</code>","text":"<p>Logout and revoke refresh token.</p> <p>Request Body: <pre><code>{\n  \"refresh_token\": \"eyJ...\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Logged out successfully\"\n}\n</code></pre></p>"},{"location":"api-reference/#post-authrefresh","title":"<code>POST /auth/refresh</code>","text":"<p>Get new access token using refresh token.</p> <p>Request Body: <pre><code>{\n  \"refresh_token\": \"eyJ...\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"access_token\": \"eyJ...\",\n  \"refresh_token\": \"eyJ...\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p>"},{"location":"api-reference/#password-reset-endpoints","title":"Password Reset Endpoints","text":""},{"location":"api-reference/#post-authpassword-resetrequest","title":"<code>POST /auth/password-reset/request</code>","text":"<p>Request password reset email.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Password reset email sent\"\n}\n</code></pre></p>"},{"location":"api-reference/#post-authpassword-resetconfirm","title":"<code>POST /auth/password-reset/confirm</code>","text":"<p>Confirm password reset with token.</p> <p>Request Body: <pre><code>{\n  \"token\": \"reset-token\",\n  \"new_password\": \"newsecurepassword123\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code></p>"},{"location":"api-reference/#email-verification-endpoints","title":"Email Verification Endpoints","text":""},{"location":"api-reference/#post-authemail-verificationrequest","title":"<code>POST /auth/email-verification/request</code>","text":"<p>Request email verification.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code></p>"},{"location":"api-reference/#post-authemail-verificationconfirm","title":"<code>POST /auth/email-verification/confirm</code>","text":"<p>Confirm email with verification token.</p> <p>Request Body: <pre><code>{\n  \"token\": \"verification-token\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code></p>"},{"location":"api-reference/#post-authemail-verificationresend","title":"<code>POST /auth/email-verification/resend</code>","text":"<p>Resend verification email.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code></p>"},{"location":"api-reference/#session-management-endpoints","title":"Session Management Endpoints","text":"<p>All routes are prefixed with <code>/sessions</code> and require authentication.</p>"},{"location":"api-reference/#get-sessions","title":"<code>GET /sessions</code>","text":"<p>List all active sessions for the authenticated user.</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"sessions\": [\n    {\n      \"id\": \"uuid\",\n      \"device\": \"iPhone 13\",\n      \"ip_address\": \"192.168.1.1\",\n      \"user_agent\": \"Mozilla/5.0...\",\n      \"last_active\": \"2024-01-01T12:00:00\",\n      \"created_at\": \"2024-01-01T00:00:00\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"api-reference/#delete-sessionssession_id","title":"<code>DELETE /sessions/{session_id}</code>","text":"<p>Delete a specific session (logout from specific device).</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Parameters: - <code>session_id</code> (UUID): ID of the session to delete</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Session deleted successfully\"\n}\n</code></pre></p> <p>Error Responses: - <code>404 Not Found</code> - Session not found or doesn't belong to user - <code>401 Unauthorized</code> - Invalid or missing access token</p>"},{"location":"api-reference/#delete-sessionsall","title":"<code>DELETE /sessions/all</code>","text":"<p>Delete all sessions for the authenticated user (logout from all devices).</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"All sessions deleted successfully\"\n}\n</code></pre></p> <p>Note: This endpoint deletes all sessions, which can be useful when a user suspects unauthorized access and wants to force logout from all devices.</p>"},{"location":"api-reference/#account-management-endpoints","title":"Account Management Endpoints","text":"<p>All routes are prefixed with <code>/account</code> and require authentication (except confirm-email-change).</p>"},{"location":"api-reference/#post-accountchange-password","title":"<code>POST /account/change-password</code>","text":"<p>Change the authenticated user's password.</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"current_password\": \"old_password123\",\n  \"new_password\": \"new_password456\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Password changed successfully\"\n}\n</code></pre></p> <p>Error Responses: - <code>400 Bad Request</code> - Current password is incorrect - <code>401 Unauthorized</code> - Invalid or missing access token - <code>404 Not Found</code> - User not found</p> <p>Note: Automatically invalidates all other sessions for security.</p>"},{"location":"api-reference/#delete-accountdelete","title":"<code>DELETE /account/delete</code>","text":"<p>Delete the authenticated user's account.</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"password\": \"user_password\",\n  \"hard_delete\": false\n}\n</code></pre></p> <p>Parameters: - <code>password</code> (string, required): User's password for verification - <code>hard_delete</code> (boolean, optional): If true, permanently delete; if false, soft delete (default: false)</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Account deactivated successfully\"\n}\n</code></pre></p> <p>OR (for hard delete): <pre><code>{\n  \"message\": \"Account permanently deleted successfully\"\n}\n</code></pre></p> <p>Error Responses: - <code>400 Bad Request</code> - Password is incorrect - <code>401 Unauthorized</code> - Invalid or missing access token - <code>404 Not Found</code> - User not found</p> <p>Note: Soft delete sets <code>deleted_at</code> timestamp and deactivates account. Hard delete permanently removes user. Both invalidate all sessions.</p>"},{"location":"api-reference/#post-accountrequest-email-change","title":"<code>POST /account/request-email-change</code>","text":"<p>Request an email change with verification token.</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"new_email\": \"newemail@example.com\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Email change requested. Please verify the token to complete the change.\",\n  \"token\": \"email-change-verification-token\"\n}\n</code></pre></p> <p>Error Responses: - <code>400 Bad Request</code> - Email already exists - <code>401 Unauthorized</code> - Invalid or missing access token - <code>404 Not Found</code> - User not found</p> <p>Note: Token expires in 60 minutes. In production, send this token via email instead of returning it in the response.</p>"},{"location":"api-reference/#post-accountconfirm-email-change","title":"<code>POST /account/confirm-email-change</code>","text":"<p>Confirm an email change with verification token.</p> <p>Request Body: <pre><code>{\n  \"token\": \"email-change-verification-token\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Email changed successfully\"\n}\n</code></pre></p> <p>Error Responses: - <code>400 Bad Request</code> - Invalid, expired, or already used token, or email no longer available</p> <p>Note: Email change resets <code>is_verified</code> to False, requiring re-verification of the new email.</p>"},{"location":"api-reference/#oauth-authentication-endpoints","title":"OAuth Authentication Endpoints","text":"<p>All routes are prefixed with <code>/oauth</code>.</p>"},{"location":"api-reference/#post-oauthproviderauthorize","title":"<code>POST /oauth/{provider}/authorize</code>","text":"<p>Initiate OAuth 2.0 authorization flow.</p> <p>Path Parameters: - <code>provider</code> (str): OAuth provider name (e.g., \"google\")</p> <p>Request Body: <pre><code>{\n  \"redirect_uri\": \"http://localhost:8000/auth/oauth/google/callback\",\n  \"use_pkce\": true\n}\n</code></pre></p> <p>Parameters: - <code>redirect_uri</code> (string, required): Callback URL after OAuth authorization - <code>use_pkce</code> (boolean, optional): Use PKCE for enhanced security (default: false)</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"authorization_url\": \"https://accounts.google.com/o/oauth2/v2/auth?...\",\n  \"state\": \"state_token_string\"\n}\n</code></pre></p> <p>Note: Redirect user to <code>authorization_url</code>. The <code>state</code> token is stored server-side for validation.</p>"},{"location":"api-reference/#post-oauthprovidercallback","title":"<code>POST /oauth/{provider}/callback</code>","text":"<p>Complete OAuth 2.0 authorization and create/link account.</p> <p>Path Parameters: - <code>provider</code> (str): OAuth provider name (e.g., \"google\")</p> <p>Request Body: <pre><code>{\n  \"code\": \"authorization_code_from_provider\",\n  \"state\": \"state_token_from_authorize\"\n}\n</code></pre></p> <p>Parameters: - <code>code</code> (string, required): Authorization code from OAuth provider - <code>state</code> (string, required): State token from authorize endpoint</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"access_token\": \"eyJ...\",\n  \"refresh_token\": \"eyJ...\",\n  \"token_type\": \"bearer\",\n  \"user\": {\n    \"id\": \"uuid\",\n    \"email\": \"user@example.com\",\n    \"is_verified\": true,\n    \"is_active\": true\n  }\n}\n</code></pre></p> <p>Error Responses: - <code>400 Bad Request</code> - Invalid state, expired state, or code exchange failed - <code>401 Unauthorized</code> - OAuth provider authentication failed</p> <p>Note: Creates new user if first-time OAuth login, or logs in existing user.</p>"},{"location":"api-reference/#get-oauthaccounts","title":"<code>GET /oauth/accounts</code>","text":"<p>List all OAuth accounts linked to the authenticated user.</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"accounts\": [\n    {\n      \"id\": \"uuid\",\n      \"provider\": \"google\",\n      \"provider_user_id\": \"google_user_123\",\n      \"created_at\": \"2024-01-01T00:00:00\"\n    }\n  ]\n}\n</code></pre></p> <p>Error Responses: - <code>401 Unauthorized</code> - Invalid or missing access token</p>"},{"location":"api-reference/#delete-oauthaccountsaccount_id","title":"<code>DELETE /oauth/accounts/{account_id}</code>","text":"<p>Unlink an OAuth account from the authenticated user.</p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Path Parameters: - <code>account_id</code> (UUID): ID of the OAuth account to unlink</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"OAuth account unlinked successfully\"\n}\n</code></pre></p> <p>Error Responses: - <code>404 Not Found</code> - OAuth account not found or doesn't belong to user - <code>401 Unauthorized</code> - Invalid or missing access token</p> <p>Note: User must have a password set or at least one other OAuth account linked before unlinking.</p>"},{"location":"api-reference/#security","title":"Security","text":""},{"location":"api-reference/#jwt-functions","title":"JWT Functions","text":""},{"location":"api-reference/#create_access_tokendata-expires_delta","title":"<code>create_access_token(data, expires_delta)</code>","text":"<p>Create a JWT access token.</p> <p>Parameters: - <code>data</code> (dict): Payload data - <code>expires_delta</code> (timedelta, optional): Expiration time</p> <p>Returns: - JWT token string</p>"},{"location":"api-reference/#decode_access_tokentoken","title":"<code>decode_access_token(token)</code>","text":"<p>Decode and validate a JWT token.</p> <p>Parameters: - <code>token</code> (str): JWT token string</p> <p>Returns: - Decoded payload dict</p> <p>Raises: - <code>TokenError</code>: If token is invalid or expired</p>"},{"location":"api-reference/#password-hashing","title":"Password Hashing","text":""},{"location":"api-reference/#hash_passwordpassword","title":"<code>hash_password(password)</code>","text":"<p>Hash a password using Argon2.</p> <p>Parameters: - <code>password</code> (str): Plain text password</p> <p>Returns: - Hashed password string</p>"},{"location":"api-reference/#verify_passwordhashed_password-plain_password","title":"<code>verify_password(hashed_password, plain_password)</code>","text":"<p>Verify a password against its hash.</p> <p>Parameters: - <code>hashed_password</code> (str): Hashed password - <code>plain_password</code> (str): Plain text password to verify</p> <p>Returns: - True if valid, False otherwise</p>"},{"location":"api-reference/#rate-limiting","title":"Rate Limiting","text":""},{"location":"api-reference/#ratelimiter","title":"<code>RateLimiter</code>","text":"<p>Rate limiter for protecting endpoints.</p> <p>Methods: - <code>hit(key)</code> - Register an attempt - <code>reset(key)</code> - Clear attempts</p> <p>Example: <pre><code>from fastauth.security.rate_limit import RateLimiter\n\nlimiter = RateLimiter(max_attempts=5, window_seconds=300)\nlimiter.hit(\"user@example.com\")  # Raises RateLimitExceeded if exceeded\n</code></pre></p>"},{"location":"api-reference/#models","title":"Models","text":""},{"location":"api-reference/#user","title":"User","text":"<p>SQLAlchemy user model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>email</code> (str): Email address (unique) - <code>hashed_password</code> (str): Hashed password - <code>is_active</code> (bool): Whether user is active - <code>is_verified</code> (bool): Whether email is verified - <code>is_superuser</code> (bool): Whether user has superuser privileges - <code>last_login</code> (datetime, optional): Last login timestamp - <code>deleted_at</code> (datetime, optional): Soft delete timestamp - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#refreshtoken","title":"RefreshToken","text":"<p>SQLAlchemy refresh token model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>user_id</code> (UUID): User reference - <code>token_hash</code> (str): Token hash (unique) - <code>expires_at</code> (datetime): Expiration time - <code>revoked</code> (bool): Whether token is revoked - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#passwordresettoken","title":"PasswordResetToken","text":"<p>SQLAlchemy password reset token model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>user_id</code> (UUID): User reference - <code>token_hash</code> (str): Token hash (unique) - <code>expires_at</code> (datetime): Expiration time - <code>used</code> (bool): Whether token is used - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#emailverificationtoken","title":"EmailVerificationToken","text":"<p>SQLAlchemy email verification token model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>user_id</code> (UUID): User reference - <code>token_hash</code> (str): Token hash (unique) - <code>expires_at</code> (datetime): Expiration time - <code>used</code> (bool): Whether token is used - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#emailchangetoken","title":"EmailChangeToken","text":"<p>SQLAlchemy email change token model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>user_id</code> (UUID): User reference - <code>new_email</code> (str): New email address to change to - <code>token_hash</code> (str): Token hash (unique) - <code>expires_at</code> (datetime): Expiration time - <code>used</code> (bool): Whether token is used - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#role","title":"Role","text":"<p>SQLAlchemy role model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>name</code> (str): Role name (unique) - <code>description</code> (str, optional): Role description - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#permission","title":"Permission","text":"<p>SQLAlchemy permission model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>name</code> (str): Permission name (unique) - <code>description</code> (str, optional): Permission description - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#userrole","title":"UserRole","text":"<p>SQLAlchemy user-role junction model (many-to-many).</p> <p>Fields: - <code>user_id</code> (UUID): User reference (primary key) - <code>role_id</code> (UUID): Role reference (primary key) - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#rolepermission","title":"RolePermission","text":"<p>SQLAlchemy role-permission junction model (many-to-many).</p> <p>Fields: - <code>role_id</code> (UUID): Role reference (primary key) - <code>permission_id</code> (UUID): Permission reference (primary key) - <code>created_at</code> (datetime): Creation timestamp</p>"},{"location":"api-reference/#session","title":"Session","text":"<p>SQLAlchemy session model.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>user_id</code> (UUID): User reference - <code>device</code> (str, optional): Device information - <code>ip_address</code> (str, optional): Client IP address - <code>user_agent</code> (str, optional): User agent string - <code>last_active</code> (datetime): Last activity timestamp - <code>created_at</code> (datetime): Creation timestamp</p> <p>Example: <pre><code>from fastauth.adapters.sqlalchemy.models import Session\n\n# Sessions are automatically created on login/register\n# and tracked across the user's devices\n</code></pre></p>"},{"location":"api-reference/#oauthaccount","title":"OAuthAccount","text":"<p>SQLAlchemy OAuth account model for linking OAuth providers to users.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>user_id</code> (UUID): User reference - <code>provider</code> (str): OAuth provider name (e.g., \"google\", \"github\") - <code>provider_user_id</code> (str): User ID from OAuth provider - <code>access_token</code> (str): Encrypted OAuth access token - <code>refresh_token</code> (str, optional): Encrypted OAuth refresh token - <code>expires_at</code> (datetime, optional): Access token expiration time - <code>created_at</code> (datetime): Creation timestamp</p> <p>Example: <pre><code>from fastauth.adapters.sqlalchemy.models import OAuthAccount\n\n# OAuth accounts are automatically created/linked\n# when users authenticate via OAuth providers\n</code></pre></p>"},{"location":"api-reference/#oauthstate","title":"OAuthState","text":"<p>SQLAlchemy OAuth state token model for CSRF protection.</p> <p>Fields: - <code>id</code> (UUID): Unique identifier - <code>state_hash</code> (str): Hashed state token (unique) - <code>provider</code> (str): OAuth provider name - <code>redirect_uri</code> (str): Callback URL - <code>code_verifier</code> (str, optional): PKCE code verifier - <code>state_data</code> (JSON, optional): Additional state data - <code>expires_at</code> (datetime): Expiration time - <code>created_at</code> (datetime): Creation timestamp</p> <p>Example: <pre><code>from fastauth.adapters.sqlalchemy.models import OAuthState\n\n# OAuth states are automatically created during authorization\n# and validated during callback to prevent CSRF attacks\n</code></pre></p>"},{"location":"api-reference/#settings","title":"Settings","text":""},{"location":"api-reference/#settings_1","title":"<code>Settings</code>","text":"<p>Configuration class using Pydantic settings.</p> <p>Fields: - <code>jwt_secret_key</code> (str): Secret key for JWT tokens - <code>jwt_algorithm</code> (str): JWT algorithm (default: HS256) - <code>access_token_expire_minutes</code> (int): Access token expiration - <code>refresh_token_expire_days</code> (int): Refresh token expiration - <code>require_email_verification</code> (bool): Require email verification - <code>email_provider</code> (str): Email provider type - <code>oauth_google_client_id</code> (str, optional): Google OAuth client ID - <code>oauth_google_client_secret</code> (str, optional): Google OAuth client secret - <code>oauth_google_redirect_uri</code> (str, optional): Google OAuth redirect URI - <code>oauth_state_expire_minutes</code> (int): OAuth state token expiration (default: 10)</p> <p>Example: <pre><code>from fastauth import Settings\n\nsettings = Settings(\n    jwt_secret_key=\"your-secret-key\",\n    access_token_expire_minutes=60,\n    require_email_verification=True,\n    oauth_google_client_id=\"your-google-client-id\",\n    oauth_google_client_secret=\"your-google-client-secret\",\n    oauth_google_redirect_uri=\"http://localhost:8000/auth/oauth/google/callback\"\n)\n</code></pre></p>"},{"location":"api-reference/#dependencies","title":"Dependencies","text":""},{"location":"api-reference/#get_current_usercredentials-session","title":"<code>get_current_user(credentials, session)</code>","text":"<p>FastAPI dependency to get the current authenticated user.</p> <p>Example: <pre><code>from fastapi import Depends\nfrom fastauth.api.dependencies import get_current_user\n\n@app.get(\"/profile\")\ndef get_profile(current_user = Depends(get_current_user)):\n    return {\"email\": current_user.email}\n</code></pre></p>"},{"location":"api-reference/#get_role_adaptersession","title":"<code>get_role_adapter(session)</code>","text":"<p>FastAPI dependency to get the role adapter instance.</p> <p>Returns: - <code>SQLAlchemyRoleAdapter</code> instance</p> <p>Example: <pre><code>from fastapi import Depends\nfrom fastauth.api.dependencies import get_role_adapter\n\n@app.get(\"/roles\")\ndef list_roles(roles = Depends(get_role_adapter)):\n    return roles.get_all_roles()\n</code></pre></p>"},{"location":"api-reference/#require_rolerole_name","title":"<code>require_role(role_name)</code>","text":"<p>FastAPI dependency factory to require a specific role.</p> <p>Parameters: - <code>role_name</code> (str): Name of the required role</p> <p>Returns: - Dependency function that can be used with <code>Depends</code></p> <p>Raises: - <code>HTTPException(403)</code>: If user doesn't have the required role</p> <p>Example: <pre><code>from fastapi import Depends\nfrom fastauth.api.dependencies import require_role\n\n@app.get(\"/admin/dashboard\", dependencies=[Depends(require_role(\"admin\"))])\ndef admin_dashboard():\n    return {\"message\": \"Admin access granted\"}\n</code></pre></p>"},{"location":"api-reference/#require_permissionpermission_name","title":"<code>require_permission(permission_name)</code>","text":"<p>FastAPI dependency factory to require a specific permission.</p> <p>Parameters: - <code>permission_name</code> (str): Name of the required permission</p> <p>Returns: - Dependency function that can be used with <code>Depends</code></p> <p>Raises: - <code>HTTPException(403)</code>: If user doesn't have the required permission</p> <p>Example: <pre><code>from fastapi import Depends\nfrom fastauth.api.dependencies import require_permission\n\n@app.delete(\n    \"/users/{id}\",\n    dependencies=[Depends(require_permission(\"delete:users\"))]\n)\ndef delete_user(id: str):\n    return {\"message\": \"User deleted\"}\n</code></pre></p>"},{"location":"api-reference/#exceptions","title":"Exceptions","text":"<ul> <li><code>UserAlreadyExistsError</code> - User with email already exists</li> <li><code>InvalidCredentialsError</code> - Invalid login credentials</li> <li><code>EmailNotVerifiedError</code> - Email not verified</li> <li><code>RefreshTokenError</code> - Invalid or expired refresh token</li> <li><code>PasswordResetError</code> - Invalid or expired reset token</li> <li><code>EmailVerificationError</code> - Invalid or expired verification token</li> <li><code>RoleNotFoundError</code> - Role does not exist</li> <li><code>PermissionNotFoundError</code> - Permission does not exist</li> <li><code>RoleAlreadyExistsError</code> - Role with the name already exists</li> <li><code>PermissionAlreadyExistsError</code> - Permission with the name already exists</li> <li><code>SessionNotFoundError</code> - Session not found or doesn't belong to user</li> <li><code>InvalidPasswordError</code> - Current password is incorrect (account management)</li> <li><code>UserNotFoundError</code> - User not found (account management)</li> <li><code>EmailChangeError</code> - Invalid or expired email change token</li> <li><code>EmailAlreadyExistsError</code> - Email address already exists</li> <li><code>OAuthError</code> - OAuth authentication error (invalid state, code exchange failed, etc.)</li> <li><code>OAuthAccountNotFoundError</code> - OAuth account not found or doesn't belong to user</li> <li><code>OAuthProviderNotFoundError</code> - OAuth provider not configured or not found</li> <li><code>RateLimitExceeded</code> - Too many attempts</li> <li><code>TokenError</code> - Invalid or expired JWT token</li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>FastAuth uses a clean, layered architecture that separates concerns and maintains database agnosticism.</p>"},{"location":"architecture/#design-principles","title":"Design Principles","text":""},{"location":"architecture/#1-database-agnostic-core","title":"1. Database Agnostic Core","text":"<p>The core business logic has no knowledge of the database layer. All database operations are abstracted through adapter interfaces.</p> <p>Benefits: - Swap databases without changing business logic - Easy to test with mock adapters - Clear separation of concerns</p>"},{"location":"architecture/#2-adapter-pattern","title":"2. Adapter Pattern","text":"<p>Database-specific code lives in adapters that implement abstract base classes.</p> <p>Flow: <pre><code>API Layer \u2192 Core Logic \u2192 Adapter Interface \u2192 Adapter Implementation \u2192 Database\n</code></pre></p>"},{"location":"architecture/#3-dependency-injection","title":"3. Dependency Injection","text":"<p>FastAPI's dependency injection system allows easy customization and testing.</p> <pre><code># Override dependencies\napp.dependency_overrides[get_session] = your_custom_session\n</code></pre>"},{"location":"architecture/#architecture-layers","title":"Architecture Layers","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         FastAPI Routes              \u2502  Your application\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502         FastAuth API Layer          \u2502  HTTP handlers\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502         Core Business Logic         \u2502  Database-agnostic\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502         Adapter Interface           \u2502  Abstract base classes\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502    Adapter Implementation           \u2502  SQLAlchemy, MongoDB, etc.\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#layer-responsibilities","title":"Layer Responsibilities","text":"<p>FastAPI Routes (Your Application) - Include FastAuth router - Define custom routes - Override dependencies</p> <p>FastAuth API Layer - HTTP request/response handling - Input validation (Pydantic) - Error handling - Rate limiting</p> <p>Core Business Logic - Authentication logic - Authorization (RBAC) - Session management - Token management - Password hashing - Email verification - Password reset</p> <p>Adapter Interface - Abstract base classes - Define required methods - No implementation details</p> <p>Adapter Implementation - Database-specific code - CRUD operations - Query logic - No business logic</p>"},{"location":"architecture/#component-architecture","title":"Component Architecture","text":""},{"location":"architecture/#core-components","title":"Core Components","text":""},{"location":"architecture/#users-fastauthcoreuserspy","title":"Users (<code>fastauth/core/users.py</code>)","text":"<ul> <li>User creation</li> <li>Authentication</li> <li>Password verification</li> </ul>"},{"location":"architecture/#refresh-tokens-fastauthcorerefresh_tokenspy","title":"Refresh Tokens (<code>fastauth/core/refresh_tokens.py</code>)","text":"<ul> <li>Token generation</li> <li>Token validation</li> <li>Token rotation</li> </ul>"},{"location":"architecture/#password-reset-fastauthcorepassword_resetpy","title":"Password Reset (<code>fastauth/core/password_reset.py</code>)","text":"<ul> <li>Reset request</li> <li>Token validation</li> <li>Password update</li> </ul>"},{"location":"architecture/#email-verification-fastauthcoreemail_verificationpy","title":"Email Verification (<code>fastauth/core/email_verification.py</code>)","text":"<ul> <li>Verification request</li> <li>Token validation</li> <li>Email confirmation</li> </ul>"},{"location":"architecture/#roles-fastauthcorerolespy","title":"Roles (<code>fastauth/core/roles.py</code>)","text":"<ul> <li>Role creation and management</li> <li>Permission creation and assignment</li> <li>Role-to-user assignment</li> <li>Permission checking</li> <li>User authorization</li> </ul>"},{"location":"architecture/#sessions-fastauthcoresessionspy","title":"Sessions (<code>fastauth/core/sessions.py</code>)","text":"<ul> <li>Session creation and tracking</li> <li>Device fingerprinting</li> <li>Session activity tracking</li> <li>Session revocation</li> <li>Inactive session cleanup</li> </ul>"},{"location":"architecture/#oauth-fastauthcoreoauthpy","title":"OAuth (<code>fastauth/core/oauth.py</code>)","text":"<ul> <li>OAuth 2.0 provider integration</li> <li>Authorization flow initiation</li> <li>Code exchange and token validation</li> <li>User account creation and linking</li> <li>OAuth account management</li> <li>PKCE support for enhanced security</li> </ul>"},{"location":"architecture/#adapters","title":"Adapters","text":""},{"location":"architecture/#base-adapters-fastauthadaptersbase","title":"Base Adapters (<code>fastauth/adapters/base/</code>)","text":"<p>Abstract interfaces defining required methods.</p> <p>UserAdapter: <pre><code>class UserAdapter(ABC):\n    @abstractmethod\n    def get_by_email(self, email: str): ...\n\n    @abstractmethod\n    def create_user(self, *, email: str, hashed_password: str): ...\n</code></pre></p> <p>RoleAdapter: <pre><code>class RoleAdapter(ABC):\n    @abstractmethod\n    def create_role(self, *, name: str, description: str | None = None): ...\n\n    @abstractmethod\n    def assign_role_to_user(self, *, user_id: UUID, role_id: UUID): ...\n\n    @abstractmethod\n    def get_user_permissions(self, user_id: UUID): ...\n</code></pre></p> <p>SessionAdapter: <pre><code>class SessionAdapter(ABC):\n    @abstractmethod\n    def create_session(self, *, user_id: UUID, device: str | None = None,\n                      ip_address: str | None = None, user_agent: str | None = None): ...\n\n    @abstractmethod\n    def get_user_sessions(self, user_id: UUID): ...\n\n    @abstractmethod\n    def delete_session(self, session_id: UUID) -&gt; None: ...\n\n    @abstractmethod\n    def cleanup_inactive_sessions(self, inactive_days: int = 30) -&gt; None: ...\n</code></pre></p> <p>OAuthAccountAdapter: <pre><code>class OAuthAccountAdapter(ABC):\n    @abstractmethod\n    def create(self, *, user_id: UUID, provider: str, provider_user_id: str,\n              access_token: str, refresh_token: str | None = None, expires_at: datetime | None = None): ...\n\n    @abstractmethod\n    def get_by_provider_user_id(self, provider: str, provider_user_id: str): ...\n\n    @abstractmethod\n    def get_by_user_id(self, user_id: UUID): ...\n\n    @abstractmethod\n    def delete(self, account_id: UUID) -&gt; None: ...\n</code></pre></p> <p>OAuthStateAdapter: <pre><code>class OAuthStateAdapter(ABC):\n    @abstractmethod\n    def create(self, *, state_hash: str, provider: str, redirect_uri: str,\n              code_verifier: str | None = None, expires_at: datetime, state_data: dict | None = None): ...\n\n    @abstractmethod\n    def get_valid(self, state_hash: str): ...\n\n    @abstractmethod\n    def delete(self, state_hash: str) -&gt; None: ...\n</code></pre></p>"},{"location":"architecture/#sqlalchemy-implementation-fastauthadapterssqlalchemy","title":"SQLAlchemy Implementation (<code>fastauth/adapters/sqlalchemy/</code>)","text":"<p>Concrete implementation using SQLModel.</p> <pre><code>class SQLAlchemyUserAdapter(UserAdapter):\n    def __init__(self, session: Session):\n        self.session = session\n\n    def get_by_email(self, email: str):\n        return self.session.exec(\n            select(User).where(User.email == email)\n        ).first()\n</code></pre>"},{"location":"architecture/#api-layer","title":"API Layer","text":""},{"location":"architecture/#routes-fastauthapiauthpy","title":"Routes (<code>fastauth/api/auth.py</code>)","text":"<p>FastAPI router with authentication endpoints.</p> <pre><code>@router.post(\"/register\")\ndef register(payload: RegisterRequest, session: Session = Depends(get_session)):\n    users = SQLAlchemyUserAdapter(session)\n    return create_user(users=users, email=payload.email, password=payload.password)\n</code></pre>"},{"location":"architecture/#dependencies-fastauthapidependenciespy","title":"Dependencies (<code>fastauth/api/dependencies.py</code>)","text":"<p>Reusable dependencies for route protection.</p> <pre><code>def get_current_user(\n    credentials: HTTPAuthorizationCredentials = Depends(security),\n    session: Session = Depends(get_session)\n) -&gt; User:\n    # Validate token and return user\n</code></pre>"},{"location":"architecture/#security-components","title":"Security Components","text":""},{"location":"architecture/#jwt-fastauthsecurityjwtpy","title":"JWT (<code>fastauth/security/jwt.py</code>)","text":"<ul> <li>Token creation</li> <li>Token validation</li> <li>Expiration handling</li> </ul>"},{"location":"architecture/#password-hashing-fastauthcorehashingpy","title":"Password Hashing (<code>fastauth/core/hashing.py</code>)","text":"<ul> <li>Argon2 hashing</li> <li>Password verification</li> </ul>"},{"location":"architecture/#rate-limiting-fastauthsecurityrate_limitpy","title":"Rate Limiting (<code>fastauth/security/rate_limit.py</code>)","text":"<ul> <li>Attempt tracking</li> <li>Window-based limiting</li> <li>Automatic cleanup</li> </ul>"},{"location":"architecture/#email-components","title":"Email Components","text":""},{"location":"architecture/#email-factory-fastauthemailfactorypy","title":"Email Factory (<code>fastauth/email/factory.py</code>)","text":"<p>Selects appropriate email provider based on configuration.</p>"},{"location":"architecture/#providers","title":"Providers","text":"<ul> <li>Console (development)</li> <li>SMTP (production)</li> <li>SendGrid (planned)</li> <li>AWS SES (planned)</li> </ul>"},{"location":"architecture/#data-flow","title":"Data Flow","text":""},{"location":"architecture/#registration-flow","title":"Registration Flow","text":"<pre><code>1. User submits email/password\n   \u2193\n2. API validates input (Pydantic)\n   \u2193\n3. Core checks for existing user (via adapter)\n   \u2193\n4. Core hashes password\n   \u2193\n5. Core creates user (via adapter)\n   \u2193\n6. If email verification required:\n   - Generate token\n   - Send email\n   \u2193\n7. Return user object\n</code></pre>"},{"location":"architecture/#login-flow","title":"Login Flow","text":"<pre><code>1. User submits email/password\n   \u2193\n2. API validates input\n   \u2193\n3. Rate limiter checks attempts\n   \u2193\n4. Core retrieves user (via adapter)\n   \u2193\n5. Core verifies password\n   \u2193\n6. Core checks email verification\n   \u2193\n7. Create access token (JWT)\n   \u2193\n8. Create refresh token (via adapter)\n   \u2193\n9. Return tokens\n</code></pre>"},{"location":"architecture/#token-refresh-flow","title":"Token Refresh Flow","text":"<pre><code>1. User submits refresh token\n   \u2193\n2. Core validates token hash (via adapter)\n   \u2193\n3. Core checks expiration\n   \u2193\n4. Core revokes old token (via adapter)\n   \u2193\n5. Create new access token\n   \u2193\n6. Create new refresh token (via adapter)\n   \u2193\n7. Return new tokens\n</code></pre>"},{"location":"architecture/#authorization-flow-rbac","title":"Authorization Flow (RBAC)","text":"<pre><code>1. User requests protected resource\n   \u2193\n2. Validate access token (get user)\n   \u2193\n3. Check required role/permission (dependency)\n   \u2193\n4. Core retrieves user roles (via adapter)\n   \u2193\n5. Core retrieves role permissions (via adapter)\n   \u2193\n6. Core checks if user has required permission\n   \u2193\n7. If authorized \u2192 Execute route\n   If unauthorized \u2192 Return 403 Forbidden\n</code></pre>"},{"location":"architecture/#oauth-20-authentication-flow","title":"OAuth 2.0 Authentication Flow","text":"<pre><code>Authorization Initiation:\n1. User clicks \"Sign in with Google\"\n   \u2193\n2. Frontend: POST /oauth/google/authorize\n   \u2193\n3. Core generates state token (CSRF protection)\n   - Random token created\n   - Hashed and stored (via OAuthStateAdapter)\n   - Expires in 10 minutes\n   \u2193\n4. Core optionally generates PKCE challenge\n   - Code verifier (random string)\n   - Code challenge (SHA-256 hash of verifier)\n   \u2193\n5. Core builds authorization URL\n   - Includes client_id, redirect_uri, state\n   - Includes code_challenge if PKCE enabled\n   \u2193\n6. Return authorization URL to frontend\n   \u2193\n7. Frontend redirects user to authorization URL\n\nOAuth Callback:\n1. User authenticates with OAuth provider\n   \u2193\n2. User grants permissions\n   \u2193\n3. OAuth provider redirects to callback URL\n   - Includes authorization code\n   - Includes state token\n   \u2193\n4. Frontend: POST /oauth/google/callback\n   - Sends code and state\n   \u2193\n5. Core validates state token (via OAuthStateAdapter)\n   - Checks state exists and not expired\n   - Deletes state token (single-use)\n   \u2193\n6. Core exchanges code for access token\n   - Sends code + code_verifier (if PKCE)\n   - Receives access_token and refresh_token\n   \u2193\n7. Core fetches user info from OAuth provider\n   - Uses access_token\n   - Gets email, provider_user_id, name\n   \u2193\n8. Core creates or links user account\n   - If OAuth account exists \u2192 return existing user\n   - If email exists \u2192 link OAuth to existing user\n   - If new user \u2192 create user + OAuth account\n   \u2193\n9. Core encrypts and stores OAuth tokens (via OAuthAccountAdapter)\n   \u2193\n10. Create session and JWT tokens\n    \u2193\n11. Return JWT tokens to frontend\n</code></pre>"},{"location":"architecture/#session-management-flow","title":"Session Management Flow","text":"<pre><code>Login/Registration:\n1. User successfully authenticates\n   \u2193\n2. Extract device info from request\n   - IP address\n   - User agent\n   - Device identifier (optional)\n   \u2193\n3. Core creates session (via adapter)\n   \u2193\n4. Core updates user's last_login timestamp\n   \u2193\n5. Return tokens\n\nList Sessions:\n1. User requests /sessions\n   \u2193\n2. Validate access token (get user)\n   \u2193\n3. Core retrieves user sessions (via adapter)\n   \u2193\n4. Return session list with metadata\n\nRevoke Session:\n1. User requests DELETE /sessions/{session_id}\n   \u2193\n2. Validate access token (get user)\n   \u2193\n3. Core verifies session ownership\n   \u2193\n4. If owned \u2192 Delete session (via adapter)\n   If not owned \u2192 Return 404 Not Found\n   \u2193\n5. Return success\n\nCleanup Inactive Sessions:\n1. Scheduled job triggers (e.g., daily)\n   \u2193\n2. Core queries sessions (via adapter)\n   \u2193\n3. Core filters by last_active &lt; cutoff date\n   \u2193\n4. Core deletes inactive sessions (via adapter)\n</code></pre>"},{"location":"architecture/#security-architecture","title":"Security Architecture","text":""},{"location":"architecture/#password-security","title":"Password Security","text":"<p>Argon2 Hashing: - Industry-recommended algorithm - Memory-hard (resistant to GPU attacks) - Configurable cost parameters</p> <p>Flow: <pre><code>Plain Password \u2192 Argon2 Hash \u2192 Store in Database\n</code></pre></p>"},{"location":"architecture/#token-security","title":"Token Security","text":"<p>JWT Access Tokens: - Short-lived (30 minutes default) - Stateless - Signed with secret key</p> <p>Refresh Tokens: - Long-lived (7 days default) - Stored in database (can be revoked) - Hashed before storage - Rotated on use</p>"},{"location":"architecture/#rate-limiting","title":"Rate Limiting","text":"<p>Protection Against: - Brute force attacks - Credential stuffing - DoS attacks</p> <p>Implementation: <pre><code>limiter = RateLimiter(max_attempts=5, window_seconds=300)\nlimiter.hit(request.client.host)\n</code></pre></p>"},{"location":"architecture/#authorization-rbac","title":"Authorization (RBAC)","text":"<p>Role-Based Access Control: - Fine-grained authorization - Separation of authentication and authorization - Flexible permission model</p> <p>Architecture: <pre><code>User \u2192 [UserRole] \u2192 Role \u2192 [RolePermission] \u2192 Permission\n</code></pre></p> <p>Many-to-Many Relationships: - Users can have multiple roles - Roles can have multiple permissions - Users inherit all permissions from their roles</p> <p>Route Protection: <pre><code># Protect by role\n@app.get(\"/admin\", dependencies=[Depends(require_role(\"admin\"))])\n\n# Protect by permission\n@app.delete(\"/users/{id}\", dependencies=[Depends(require_permission(\"delete:users\"))])\n</code></pre></p> <p>Permission Check: <pre><code># Check permission programmatically\nhas_access = check_permission(\n    roles=role_adapter,\n    user_id=user.id,\n    permission_name=\"delete:users\"\n)\n</code></pre></p>"},{"location":"architecture/#sql-injection-protection","title":"SQL Injection Protection","text":"<p>All database operations use parameterized queries via SQLModel:</p> <pre><code># Safe - parameterized\nstatement = select(User).where(User.email == email)\n\n# Never do this - vulnerable\nquery = f\"SELECT * FROM users WHERE email = '{email}'\"\n</code></pre>"},{"location":"architecture/#extension-points","title":"Extension Points","text":""},{"location":"architecture/#custom-adapters","title":"Custom Adapters","text":"<p>Implement the adapter interface for any database:</p> <pre><code>from fastauth.adapters.base import UserAdapter\n\nclass MongoDBUserAdapter(UserAdapter):\n    def __init__(self, db):\n        self.db = db\n\n    def get_by_email(self, email: str):\n        return self.db.users.find_one({\"email\": email})\n</code></pre>"},{"location":"architecture/#custom-email-providers","title":"Custom Email Providers","text":"<p>Implement the email provider interface:</p> <pre><code>from fastauth.email.base import EmailProvider\n\nclass SendGridProvider(EmailProvider):\n    def send_verification_email(self, user, token):\n        # SendGrid implementation\n</code></pre>"},{"location":"architecture/#custom-routes","title":"Custom Routes","text":"<p>Add your own protected routes:</p> <pre><code>from fastauth.api.dependencies import get_current_user\n\n@app.get(\"/profile\")\ndef get_profile(current_user = Depends(get_current_user)):\n    return {\"email\": current_user.email}\n</code></pre>"},{"location":"architecture/#testing-architecture","title":"Testing Architecture","text":""},{"location":"architecture/#unit-tests","title":"Unit Tests","text":"<p>Test core logic with mock adapters:</p> <pre><code>class FakeUserAdapter(UserAdapter):\n    def __init__(self):\n        self.users = {}\n\n    def create_user(self, email, hashed_password):\n        user = User(email=email, hashed_password=hashed_password)\n        self.users[email] = user\n        return user\n</code></pre>"},{"location":"architecture/#integration-tests","title":"Integration Tests","text":"<p>Test with real database (SQLite in memory):</p> <pre><code>@pytest.fixture\ndef session():\n    engine = create_engine(\"sqlite:///:memory:\")\n    SQLModel.metadata.create_all(engine)\n    with Session(engine) as session:\n        yield session\n</code></pre>"},{"location":"architecture/#api-tests","title":"API Tests","text":"<p>Test HTTP endpoints with TestClient:</p> <pre><code>client = TestClient(app)\nresponse = client.post(\"/auth/register\", json={\n    \"email\": \"test@example.com\",\n    \"password\": \"password123\"\n})\n</code></pre>"},{"location":"architecture/#performance-considerations","title":"Performance Considerations","text":""},{"location":"architecture/#database","title":"Database","text":"<p>Connection Pooling: - SQLAlchemy manages connection pools - Configure pool size for your workload</p> <p>Indexes: - Email (unique) - Token hashes (unique) - User IDs (primary key)</p>"},{"location":"architecture/#caching","title":"Caching","text":"<p>Rate Limiter: - In-memory storage (defaultdict) - Automatic cleanup of old attempts</p> <p>Sessions: - Database-backed (can be moved to Redis)</p>"},{"location":"architecture/#token-generation","title":"Token Generation","text":"<p>Secure Random: - Uses <code>secrets</code> module - Cryptographically secure</p> <p>Hashing: - Argon2 is CPU-intensive (by design) - Balance security with performance</p>"},{"location":"architecture/#configuration","title":"Configuration","text":""},{"location":"architecture/#settings-management","title":"Settings Management","text":"<p>Pydantic settings with environment variables:</p> <pre><code>class Settings(BaseSettings):\n    jwt_secret_key: str\n    access_token_expire_minutes: int = 30\n\n    model_config = SettingsConfigDict(env_file=\".env\")\n</code></pre>"},{"location":"architecture/#environment-based","title":"Environment-Based","text":"<p>Different settings per environment:</p> <pre><code># Development\nEMAIL_PROVIDER=console\nREQUIRE_EMAIL_VERIFICATION=false\n\n# Production\nEMAIL_PROVIDER=smtp\nREQUIRE_EMAIL_VERIFICATION=true\n</code></pre>"},{"location":"architecture/#error-handling","title":"Error Handling","text":""},{"location":"architecture/#exception-hierarchy","title":"Exception Hierarchy","text":"<pre><code>Exception\n\u251c\u2500\u2500 UserAlreadyExistsError\n\u251c\u2500\u2500 InvalidCredentialsError\n\u251c\u2500\u2500 EmailNotVerifiedError\n\u251c\u2500\u2500 RefreshTokenError\n\u251c\u2500\u2500 PasswordResetError\n\u251c\u2500\u2500 EmailVerificationError\n\u251c\u2500\u2500 RoleNotFoundError\n\u251c\u2500\u2500 PermissionNotFoundError\n\u251c\u2500\u2500 RoleAlreadyExistsError\n\u251c\u2500\u2500 PermissionAlreadyExistsError\n\u251c\u2500\u2500 SessionNotFoundError\n\u251c\u2500\u2500 RateLimitExceeded\n\u2514\u2500\u2500 TokenError\n</code></pre>"},{"location":"architecture/#http-error-mapping","title":"HTTP Error Mapping","text":"<pre><code>try:\n    user = authenticate_user(...)\nexcept InvalidCredentialsError:\n    raise HTTPException(status_code=401, detail=\"Invalid credentials\")\nexcept EmailNotVerifiedError:\n    raise HTTPException(status_code=403, detail=\"Email not verified\")\n</code></pre>"},{"location":"architecture/#deployment-considerations","title":"Deployment Considerations","text":""},{"location":"architecture/#database-migrations","title":"Database Migrations","text":"<p>FastAuth doesn't include migrations. Use Alembic:</p> <pre><code>alembic init alembic\nalembic revision --autogenerate -m \"Add FastAuth models\"\nalembic upgrade head\n</code></pre>"},{"location":"architecture/#secret-management","title":"Secret Management","text":"<p>Never commit secrets:</p> <pre><code># Use environment variables\nexport JWT_SECRET_KEY=$(openssl rand -hex 32)\n\n# Or secret management service\n# AWS Secrets Manager, HashiCorp Vault, etc.\n</code></pre>"},{"location":"architecture/#scaling","title":"Scaling","text":"<p>Horizontal Scaling: - Stateless API (JWT tokens) - Database handles state - Load balancer distributes requests</p> <p>Database Scaling: - Read replicas for queries - Write to primary - Consider separate auth database</p>"},{"location":"architecture/#future-architecture","title":"Future Architecture","text":"<p>Completed: - \u2705 RBAC - Role-based access control with permissions - \u2705 Session Management - Track and manage user sessions across devices - \u2705 OAuth 2.0 - Third-party authentication with Google (PKCE support) - \u2705 Account Management - Password change, email change, account deletion</p> <p>Planned enhancements:</p> <p>Multi-Tenancy: - Organization context - Tenant isolation - Per-tenant settings</p> <p>Two-Factor Authentication: - TOTP support - Backup codes - Trusted devices</p> <p>Audit Logging: - All auth events - Suspicious activity detection - Compliance requirements</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to FastAuth will be documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"changelog/#added","title":"Added","text":"<ul> <li>MkDocs documentation site with auto-generated API reference</li> <li>Comprehensive test reporting infrastructure with timestamped HTML reports</li> <li>OAuth 2.0 authentication framework with Google provider support</li> <li>Test coverage tracking (85% coverage achieved)</li> </ul>"},{"location":"changelog/#changed","title":"Changed","text":"<ul> <li>Reorganized documentation structure for better navigation</li> <li>Improved test infrastructure with coverage thresholds</li> </ul>"},{"location":"changelog/#010-initial-release","title":"[0.1.0] - Initial Release","text":""},{"location":"changelog/#added_1","title":"Added","text":"<ul> <li>FastAPI authentication system</li> <li>JWT-based authentication</li> <li>User registration and login</li> <li>Email verification</li> <li>Password reset functionality</li> <li>Session management</li> <li>Role-based access control (RBAC)</li> <li>SQLAlchemy adapter for database operations</li> <li>Argon2 password hashing</li> <li>Comprehensive test suite (195+ tests)</li> </ul>"},{"location":"code_of_conduct/","title":"Code of Conduct","text":""},{"location":"code_of_conduct/#our-pledge","title":"Our Pledge","text":"<p>We as members, contributors, and leaders pledge to make participation in our community a harassment-free experience for everyone, regardless of age, body size, visible or invisible disability, ethnicity, sex characteristics, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, religion, or sexual identity and orientation.</p> <p>We pledge to act and interact in ways that contribute to an open, welcoming, diverse, inclusive, and healthy community.</p>"},{"location":"code_of_conduct/#our-standards","title":"Our Standards","text":"<p>Examples of behavior that contributes to a positive environment:</p> <ul> <li>Using welcoming and inclusive language</li> <li>Being respectful of differing viewpoints and experiences</li> <li>Gracefully accepting constructive criticism</li> <li>Focusing on what is best for the community</li> <li>Showing empathy towards other community members</li> </ul> <p>Examples of unacceptable behavior:</p> <ul> <li>The use of sexualized language or imagery, and unwelcome sexual attention</li> <li>Trolling, insulting or derogatory comments, and personal or political attacks</li> <li>Public or private harassment</li> <li>Publishing others' private information without explicit permission</li> <li>Other conduct which could reasonably be considered inappropriate</li> </ul>"},{"location":"code_of_conduct/#enforcement-responsibilities","title":"Enforcement Responsibilities","text":"<p>Project maintainers are responsible for clarifying and enforcing our standards of acceptable behavior and will take appropriate and fair corrective action in response to any behavior that they deem inappropriate, threatening, offensive, or harmful.</p>"},{"location":"code_of_conduct/#scope","title":"Scope","text":"<p>This Code of Conduct applies within all community spaces, and also applies when an individual is officially representing the community in public spaces.</p>"},{"location":"code_of_conduct/#enforcement","title":"Enforcement","text":"<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be reported to the project maintainers at sreekarnv1@gmail.com. All complaints will be reviewed and investigated promptly and fairly.</p>"},{"location":"code_of_conduct/#attribution","title":"Attribution","text":"<p>This Code of Conduct is adapted from the Contributor Covenant, version 2.0, available at https://www.contributor-covenant.org/version/2/0/code_of_conduct.html.</p>"},{"location":"configuration/","title":"Configuration","text":"<p>FastAuth is configured using environment variables and Pydantic settings.</p>"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"<p>Create a <code>.env</code> file in your project root:</p> <pre><code># JWT Configuration\nJWT_SECRET_KEY=your-secret-key-here\nJWT_ALGORITHM=HS256\nACCESS_TOKEN_EXPIRE_MINUTES=30\nREFRESH_TOKEN_EXPIRE_DAYS=7\n\n# Email\nEMAIL_PROVIDER=console\nREQUIRE_EMAIL_VERIFICATION=false\n\n# Database\nDATABASE_URL=sqlite:///./app.db\n</code></pre>"},{"location":"configuration/#settings-class","title":"Settings Class","text":"<pre><code>from fastauth import Settings\n\nsettings = Settings(\n    jwt_secret_key=\"your-secret-key\",\n    access_token_expire_minutes=30,\n    require_email_verification=True\n)\n</code></pre>"},{"location":"configuration/#available-settings","title":"Available Settings","text":"<p>See the Settings API Reference for all available configuration options.</p>"},{"location":"contributing/","title":"Contributing to FastAuth","text":"<p>Thank you for your interest in contributing to FastAuth! This document provides guidelines for contributing to the project.</p>"},{"location":"contributing/#development-setup","title":"Development Setup","text":"<ol> <li> <p>Fork and clone the repository:    <pre><code>git clone https://github.com/yourusername/fastauth.git\ncd fastauth\n</code></pre></p> </li> <li> <p>Install dependencies:    <pre><code>poetry install\n</code></pre></p> </li> <li> <p>Install pre-commit hooks:    <pre><code>poetry run pre-commit install\n</code></pre></p> </li> </ol>"},{"location":"contributing/#development-workflow","title":"Development Workflow","text":"<ol> <li> <p>Create a new branch:    <pre><code>git checkout -b feature/your-feature-name\n</code></pre></p> </li> <li> <p>Make your changes and ensure tests pass:    <pre><code>poetry run pytest\n</code></pre></p> </li> <li> <p>Run code quality checks:    <pre><code>poetry run black .\npoetry run ruff check .\n</code></pre></p> </li> <li> <p>Commit your changes:    <pre><code>git add .\ngit commit -m \"feat: your feature description\"\n</code></pre></p> </li> <li> <p>Push and create a pull request:    <pre><code>git push origin feature/your-feature-name\n</code></pre></p> </li> </ol>"},{"location":"contributing/#code-style","title":"Code Style","text":"<ul> <li>Follow PEP 8 guidelines</li> <li>Use Black for code formatting (line length: 88)</li> <li>Use Ruff for linting</li> <li>Write Google-style docstrings for all public functions and classes</li> <li>Add type hints to all function signatures</li> </ul>"},{"location":"contributing/#testing","title":"Testing","text":"<ul> <li>Write tests for all new features</li> <li>Maintain or improve test coverage (target: 80%+)</li> <li>Use pytest for all tests</li> <li>Place tests in the <code>tests/</code> directory mirroring the source structure</li> </ul>"},{"location":"contributing/#commit-messages","title":"Commit Messages","text":"<p>Follow conventional commits: - <code>feat:</code> for new features - <code>fix:</code> for bug fixes - <code>docs:</code> for documentation changes - <code>test:</code> for test changes - <code>refactor:</code> for refactoring - <code>chore:</code> for maintenance tasks</p>"},{"location":"contributing/#pull-request-process","title":"Pull Request Process","text":"<ol> <li>Update documentation for any new features</li> <li>Add tests for bug fixes and new features</li> <li>Ensure all tests pass and coverage is maintained</li> <li>Update the CHANGELOG.md if applicable</li> <li>Request review from maintainers</li> </ol>"},{"location":"contributing/#questions","title":"Questions?","text":"<p>Feel free to open an issue for any questions or concerns.</p>"},{"location":"deployment/","title":"Deployment Guide","text":"<p>This guide covers deploying FastAuth applications to production environments with best practices for security, scalability, and reliability.</p>"},{"location":"deployment/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Production Checklist</li> <li>Environment Configuration</li> <li>Database Setup</li> <li>Deployment Platforms</li> <li>Security Hardening</li> <li>Monitoring and Logging</li> <li>Performance Optimization</li> </ul>"},{"location":"deployment/#production-checklist","title":"Production Checklist","text":"<p>Before deploying to production, ensure you've completed these steps:</p>"},{"location":"deployment/#security","title":"Security","text":"<ul> <li> Generate strong JWT secret key (32+ bytes)</li> <li> Enable HTTPS/TLS for all connections</li> <li> Configure CORS properly</li> <li> Enable email verification</li> <li> Set up secure password reset flow</li> <li> Configure rate limiting</li> <li> Use environment variables for secrets</li> <li> Enable security headers</li> <li> Review and test authentication flows</li> </ul>"},{"location":"deployment/#database","title":"Database","text":"<ul> <li> Use production database (PostgreSQL/MySQL)</li> <li> Set up database backups</li> <li> Configure connection pooling</li> <li> Run database migrations</li> <li> Set up database monitoring</li> <li> Configure read replicas (if needed)</li> </ul>"},{"location":"deployment/#email","title":"Email","text":"<ul> <li> Configure production email provider (SMTP/SendGrid/SES)</li> <li> Test email delivery</li> <li> Set up email templates</li> <li> Configure SPF/DKIM/DMARC records</li> </ul>"},{"location":"deployment/#monitoring","title":"Monitoring","text":"<ul> <li> Set up application logging</li> <li> Configure error tracking (Sentry)</li> <li> Set up uptime monitoring</li> <li> Configure performance monitoring (APM)</li> <li> Set up alerts for critical issues</li> </ul>"},{"location":"deployment/#testing","title":"Testing","text":"<ul> <li> All tests passing (85%+ coverage)</li> <li> Load testing completed</li> <li> Security audit passed</li> <li> OAuth flows tested end-to-end</li> </ul>"},{"location":"deployment/#environment-configuration","title":"Environment Configuration","text":""},{"location":"deployment/#production-environment-variables","title":"Production Environment Variables","text":"<p>Create a production <code>.env</code> file or configure environment variables:</p> <pre><code># Application\nENV=production\nDEBUG=false\n\n# Database\nDATABASE_URL=postgresql://user:password@host:5432/dbname\n\n# JWT Configuration\nJWT_SECRET_KEY=$(openssl rand -hex 32)\nJWT_ALGORITHM=HS256\nACCESS_TOKEN_EXPIRE_MINUTES=30\nREFRESH_TOKEN_EXPIRE_DAYS=7\n\n# Email Configuration\nEMAIL_PROVIDER=smtp\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USERNAME=your-email@gmail.com\nSMTP_PASSWORD=your-app-password\nSMTP_FROM_EMAIL=noreply@yourdomain.com\nSMTP_FROM_NAME=Your App Name\n\n# Email Verification\nREQUIRE_EMAIL_VERIFICATION=true\nEMAIL_VERIFICATION_EXPIRE_MINUTES=1440\n\n# OAuth (if using)\nOAUTH_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com\nOAUTH_GOOGLE_CLIENT_SECRET=your-client-secret\nOAUTH_GOOGLE_REDIRECT_URI=https://yourdomain.com/auth/oauth/google/callback\n\n# CORS\nCORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com\n\n# Security\nALLOWED_HOSTS=yourdomain.com,www.yourdomain.com\nSECURE_COOKIES=true\nSESSION_COOKIE_SECURE=true\nSESSION_COOKIE_HTTPONLY=true\nSESSION_COOKIE_SAMESITE=lax\n</code></pre>"},{"location":"deployment/#secrets-management","title":"Secrets Management","text":"<p>Never commit secrets to version control.</p>"},{"location":"deployment/#aws-secrets-manager","title":"AWS Secrets Manager","text":"<pre><code>import boto3\nimport json\n\ndef get_secret(secret_name):\n    client = boto3.client('secretsmanager', region_name='us-east-1')\n    response = client.get_secret_value(SecretId=secret_name)\n    return json.loads(response['SecretString'])\n\nsecrets = get_secret('prod/fastauth')\nJWT_SECRET_KEY = secrets['JWT_SECRET_KEY']\n</code></pre>"},{"location":"deployment/#hashicorp-vault","title":"HashiCorp Vault","text":"<pre><code>import hvac\n\nclient = hvac.Client(url='https://vault.example.com')\nclient.token = os.getenv('VAULT_TOKEN')\nsecrets = client.secrets.kv.v2.read_secret_version(path='prod/fastauth')\nJWT_SECRET_KEY = secrets['data']['data']['JWT_SECRET_KEY']\n</code></pre>"},{"location":"deployment/#docker-secrets","title":"Docker Secrets","text":"<pre><code># docker-compose.yml\nservices:\n  app:\n    secrets:\n      - jwt_secret_key\n      - db_password\n\nsecrets:\n  jwt_secret_key:\n    external: true\n  db_password:\n    external: true\n</code></pre>"},{"location":"deployment/#database-setup","title":"Database Setup","text":""},{"location":"deployment/#postgresql-recommended","title":"PostgreSQL (Recommended)","text":""},{"location":"deployment/#installation","title":"Installation","text":"<pre><code># Ubuntu/Debian\nsudo apt-get install postgresql postgresql-contrib\n\n# macOS\nbrew install postgresql\n</code></pre>"},{"location":"deployment/#configuration","title":"Configuration","text":"<pre><code># Create database and user\nsudo -u postgres psql\n\npostgres=# CREATE DATABASE fastauth_prod;\npostgres=# CREATE USER fastauth_user WITH ENCRYPTED PASSWORD 'strong_password';\npostgres=# GRANT ALL PRIVILEGES ON DATABASE fastauth_prod TO fastauth_user;\npostgres=# \\q\n</code></pre>"},{"location":"deployment/#connection-string","title":"Connection String","text":"<pre><code>DATABASE_URL=postgresql://fastauth_user:strong_password@localhost:5432/fastauth_prod\n</code></pre>"},{"location":"deployment/#database-migrations","title":"Database Migrations","text":"<p>Use Alembic for database migrations:</p> <pre><code># Install Alembic\npip install alembic\n\n# Initialize Alembic\nalembic init alembic\n\n# Configure alembic.ini\nsqlalchemy.url = postgresql://user:password@localhost/dbname\n\n# Create migration\nalembic revision --autogenerate -m \"Add FastAuth models\"\n\n# Apply migration\nalembic upgrade head\n</code></pre>"},{"location":"deployment/#connection-pooling","title":"Connection Pooling","text":"<p>Configure SQLAlchemy connection pool:</p> <pre><code>from sqlmodel import create_engine\n\nengine = create_engine(\n    DATABASE_URL,\n    pool_size=20,          # Max connections in pool\n    max_overflow=10,       # Extra connections when pool full\n    pool_timeout=30,       # Seconds to wait for connection\n    pool_recycle=3600,     # Recycle connections after 1 hour\n    pool_pre_ping=True,    # Test connections before using\n)\n</code></pre>"},{"location":"deployment/#backups","title":"Backups","text":"<p>Automated PostgreSQL Backups:</p> <pre><code>#!/bin/bash\n# backup.sh\n\nBACKUP_DIR=\"/backups/postgres\"\nTIMESTAMP=$(date +%Y%m%d_%H%M%S)\nBACKUP_FILE=\"$BACKUP_DIR/fastauth_$TIMESTAMP.sql.gz\"\n\n# Create backup\npg_dump -U fastauth_user fastauth_prod | gzip &gt; $BACKUP_FILE\n\n# Keep only last 7 days\nfind $BACKUP_DIR -name \"fastauth_*.sql.gz\" -mtime +7 -delete\n\n# Upload to S3 (optional)\naws s3 cp $BACKUP_FILE s3://your-backup-bucket/postgres/\n</code></pre> <p>Cron job:</p> <pre><code># Run daily at 2 AM\n0 2 * * * /path/to/backup.sh\n</code></pre>"},{"location":"deployment/#deployment-platforms","title":"Deployment Platforms","text":""},{"location":"deployment/#docker","title":"Docker","text":""},{"location":"deployment/#dockerfile","title":"Dockerfile","text":"<pre><code>FROM python:3.11-slim\n\nWORKDIR /app\n\n# Install dependencies\nCOPY pyproject.toml poetry.lock ./\nRUN pip install poetry &amp;&amp; \\\n    poetry config virtualenvs.create false &amp;&amp; \\\n    poetry install --no-dev --no-interaction --no-ansi\n\n# Copy application\nCOPY . .\n\n# Expose port\nEXPOSE 8000\n\n# Run with Gunicorn\nCMD [\"gunicorn\", \"main:app\", \\\n     \"--workers\", \"4\", \\\n     \"--worker-class\", \"uvicorn.workers.UvicornWorker\", \\\n     \"--bind\", \"0.0.0.0:8000\", \\\n     \"--access-logfile\", \"-\", \\\n     \"--error-logfile\", \"-\"]\n</code></pre>"},{"location":"deployment/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  app:\n    build: .\n    ports:\n      - \"8000:8000\"\n    environment:\n      - DATABASE_URL=postgresql://user:password@db:5432/fastauth\n      - JWT_SECRET_KEY=${JWT_SECRET_KEY}\n    depends_on:\n      - db\n    restart: unless-stopped\n\n  db:\n    image: postgres:15\n    environment:\n      - POSTGRES_DB=fastauth\n      - POSTGRES_USER=user\n      - POSTGRES_PASSWORD=password\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    restart: unless-stopped\n\n  nginx:\n    image: nginx:alpine\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n      - ./ssl:/etc/nginx/ssl\n    depends_on:\n      - app\n    restart: unless-stopped\n\nvolumes:\n  postgres_data:\n</code></pre>"},{"location":"deployment/#aws-ec2","title":"AWS EC2","text":""},{"location":"deployment/#deploy-with-gunicorn","title":"Deploy with Gunicorn","text":"<pre><code># Install dependencies\nsudo apt-get update\nsudo apt-get install python3-pip python3-venv nginx\n\n# Clone repository\ngit clone https://github.com/yourusername/your-app.git\ncd your-app\n\n# Create virtual environment\npython3 -m venv venv\nsource venv/bin/activate\n\n# Install application\npip install poetry\npoetry install --no-dev\n\n# Create systemd service\nsudo nano /etc/systemd/system/fastauth.service\n</code></pre> <p>fastauth.service:</p> <pre><code>[Unit]\nDescription=FastAuth Application\nAfter=network.target\n\n[Service]\nUser=ubuntu\nWorkingDirectory=/home/ubuntu/your-app\nEnvironment=\"PATH=/home/ubuntu/your-app/venv/bin\"\nEnvironmentFile=/home/ubuntu/your-app/.env\nExecStart=/home/ubuntu/your-app/venv/bin/gunicorn \\\n    -w 4 \\\n    -k uvicorn.workers.UvicornWorker \\\n    -b 0.0.0.0:8000 \\\n    main:app\n\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <pre><code># Start service\nsudo systemctl daemon-reload\nsudo systemctl start fastauth\nsudo systemctl enable fastauth\n</code></pre>"},{"location":"deployment/#aws-ecsfargate","title":"AWS ECS/Fargate","text":"<pre><code>{\n  \"family\": \"fastauth\",\n  \"taskRoleArn\": \"arn:aws:iam::123456789:role/ecsTaskRole\",\n  \"networkMode\": \"awsvpc\",\n  \"containerDefinitions\": [\n    {\n      \"name\": \"fastauth-app\",\n      \"image\": \"your-ecr-repo/fastauth:latest\",\n      \"portMappings\": [\n        {\n          \"containerPort\": 8000,\n          \"protocol\": \"tcp\"\n        }\n      ],\n      \"environment\": [\n        {\n          \"name\": \"DATABASE_URL\",\n          \"value\": \"postgresql://...\"\n        }\n      ],\n      \"secrets\": [\n        {\n          \"name\": \"JWT_SECRET_KEY\",\n          \"valueFrom\": \"arn:aws:secretsmanager:us-east-1:123456789:secret:jwt-key\"\n        }\n      ],\n      \"logConfiguration\": {\n        \"logDriver\": \"awslogs\",\n        \"options\": {\n          \"awslogs-group\": \"/ecs/fastauth\",\n          \"awslogs-region\": \"us-east-1\",\n          \"awslogs-stream-prefix\": \"ecs\"\n        }\n      }\n    }\n  ],\n  \"requiresCompatibilities\": [\"FARGATE\"],\n  \"cpu\": \"256\",\n  \"memory\": \"512\"\n}\n</code></pre>"},{"location":"deployment/#heroku","title":"Heroku","text":"<pre><code># Install Heroku CLI\ncurl https://cli-assets.heroku.com/install.sh | sh\n\n# Login\nheroku login\n\n# Create app\nheroku create your-app-name\n\n# Add PostgreSQL\nheroku addons:create heroku-postgresql:hobby-dev\n\n# Set environment variables\nheroku config:set JWT_SECRET_KEY=$(openssl rand -hex 32)\nheroku config:set REQUIRE_EMAIL_VERIFICATION=true\n\n# Deploy\ngit push heroku main\n\n# Run migrations\nheroku run alembic upgrade head\n</code></pre> <p>Procfile:</p> <pre><code>web: gunicorn -w 4 -k uvicorn.workers.UvicornWorker main:app\n</code></pre>"},{"location":"deployment/#vercelrailway","title":"Vercel/Railway","text":"<p>These platforms work well with FastAPI but require serverless-friendly configurations.</p>"},{"location":"deployment/#security-hardening","title":"Security Hardening","text":""},{"location":"deployment/#httpstls","title":"HTTPS/TLS","text":"<p>Always use HTTPS in production.</p>"},{"location":"deployment/#lets-encrypt-with-nginx","title":"Let's Encrypt with Nginx","text":"<pre><code># Install Certbot\nsudo apt-get install certbot python3-certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d yourdomain.com -d www.yourdomain.com\n\n# Auto-renewal (cron)\nsudo certbot renew --dry-run\n</code></pre>"},{"location":"deployment/#nginx-ssl-configuration","title":"Nginx SSL Configuration","text":"<pre><code>server {\n    listen 443 ssl http2;\n    server_name yourdomain.com;\n\n    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n\n    # Security headers\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n\n    location / {\n        proxy_pass http://localhost:8000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# Redirect HTTP to HTTPS\nserver {\n    listen 80;\n    server_name yourdomain.com;\n    return 301 https://$server_name$request_uri;\n}\n</code></pre>"},{"location":"deployment/#cors-configuration","title":"CORS Configuration","text":"<pre><code>from fastapi.middleware.cors import CORSMiddleware\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\n        \"https://yourdomain.com\",\n        \"https://www.yourdomain.com\"\n    ],\n    allow_credentials=True,\n    allow_methods=[\"GET\", \"POST\", \"PUT\", \"DELETE\"],\n    allow_headers=[\"*\"],\n    max_age=3600,\n)\n</code></pre>"},{"location":"deployment/#rate-limiting","title":"Rate Limiting","text":"<p>FastAuth includes built-in rate limiting, but consider additional layers:</p> <p>Nginx rate limiting:</p> <pre><code># Define rate limit zone\nlimit_req_zone $binary_remote_addr zone=auth:10m rate=10r/s;\n\nlocation /auth {\n    limit_req zone=auth burst=20 nodelay;\n    proxy_pass http://localhost:8000;\n}\n</code></pre> <p>CloudFlare: Configure rate limiting rules in CloudFlare dashboard.</p>"},{"location":"deployment/#security-headers","title":"Security Headers","text":"<pre><code>from fastapi import FastAPI\nfrom starlette.middleware.trustedhost import TrustedHostMiddleware\n\napp = FastAPI()\n\n# Trusted host middleware\napp.add_middleware(\n    TrustedHostMiddleware,\n    allowed_hosts=[\"yourdomain.com\", \"www.yourdomain.com\"]\n)\n\n@app.middleware(\"http\")\nasync def add_security_headers(request, call_next):\n    response = await call_next(request)\n    response.headers[\"X-Content-Type-Options\"] = \"nosniff\"\n    response.headers[\"X-Frame-Options\"] = \"DENY\"\n    response.headers[\"X-XSS-Protection\"] = \"1; mode=block\"\n    response.headers[\"Strict-Transport-Security\"] = \"max-age=31536000; includeSubDomains\"\n    return response\n</code></pre>"},{"location":"deployment/#monitoring-and-logging","title":"Monitoring and Logging","text":""},{"location":"deployment/#application-logging","title":"Application Logging","text":"<pre><code>import logging\nfrom logging.handlers import RotatingFileHandler\n\n# Configure logging\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',\n    handlers=[\n        RotatingFileHandler(\n            'app.log',\n            maxBytes=10485760,  # 10MB\n            backupCount=10\n        ),\n        logging.StreamHandler()\n    ]\n)\n\nlogger = logging.getLogger(__name__)\n\n# Log authentication events\n@app.post(\"/auth/login\")\ndef login(payload: LoginRequest):\n    try:\n        result = authenticate_user(...)\n        logger.info(f\"User login successful: {payload.email}\")\n        return result\n    except InvalidCredentialsError:\n        logger.warning(f\"Failed login attempt: {payload.email}\")\n        raise\n</code></pre>"},{"location":"deployment/#error-tracking-with-sentry","title":"Error Tracking with Sentry","text":"<pre><code>pip install sentry-sdk[fastapi]\n</code></pre> <pre><code>import sentry_sdk\nfrom sentry_sdk.integrations.fastapi import FastApiIntegration\n\nsentry_sdk.init(\n    dsn=\"https://your-dsn@sentry.io/project-id\",\n    integrations=[FastApiIntegration()],\n    environment=\"production\",\n    traces_sample_rate=0.1,  # 10% of transactions\n)\n</code></pre>"},{"location":"deployment/#health-checks","title":"Health Checks","text":"<pre><code>@app.get(\"/health\")\ndef health_check():\n    # Check database connection\n    try:\n        with Session(engine) as session:\n            session.exec(select(1))\n        db_status = \"healthy\"\n    except Exception as e:\n        db_status = f\"unhealthy: {str(e)}\"\n\n    return {\n        \"status\": \"healthy\" if db_status == \"healthy\" else \"degraded\",\n        \"database\": db_status,\n        \"version\": \"1.0.0\"\n    }\n</code></pre>"},{"location":"deployment/#monitoring-with-prometheus","title":"Monitoring with Prometheus","text":"<pre><code>pip install prometheus-fastapi-instrumentator\n</code></pre> <pre><code>from prometheus_fastapi_instrumentator import Instrumentator\n\napp = FastAPI()\nInstrumentator().instrument(app).expose(app)\n</code></pre>"},{"location":"deployment/#performance-optimization","title":"Performance Optimization","text":""},{"location":"deployment/#caching","title":"Caching","text":"<p>Redis caching for sessions:</p> <pre><code>from redis import asyncio as aioredis\n\nredis = await aioredis.from_url(\"redis://localhost\")\n\n# Cache user sessions\nawait redis.setex(f\"session:{session_id}\", 3600, user_data)\ncached = await redis.get(f\"session:{session_id}\")\n</code></pre>"},{"location":"deployment/#database-optimization","title":"Database Optimization","text":"<p>Indexes:</p> <pre><code>from sqlmodel import Field, Index\n\nclass User(SQLModel, table=True):\n    email: str = Field(index=True, unique=True)\n    created_at: datetime = Field(index=True)\n\n    __table_args__ = (\n        Index('idx_user_email_active', 'email', 'is_active'),\n    )\n</code></pre> <p>Query optimization:</p> <pre><code># Use select() for efficient querying\nfrom sqlmodel import select\n\n# Good - only fetch needed columns\nstatement = select(User.id, User.email).where(User.is_active == True)\n\n# Avoid - fetches all columns\nusers = session.exec(select(User)).all()\n</code></pre>"},{"location":"deployment/#load-balancing","title":"Load Balancing","text":"<p>Nginx upstream:</p> <pre><code>upstream fastauth_backend {\n    server 127.0.0.1:8000;\n    server 127.0.0.1:8001;\n    server 127.0.0.1:8002;\n    server 127.0.0.1:8003;\n}\n\nserver {\n    location / {\n        proxy_pass http://fastauth_backend;\n    }\n}\n</code></pre>"},{"location":"deployment/#gunicorn-workers","title":"Gunicorn Workers","text":"<pre><code># Calculate workers: (2 x CPU cores) + 1\ngunicorn -w 9 -k uvicorn.workers.UvicornWorker main:app\n</code></pre>"},{"location":"deployment/#continuous-deployment","title":"Continuous Deployment","text":""},{"location":"deployment/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Deploy to Production\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Deploy to EC2\n        env:\n          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}\n        run: |\n          echo \"$SSH_PRIVATE_KEY\" &gt; key.pem\n          chmod 600 key.pem\n          ssh -i key.pem ubuntu@your-server.com &lt;&lt; 'EOF'\n            cd /app\n            git pull origin main\n            source venv/bin/activate\n            pip install -r requirements.txt\n            sudo systemctl restart fastauth\n          EOF\n</code></pre>"},{"location":"deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/#common-production-issues","title":"Common Production Issues","text":"<p>High memory usage: - Reduce Gunicorn workers - Enable connection pooling - Add caching layer</p> <p>Slow database queries: - Add database indexes - Use connection pooling - Enable query logging - Consider read replicas</p> <p>OAuth redirect errors: - Verify redirect URIs match exactly - Ensure HTTPS is configured - Check CORS settings</p>"},{"location":"deployment/#checklist-before-going-live","title":"Checklist Before Going Live","text":"<ul> <li> All secrets in environment variables/secrets manager</li> <li> HTTPS enabled with valid certificate</li> <li> Database backups automated</li> <li> Monitoring and alerting configured</li> <li> Error tracking (Sentry) set up</li> <li> Load testing completed</li> <li> Security audit passed</li> <li> Documentation updated</li> <li> Rollback plan documented</li> <li> Team trained on deployment process</li> </ul> <p>Your FastAuth application is now production-ready! \ud83d\ude80</p>"},{"location":"installation/","title":"Installation","text":"<p>FastAuth can be installed via pip, Poetry, or from source.</p>"},{"location":"installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.11 or higher</li> <li>FastAPI 0.125.0 or higher</li> </ul>"},{"location":"installation/#install-from-pypi","title":"Install from PyPI","text":"<pre><code>pip install sreekarnv-fastauth\n</code></pre>"},{"location":"installation/#install-with-poetry","title":"Install with Poetry","text":"<pre><code>poetry add fastauth\n</code></pre>"},{"location":"installation/#install-from-source","title":"Install from Source","text":"<pre><code>git clone https://github.com/sreekarnv/fastauth.git\ncd fastauth\npip install .\n</code></pre>"},{"location":"installation/#development-installation","title":"Development Installation","text":"<p>For development with all dev dependencies:</p> <pre><code>git clone https://github.com/sreekarnv/fastauth.git\ncd fastauth\npoetry install\n</code></pre> <p>This installs FastAuth along with testing, linting, and documentation tools.</p>"},{"location":"installation/#verify-installation","title":"Verify Installation","text":"<pre><code>import fastauth\nprint(fastauth.__version__)\n</code></pre>"},{"location":"manual-testing/","title":"Manual Testing Checklist","text":"<p>This guide provides a complete checklist for manually testing all FastAuth endpoints before publishing to PyPI.</p>"},{"location":"manual-testing/#prerequisites","title":"Prerequisites","text":"<ol> <li> <p>Start the application: <pre><code>uvicorn main:app --reload\n</code></pre></p> </li> <li> <p>Access Swagger UI: http://localhost:8000/docs</p> </li> <li> <p>Have these ready:</p> </li> <li>Email for testing (e.g., test@example.com)</li> <li>Strong password</li> <li>Notepad for saving tokens</li> </ol>"},{"location":"manual-testing/#testing-order","title":"Testing Order","text":"<p>Follow this order to test all features systematically.</p>"},{"location":"manual-testing/#1-authentication-endpoints","title":"1. Authentication Endpoints","text":""},{"location":"manual-testing/#register-user","title":"\u2705 Register User","text":"<p>Endpoint: <code>POST /auth/register</code></p> <p>Request: <pre><code>{\n  \"email\": \"test@example.com\",\n  \"password\": \"SecurePass123!\"\n}\n</code></pre></p> <p>Expected Response (201): <pre><code>{\n  \"id\": \"uuid\",\n  \"email\": \"test@example.com\",\n  \"is_verified\": false,\n  \"is_active\": true,\n  \"created_at\": \"2025-12-29T...\"\n}\n</code></pre></p> <p>Verify: - [ ] User created successfully - [ ] Email is correct - [ ] is_verified is false (if email verification enabled) - [ ] is_active is true</p> <p>Edge Cases: - [ ] Try registering same email again \u2192 400 \"User already exists\" - [ ] Try invalid email format \u2192 422 validation error - [ ] Try weak password \u2192 Should succeed (no password strength validation by default)</p>"},{"location":"manual-testing/#login","title":"\u2705 Login","text":"<p>Endpoint: <code>POST /auth/login</code></p> <p>Request: <pre><code>{\n  \"email\": \"test@example.com\",\n  \"password\": \"SecurePass123!\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"access_token\": \"eyJ...\",\n  \"refresh_token\": \"eyJ...\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p> <p>Verify: - [ ] Tokens received - [ ] Token type is \"bearer\"</p> <p>Save: - Access token \u2192 Use for authenticated requests - Refresh token \u2192 Use for token refresh</p> <p>Edge Cases: - [ ] Wrong password \u2192 401 \"Invalid credentials\" - [ ] Non-existent email \u2192 401 \"Invalid credentials\" - [ ] If email verification enabled and not verified \u2192 403 \"Email not verified\"</p>"},{"location":"manual-testing/#email-verification-if-enabled","title":"\u2705 Email Verification (if enabled)","text":"<p>Endpoint: <code>POST /auth/email-verification/resend</code></p> <p>Request: <pre><code>{\n  \"email\": \"test@example.com\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Verification email sent\",\n  \"token\": \"verification-token-string\"\n}\n</code></pre></p> <p>Note: In console email provider, token is returned. In production, it's sent via email.</p> <p>Save: Verification token</p> <p>Verify: - [ ] Token received (console mode) - [ ] Or check email (SMTP mode)</p> <p>Endpoint: <code>POST /auth/email-verification/confirm</code></p> <p>Request: <pre><code>{\n  \"token\": \"your-verification-token\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Email verified successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Email verified - [ ] Can now login if was blocked before</p> <p>Edge Cases: - [ ] Invalid token \u2192 400 \"Invalid token\" - [ ] Already verified \u2192 Should still succeed - [ ] Expired token \u2192 400 \"Token expired\"</p>"},{"location":"manual-testing/#refresh-token","title":"\u2705 Refresh Token","text":"<p>Endpoint: <code>POST /auth/refresh</code></p> <p>Request: <pre><code>{\n  \"refresh_token\": \"your-refresh-token\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"access_token\": \"new-access-token\",\n  \"refresh_token\": \"new-refresh-token\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p> <p>Verify: - [ ] New tokens received - [ ] Old refresh token is invalidated (try using it again \u2192 401)</p> <p>Update: Save new tokens</p>"},{"location":"manual-testing/#password-reset-request","title":"\u2705 Password Reset Request","text":"<p>Endpoint: <code>POST /auth/password-reset/request</code></p> <p>Request: <pre><code>{\n  \"email\": \"test@example.com\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Password reset email sent\"\n}\n</code></pre></p> <p>Verify: - [ ] Success message received - [ ] Check console/email for reset token</p> <p>Note: Even for non-existent emails, returns 200 (security: don't reveal if email exists)</p> <p>Save: Reset token</p>"},{"location":"manual-testing/#password-reset-confirm","title":"\u2705 Password Reset Confirm","text":"<p>Endpoint: <code>POST /auth/password-reset/confirm</code></p> <p>Request: <pre><code>{\n  \"token\": \"reset-token\",\n  \"new_password\": \"NewSecurePass456!\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Password reset successful\"\n}\n</code></pre></p> <p>Verify: - [ ] Password changed - [ ] Can login with new password - [ ] Cannot login with old password - [ ] Old tokens are invalidated</p> <p>Edge Cases: - [ ] Invalid token \u2192 400 \"Invalid token\" - [ ] Expired token \u2192 400 \"Token expired\" - [ ] Using same token twice \u2192 400 \"Token already used\"</p>"},{"location":"manual-testing/#logout","title":"\u2705 Logout","text":"<p>Endpoint: <code>POST /auth/logout</code></p> <p>Headers: None (doesn't require authentication)</p> <p>Request: <pre><code>{\n  \"refresh_token\": \"your-refresh-token\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Logged out successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Success message - [ ] Refresh token is revoked (try using it \u2192 401) - [ ] Access token still works until expiry</p>"},{"location":"manual-testing/#2-session-management-endpoints","title":"2. Session Management Endpoints","text":"<p>Setup: Login to get access token</p>"},{"location":"manual-testing/#list-sessions","title":"\u2705 List Sessions","text":"<p>Endpoint: <code>GET /sessions</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"sessions\": [\n    {\n      \"id\": \"uuid\",\n      \"device\": null,\n      \"ip_address\": \"127.0.0.1\",\n      \"user_agent\": \"python-requests/...\",\n      \"last_active\": \"2025-12-29T...\",\n      \"created_at\": \"2025-12-29T...\"\n    }\n  ]\n}\n</code></pre></p> <p>Verify: - [ ] At least one session returned - [ ] Session has created_at and last_active timestamps - [ ] Session ID is valid UUID</p>"},{"location":"manual-testing/#delete-specific-session","title":"\u2705 Delete Specific Session","text":"<p>Endpoint: <code>DELETE /sessions/{session_id}</code></p> <p>Setup: Create second session (login from different client/browser)</p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Session deleted successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Session deleted - [ ] Session no longer appears in list - [ ] Other sessions still active</p> <p>Edge Cases: - [ ] Invalid session ID \u2192 404 \"Session not found\" - [ ] Deleting another user's session \u2192 404 \"Session not found\"</p>"},{"location":"manual-testing/#delete-all-sessions","title":"\u2705 Delete All Sessions","text":"<p>Endpoint: <code>DELETE /sessions/all</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"All sessions deleted successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] All sessions deleted - [ ] Session list is empty - [ ] Current access token still works (stateless JWT)</p>"},{"location":"manual-testing/#3-account-management-endpoints","title":"3. Account Management Endpoints","text":"<p>Setup: Login to get access token</p>"},{"location":"manual-testing/#change-password","title":"\u2705 Change Password","text":"<p>Endpoint: <code>POST /account/change-password</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Request: <pre><code>{\n  \"current_password\": \"SecurePass123!\",\n  \"new_password\": \"NewPassword789!\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Password changed successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Password changed - [ ] Can login with new password - [ ] Cannot login with old password - [ ] All sessions except current are invalidated</p> <p>Edge Cases: - [ ] Wrong current password \u2192 400 \"Invalid password\" - [ ] No authentication \u2192 401 \"Unauthorized\"</p>"},{"location":"manual-testing/#request-email-change","title":"\u2705 Request Email Change","text":"<p>Endpoint: <code>POST /account/request-email-change</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Request: <pre><code>{\n  \"new_email\": \"newemail@example.com\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Email change requested. Please verify the token to complete the change.\",\n  \"token\": \"email-change-token\"\n}\n</code></pre></p> <p>Save: Email change token</p> <p>Verify: - [ ] Token received - [ ] Email not changed yet (still old email)</p> <p>Edge Cases: - [ ] Email already exists \u2192 400 \"Email already exists\"</p>"},{"location":"manual-testing/#confirm-email-change","title":"\u2705 Confirm Email Change","text":"<p>Endpoint: <code>POST /account/confirm-email-change</code></p> <p>Request (no auth required): <pre><code>{\n  \"token\": \"email-change-token\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Email changed successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Email changed - [ ] Login with new email works - [ ] Login with old email fails - [ ] is_verified reset to false (need to verify new email)</p> <p>Edge Cases: - [ ] Invalid token \u2192 400 \"Invalid token\" - [ ] Email taken by another user after request \u2192 400 \"Email no longer available\"</p>"},{"location":"manual-testing/#delete-account-soft-delete","title":"\u2705 Delete Account (Soft Delete)","text":"<p>Endpoint: <code>DELETE /account/delete</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Request: <pre><code>{\n  \"password\": \"your-password\",\n  \"hard_delete\": false\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Account deactivated successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Account deactivated (is_active = false) - [ ] Cannot login anymore - [ ] User still exists in database (soft delete) - [ ] All sessions invalidated</p>"},{"location":"manual-testing/#delete-account-hard-delete","title":"\u2705 Delete Account (Hard Delete)","text":"<p>Setup: Register a new test user</p> <p>Endpoint: <code>DELETE /account/delete</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Request: <pre><code>{\n  \"password\": \"your-password\",\n  \"hard_delete\": true\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"Account permanently deleted successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Account permanently deleted - [ ] Cannot login - [ ] User removed from database - [ ] All sessions invalidated</p> <p>Edge Cases: - [ ] Wrong password \u2192 400 \"Invalid password\"</p>"},{"location":"manual-testing/#4-role-based-access-control-rbac","title":"4. Role-Based Access Control (RBAC)","text":"<p>Setup: Create admin role and assign to user (via code/script)</p>"},{"location":"manual-testing/#create-test-roles","title":"\u2705 Create Test Roles","text":"<p>Run this setup script:</p> <pre><code>from sqlmodel import Session, create_engine\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyRoleAdapter, SQLAlchemyUserAdapter\nfrom fastauth.core.roles import create_role, create_permission, assign_role, assign_permission_to_role\n\nengine = create_engine(\"sqlite:///./app.db\")\nwith Session(engine) as session:\n    roles = SQLAlchemyRoleAdapter(session)\n    users = SQLAlchemyUserAdapter(session)\n\n    # Create roles\n    admin_role = create_role(roles, \"admin\", \"Administrator\")\n    user_role = create_role(roles, \"user\", \"Regular User\")\n\n    # Create permissions\n    delete_users = create_permission(roles, \"delete:users\", \"Delete users\")\n    view_users = create_permission(roles, \"view:users\", \"View users\")\n\n    # Assign permissions to roles\n    assign_permission_to_role(roles, \"admin\", \"delete:users\")\n    assign_permission_to_role(roles, \"admin\", \"view:users\")\n    assign_permission_to_role(roles, \"user\", \"view:users\")\n\n    # Assign admin role to test user\n    user = users.get_by_email(\"test@example.com\")\n    assign_role(roles, user.id, \"admin\")\n\n    session.commit()\n    print(\"Roles and permissions created!\")\n</code></pre>"},{"location":"manual-testing/#test-protected-route-role","title":"\u2705 Test Protected Route (Role)","text":"<p>Setup: Create a test endpoint</p> <pre><code>from fastauth.api.dependencies import require_role\n\n@app.get(\"/admin/dashboard\", dependencies=[Depends(require_role(\"admin\"))])\ndef admin_dashboard():\n    return {\"message\": \"Admin access granted\"}\n</code></pre> <p>Test: - [ ] With admin user \u2192 200 OK - [ ] Without admin role \u2192 403 \"Insufficient permissions\" - [ ] Without authentication \u2192 401 \"Unauthorized\"</p>"},{"location":"manual-testing/#test-protected-route-permission","title":"\u2705 Test Protected Route (Permission)","text":"<p>Setup: Create a test endpoint</p> <pre><code>from fastauth.api.dependencies import require_permission\n\n@app.delete(\"/admin/users/{id}\", dependencies=[Depends(require_permission(\"delete:users\"))])\ndef delete_user(id: str):\n    return {\"message\": f\"User {id} deleted\"}\n</code></pre> <p>Test: - [ ] With delete:users permission \u2192 200 OK - [ ] Without permission \u2192 403 \"Insufficient permissions\" - [ ] Without authentication \u2192 401 \"Unauthorized\"</p>"},{"location":"manual-testing/#5-oauth-20-endpoints","title":"5. OAuth 2.0 Endpoints","text":"<p>Setup: Configure Google OAuth credentials in .env</p>"},{"location":"manual-testing/#initiate-oauth-flow","title":"\u2705 Initiate OAuth Flow","text":"<p>Endpoint: <code>POST /oauth/google/authorize</code></p> <p>Request: <pre><code>{\n  \"redirect_uri\": \"http://localhost:8000/callback\",\n  \"use_pkce\": true\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"authorization_url\": \"https://accounts.google.com/o/oauth2/v2/auth?...\",\n  \"state\": \"random-state-token\"\n}\n</code></pre></p> <p>Save: State token</p> <p>Verify: - [ ] Authorization URL received - [ ] URL contains client_id, redirect_uri, state - [ ] URL contains code_challenge if PKCE enabled</p> <p>Test: Open authorization_url in browser</p>"},{"location":"manual-testing/#complete-oauth-flow","title":"\u2705 Complete OAuth Flow","text":"<p>Manual Steps: 1. Open authorization URL in browser 2. Login with Google 3. Grant permissions 4. Copy <code>code</code> and <code>state</code> from redirect URL</p> <p>Endpoint: <code>POST /oauth/google/callback</code></p> <p>Request: <pre><code>{\n  \"code\": \"authorization-code-from-google\",\n  \"state\": \"state-token-from-authorize\"\n}\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"access_token\": \"eyJ...\",\n  \"refresh_token\": \"eyJ...\",\n  \"token_type\": \"bearer\",\n  \"user\": {\n    \"id\": \"uuid\",\n    \"email\": \"googleuser@gmail.com\",\n    \"is_verified\": true,\n    \"is_active\": true\n  }\n}\n</code></pre></p> <p>Verify: - [ ] User created or logged in - [ ] JWT tokens received - [ ] Email is verified (OAuth emails pre-verified) - [ ] OAuth account linked</p> <p>Edge Cases: - [ ] Invalid state \u2192 400 \"Invalid state\" - [ ] Expired state \u2192 400 \"State expired\" - [ ] Invalid code \u2192 400 \"Code exchange failed\"</p>"},{"location":"manual-testing/#list-linked-oauth-accounts","title":"\u2705 List Linked OAuth Accounts","text":"<p>Endpoint: <code>GET /oauth/accounts</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"accounts\": [\n    {\n      \"id\": \"uuid\",\n      \"provider\": \"google\",\n      \"provider_user_id\": \"google_user_id\",\n      \"created_at\": \"2025-12-29T...\"\n    }\n  ]\n}\n</code></pre></p> <p>Verify: - [ ] OAuth account listed - [ ] Correct provider name - [ ] Has provider_user_id</p>"},{"location":"manual-testing/#unlink-oauth-account","title":"\u2705 Unlink OAuth Account","text":"<p>Endpoint: <code>DELETE /oauth/accounts/{account_id}</code></p> <p>Headers: <pre><code>Authorization: Bearer your-access-token\n</code></pre></p> <p>Expected Response (200): <pre><code>{\n  \"message\": \"OAuth account unlinked successfully\"\n}\n</code></pre></p> <p>Verify: - [ ] Account unlinked - [ ] No longer appears in list - [ ] User still exists (if has password or other OAuth)</p> <p>Edge Cases: - [ ] Invalid account ID \u2192 404 \"Account not found\" - [ ] Unlinking another user's account \u2192 404 \"Account not found\"</p>"},{"location":"manual-testing/#6-error-handling","title":"6. Error Handling","text":""},{"location":"manual-testing/#test-common-errors","title":"\u2705 Test Common Errors","text":"<p>Invalid JSON: <pre><code>curl -X POST http://localhost:8000/auth/register \\\n  -H \"Content-Type: application/json\" \\\n  -d 'invalid-json'\n</code></pre> - [ ] Returns 422 validation error</p> <p>Missing Required Fields: <pre><code>{\n  \"email\": \"test@example.com\"\n  // missing password\n}\n</code></pre> - [ ] Returns 422 validation error</p> <p>Invalid Token Format: <pre><code>Authorization: Bearer invalid-token-format\n</code></pre> - [ ] Returns 401 \"Invalid token\"</p> <p>Expired Access Token: Wait for token to expire or manually create expired token - [ ] Returns 401 \"Token expired\"</p> <p>No Authentication: Access protected route without token - [ ] Returns 401 \"Not authenticated\"</p>"},{"location":"manual-testing/#7-rate-limiting","title":"7. Rate Limiting","text":"<p>Test: Make multiple failed login attempts</p> <pre><code>for i in {1..10}; do\n  curl -X POST http://localhost:8000/auth/login \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\"email\":\"test@example.com\",\"password\":\"wrong\"}'\ndone\n</code></pre> <p>Verify: - [ ] After 5 attempts \u2192 429 \"Rate limit exceeded\" - [ ] After waiting \u2192 Can retry</p>"},{"location":"manual-testing/#testing-checklist-summary","title":"Testing Checklist Summary","text":""},{"location":"manual-testing/#authentication-8-endpoints","title":"Authentication (8 endpoints)","text":"<ul> <li> Register user</li> <li> Login</li> <li> Email verification (resend)</li> <li> Email verification (confirm)</li> <li> Refresh token</li> <li> Password reset (request)</li> <li> Password reset (confirm)</li> <li> Logout</li> </ul>"},{"location":"manual-testing/#sessions-3-endpoints","title":"Sessions (3 endpoints)","text":"<ul> <li> List sessions</li> <li> Delete specific session</li> <li> Delete all sessions</li> </ul>"},{"location":"manual-testing/#account-management-4-endpoints","title":"Account Management (4 endpoints)","text":"<ul> <li> Change password</li> <li> Request email change</li> <li> Confirm email change</li> <li> Delete account (soft + hard)</li> </ul>"},{"location":"manual-testing/#rbac-2-custom-endpoints","title":"RBAC (2 custom endpoints)","text":"<ul> <li> Protected route with role</li> <li> Protected route with permission</li> </ul>"},{"location":"manual-testing/#oauth-3-endpoints","title":"OAuth (3 endpoints)","text":"<ul> <li> Initiate OAuth flow</li> <li> Complete OAuth callback</li> <li> List linked accounts</li> <li> Unlink OAuth account</li> </ul>"},{"location":"manual-testing/#error-handling","title":"Error Handling","text":"<ul> <li> Invalid JSON</li> <li> Missing fields</li> <li> Invalid tokens</li> <li> Expired tokens</li> <li> No authentication</li> <li> Rate limiting</li> </ul>"},{"location":"manual-testing/#post-testing-checklist","title":"Post-Testing Checklist","text":"<p>Before publishing to PyPI:</p> <ul> <li> All endpoints tested and working</li> <li> All edge cases handled correctly</li> <li> Error messages are clear and helpful</li> <li> Rate limiting works</li> <li> OAuth flow works end-to-end</li> <li> Database operations successful</li> <li> No console errors or warnings</li> <li> Automated tests still passing (195 tests)</li> <li> Coverage still at 85%+</li> <li> Documentation is accurate</li> <li> CHANGELOG updated</li> <li> Version number bumped in pyproject.toml</li> </ul> <p>Once everything passes, you're ready to publish to PyPI! \ud83d\ude80</p>"},{"location":"oauth/","title":"OAuth 2.0 Authentication Guide","text":"<p>FastAuth provides built-in OAuth 2.0 authentication support, allowing users to sign in with popular providers like Google. This guide covers setup, configuration, and usage of OAuth features.</p>"},{"location":"oauth/#overview","title":"Overview","text":"<p>OAuth 2.0 enables users to: - Sign in with existing accounts (Google, GitHub, etc.) - Link multiple OAuth accounts to one user - Manage connected accounts - Use PKCE for enhanced security</p>"},{"location":"oauth/#supported-providers","title":"Supported Providers","text":"<p>Currently supported: - Google \u2705 (with PKCE support)</p> <p>Coming soon: - GitHub - Microsoft - Facebook - Twitter/X</p>"},{"location":"oauth/#quick-start","title":"Quick Start","text":""},{"location":"oauth/#1-configure-oauth-provider","title":"1. Configure OAuth Provider","text":""},{"location":"oauth/#google-oauth-setup","title":"Google OAuth Setup","text":"<ol> <li>Create Google Cloud Project:</li> <li>Go to Google Cloud Console</li> <li>Create a new project or select existing</li> <li> <p>Enable \"Google+ API\"</p> </li> <li> <p>Create OAuth 2.0 Credentials:</p> </li> <li>Navigate to \"APIs &amp; Services\" \u2192 \"Credentials\"</li> <li>Click \"Create Credentials\" \u2192 \"OAuth 2.0 Client ID\"</li> <li>Application type: \"Web application\"</li> <li> <p>Authorized redirect URIs:      <pre><code>http://localhost:8000/auth/oauth/google/callback  # Development\nhttps://yourdomain.com/auth/oauth/google/callback  # Production\n</code></pre></p> </li> <li> <p>Get Credentials:</p> </li> <li>Copy Client ID</li> <li>Copy Client Secret</li> </ol>"},{"location":"oauth/#2-configure-environment-variables","title":"2. Configure Environment Variables","text":"<p>Add to your <code>.env</code> file:</p> <pre><code># OAuth Configuration\nOAUTH_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com\nOAUTH_GOOGLE_CLIENT_SECRET=your-client-secret\nOAUTH_GOOGLE_REDIRECT_URI=http://localhost:8000/auth/oauth/google/callback\n\n# OAuth state token expiration (minutes)\nOAUTH_STATE_EXPIRE_MINUTES=10\n</code></pre>"},{"location":"oauth/#3-include-oauth-router","title":"3. Include OAuth Router","text":"<pre><code>from fastapi import FastAPI\nfrom fastauth import auth_router, oauth_router\n\napp = FastAPI()\n\n# Include OAuth router\napp.include_router(oauth_router)\napp.include_router(auth_router)\n</code></pre>"},{"location":"oauth/#4-test-oauth-flow","title":"4. Test OAuth Flow","text":"<pre><code># Start your application\nuvicorn main:app --reload\n\n# Navigate to:\n# http://localhost:8000/docs\n\n# Test the OAuth endpoints:\n# 1. POST /oauth/google/authorize\n# 2. POST /oauth/google/callback\n</code></pre>"},{"location":"oauth/#oauth-flow","title":"OAuth Flow","text":""},{"location":"oauth/#authorization-flow-diagram","title":"Authorization Flow Diagram","text":"<pre><code>1. User clicks \"Sign in with Google\"\n   \u2193\n2. Frontend: POST /oauth/google/authorize\n   Backend: Generates state token (CSRF protection)\n   Backend: Returns authorization URL\n   \u2193\n3. Frontend: Redirect user to authorization URL\n   \u2193\n4. User: Authenticates with Google\n   User: Grants permissions\n   \u2193\n5. Google: Redirects to callback URL with code and state\n   \u2193\n6. Frontend: POST /oauth/google/callback with code and state\n   Backend: Validates state token\n   Backend: Exchanges code for access token\n   Backend: Fetches user info from Google\n   Backend: Creates/links user account\n   Backend: Returns JWT tokens\n   \u2193\n7. User is authenticated\n</code></pre>"},{"location":"oauth/#security-features","title":"Security Features","text":"<p>State Token (CSRF Protection): - Random token generated per authorization request - Stored server-side with expiration (default: 10 minutes) - Validated on callback to prevent CSRF attacks</p> <p>PKCE (Proof Key for Code Exchange): - Optional enhanced security for public clients - Generates code verifier and challenge - Prevents authorization code interception attacks</p> <p>Token Encryption: - OAuth access/refresh tokens encrypted before storage - Prevents token theft from database</p>"},{"location":"oauth/#api-endpoints","title":"API Endpoints","text":""},{"location":"oauth/#initiate-oauth-flow","title":"Initiate OAuth Flow","text":"<p>Endpoint: <code>POST /oauth/{provider}/authorize</code></p> <p>Request: <pre><code>{\n  \"redirect_uri\": \"http://localhost:8000/auth/oauth/google/callback\",\n  \"use_pkce\": true  // Optional, recommended for mobile/SPA\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"authorization_url\": \"https://accounts.google.com/o/oauth2/v2/auth?...\",\n  \"state\": \"random-state-token\"\n}\n</code></pre></p> <p>Usage: <pre><code>// Frontend (JavaScript example)\nasync function initiateOAuth() {\n  const response = await fetch('/oauth/google/authorize', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      redirect_uri: window.location.origin + '/auth/callback',\n      use_pkce: true\n    })\n  });\n\n  const { authorization_url } = await response.json();\n\n  // Redirect user to Google\n  window.location.href = authorization_url;\n}\n</code></pre></p>"},{"location":"oauth/#complete-oauth-flow","title":"Complete OAuth Flow","text":"<p>Endpoint: <code>POST /oauth/{provider}/callback</code></p> <p>Request: <pre><code>{\n  \"code\": \"authorization-code-from-provider\",\n  \"state\": \"state-token-from-authorize\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"access_token\": \"eyJ...\",\n  \"refresh_token\": \"eyJ...\",\n  \"token_type\": \"bearer\",\n  \"user\": {\n    \"id\": \"uuid\",\n    \"email\": \"user@example.com\",\n    \"is_verified\": true,\n    \"is_active\": true\n  }\n}\n</code></pre></p> <p>Usage: <pre><code>// Frontend callback handler\nasync function handleOAuthCallback() {\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get('code');\n  const state = params.get('state');\n\n  const response = await fetch('/oauth/google/callback', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ code, state })\n  });\n\n  const { access_token, user } = await response.json();\n\n  // Store token and redirect to app\n  localStorage.setItem('token', access_token);\n  window.location.href = '/dashboard';\n}\n</code></pre></p>"},{"location":"oauth/#list-linked-accounts","title":"List Linked Accounts","text":"<p>Endpoint: <code>GET /oauth/accounts</code></p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Response: <pre><code>{\n  \"accounts\": [\n    {\n      \"id\": \"uuid\",\n      \"provider\": \"google\",\n      \"provider_user_id\": \"google_user_123\",\n      \"created_at\": \"2024-01-01T00:00:00\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"oauth/#unlink-oauth-account","title":"Unlink OAuth Account","text":"<p>Endpoint: <code>DELETE /oauth/accounts/{account_id}</code></p> <p>Headers: <pre><code>Authorization: Bearer {access_token}\n</code></pre></p> <p>Response: <pre><code>{\n  \"message\": \"OAuth account unlinked successfully\"\n}\n</code></pre></p>"},{"location":"oauth/#advanced-usage","title":"Advanced Usage","text":""},{"location":"oauth/#linking-oauth-to-existing-account","title":"Linking OAuth to Existing Account","text":"<p>If a user is already logged in and wants to link an OAuth provider:</p> <pre><code># Include user_id in state data\nfrom fastauth.api.dependencies import get_current_user\n\n@app.post(\"/oauth/google/link\")\nasync def link_google_account(\n    current_user: User = Depends(get_current_user)\n):\n    # Initiate OAuth with user context\n    result = initiate_oauth_flow(\n        oauth_states=oauth_state_adapter,\n        provider=google_provider,\n        redirect_uri=\"http://localhost:8000/auth/oauth/google/callback\",\n        state_data={\"link_user_id\": str(current_user.id)},\n        use_pkce=True\n    )\n\n    return result\n</code></pre> <p>During callback, the account will be linked to the existing user instead of creating a new one.</p>"},{"location":"oauth/#custom-oauth-providers","title":"Custom OAuth Providers","text":"<p>FastAuth supports custom OAuth providers. Implement the <code>OAuthProvider</code> interface:</p> <pre><code>from fastauth.providers.base import OAuthProvider\nimport httpx\n\nclass GitHubOAuthProvider(OAuthProvider):\n    def __init__(self, client_id: str, client_secret: str):\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.authorization_url = \"https://github.com/login/oauth/authorize\"\n        self.token_url = \"https://github.com/login/oauth/access_token\"\n        self.user_info_url = \"https://api.github.com/user\"\n\n    def get_authorization_url(\n        self,\n        redirect_uri: str,\n        state: str,\n        code_challenge: str | None = None\n    ) -&gt; str:\n        params = {\n            \"client_id\": self.client_id,\n            \"redirect_uri\": redirect_uri,\n            \"state\": state,\n            \"scope\": \"user:email\"\n        }\n        return f\"{self.authorization_url}?{urlencode(params)}\"\n\n    async def exchange_code_for_token(\n        self,\n        code: str,\n        redirect_uri: str,\n        code_verifier: str | None = None\n    ) -&gt; dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.post(\n                self.token_url,\n                data={\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"code\": code,\n                    \"redirect_uri\": redirect_uri\n                },\n                headers={\"Accept\": \"application/json\"}\n            )\n            return response.json()\n\n    async def get_user_info(self, access_token: str) -&gt; dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(\n                self.user_info_url,\n                headers={\"Authorization\": f\"Bearer {access_token}\"}\n            )\n            user_data = response.json()\n\n            return {\n                \"provider_user_id\": str(user_data[\"id\"]),\n                \"email\": user_data[\"email\"],\n                \"name\": user_data[\"name\"]\n            }\n</code></pre>"},{"location":"oauth/#configuration","title":"Configuration","text":""},{"location":"oauth/#settings","title":"Settings","text":"<p>All OAuth settings are configurable via environment variables:</p> <pre><code>from fastauth import Settings\n\nsettings = Settings(\n    # Google OAuth\n    oauth_google_client_id=\"your-client-id\",\n    oauth_google_client_secret=\"your-client-secret\",\n    oauth_google_redirect_uri=\"http://localhost:8000/auth/oauth/google/callback\",\n\n    # OAuth state expiration\n    oauth_state_expire_minutes=10,  # Default: 10 minutes\n\n    # Other FastAuth settings\n    jwt_secret_key=\"your-secret-key\",\n    require_email_verification=False  # OAuth emails are pre-verified\n)\n</code></pre>"},{"location":"oauth/#pkce-configuration","title":"PKCE Configuration","text":"<p>PKCE (Proof Key for Code Exchange) is recommended for: - Single Page Applications (SPAs) - Mobile applications - Any public client that cannot securely store secrets</p> <p>Enable PKCE per request:</p> <pre><code>{\n  \"redirect_uri\": \"...\",\n  \"use_pkce\": true\n}\n</code></pre>"},{"location":"oauth/#database-schema","title":"Database Schema","text":""},{"location":"oauth/#oauthaccount-model","title":"OAuthAccount Model","text":"<pre><code>class OAuthAccount(SQLModel, table=True):\n    id: UUID\n    user_id: UUID              # Foreign key to User\n    provider: str              # \"google\", \"github\", etc.\n    provider_user_id: str      # User ID from OAuth provider\n    access_token: str          # Encrypted access token\n    refresh_token: str | None  # Encrypted refresh token\n    expires_at: datetime | None\n    created_at: datetime\n</code></pre>"},{"location":"oauth/#oauthstate-model","title":"OAuthState Model","text":"<pre><code>class OAuthState(SQLModel, table=True):\n    id: UUID\n    state_hash: str            # Hashed state token\n    provider: str\n    redirect_uri: str\n    code_verifier: str | None  # For PKCE\n    state_data: dict | None    # Additional state (e.g., link_user_id)\n    expires_at: datetime\n    created_at: datetime\n</code></pre>"},{"location":"oauth/#security-best-practices","title":"Security Best Practices","text":""},{"location":"oauth/#1-always-use-https-in-production","title":"1. Always Use HTTPS in Production","text":"<pre><code># Production\noauth_google_redirect_uri=\"https://yourdomain.com/auth/oauth/google/callback\"\n\n# Never use HTTP in production\noauth_google_redirect_uri=\"http://yourdomain.com/...\"  # \u274c Insecure\n</code></pre>"},{"location":"oauth/#2-validate-redirect-uris","title":"2. Validate Redirect URIs","text":"<p>Only use pre-configured redirect URIs:</p> <pre><code># Register exact URIs with OAuth provider\nALLOWED_REDIRECT_URIS = [\n    \"http://localhost:8000/auth/oauth/google/callback\",  # Dev\n    \"https://yourdomain.com/auth/oauth/google/callback\"  # Prod\n]\n</code></pre>"},{"location":"oauth/#3-short-state-token-expiration","title":"3. Short State Token Expiration","text":"<p>Keep state tokens short-lived:</p> <pre><code># Default: 10 minutes (recommended)\noauth_state_expire_minutes=10\n\n# Too long (security risk)\noauth_state_expire_minutes=60  # \u274c Not recommended\n</code></pre>"},{"location":"oauth/#4-store-secrets-securely","title":"4. Store Secrets Securely","text":"<p>Never commit OAuth credentials:</p> <pre><code># .gitignore\n.env\n.env.local\n*.env\n</code></pre> <p>Use environment-specific configurations:</p> <pre><code># Development\nOAUTH_GOOGLE_CLIENT_ID=dev-client-id\n\n# Production (from secrets manager)\nOAUTH_GOOGLE_CLIENT_ID=$(aws secretsmanager get-secret-value...)\n</code></pre>"},{"location":"oauth/#5-use-pkce-for-public-clients","title":"5. Use PKCE for Public Clients","text":"<p>For SPAs and mobile apps, always use PKCE:</p> <pre><code>// Frontend\nconst response = await fetch('/oauth/google/authorize', {\n  method: 'POST',\n  body: JSON.stringify({\n    redirect_uri: window.location.origin + '/callback',\n    use_pkce: true  // Always true for SPAs\n  })\n});\n</code></pre>"},{"location":"oauth/#troubleshooting","title":"Troubleshooting","text":""},{"location":"oauth/#invalid-state-token","title":"\"Invalid state token\"","text":"<p>Cause: State token expired or already used.</p> <p>Solution: State tokens expire after 10 minutes. Ensure user completes OAuth flow quickly.</p>"},{"location":"oauth/#redirect-uri-mismatch","title":"\"Redirect URI mismatch\"","text":"<p>Cause: Redirect URI doesn't match what's registered with OAuth provider.</p> <p>Solution: Ensure exact match (including protocol, domain, port, path):</p> <pre><code># Google Cloud Console\nhttp://localhost:8000/auth/oauth/google/callback\n\n# Your .env\nOAUTH_GOOGLE_REDIRECT_URI=http://localhost:8000/auth/oauth/google/callback\n</code></pre>"},{"location":"oauth/#email-already-exists","title":"\"Email already exists\"","text":"<p>Cause: User already registered with email/password using the same email.</p> <p>Solution: Prompt user to log in with password first, then link OAuth account.</p>"},{"location":"oauth/#oauth-provider-not-configured","title":"\"OAuth provider not configured\"","text":"<p>Cause: Missing OAuth credentials in environment.</p> <p>Solution: Set required environment variables:</p> <pre><code>OAUTH_GOOGLE_CLIENT_ID=...\nOAUTH_GOOGLE_CLIENT_SECRET=...\nOAUTH_GOOGLE_REDIRECT_URI=...\n</code></pre>"},{"location":"oauth/#testing-oauth","title":"Testing OAuth","text":""},{"location":"oauth/#manual-testing","title":"Manual Testing","text":"<ol> <li>Start application with OAuth configured</li> <li>Navigate to <code>/docs</code> (Swagger UI)</li> <li>Test <code>POST /oauth/google/authorize</code></li> <li>Copy <code>authorization_url</code> and open in browser</li> <li>Complete OAuth flow</li> <li>Copy <code>code</code> and <code>state</code> from redirect</li> <li>Test <code>POST /oauth/google/callback</code></li> </ol>"},{"location":"oauth/#automated-testing","title":"Automated Testing","text":"<p>FastAuth includes comprehensive OAuth tests. See <code>tests/core/test_oauth.py</code> for examples:</p> <pre><code>@pytest.mark.asyncio\nasync def test_complete_oauth_flow_new_user(session):\n    # Setup\n    oauth_states = SQLAlchemyOAuthStateAdapter(session)\n    oauth_accounts = SQLAlchemyOAuthAccountAdapter(session)\n    users = SQLAlchemyUserAdapter(session)\n\n    # Initiate flow\n    result = initiate_oauth_flow(\n        oauth_states=oauth_states,\n        provider=mock_provider,\n        redirect_uri=\"http://localhost/callback\",\n        use_pkce=True\n    )\n\n    # Complete flow\n    user, is_new = await complete_oauth_flow(\n        oauth_states=oauth_states,\n        oauth_accounts=oauth_accounts,\n        users=users,\n        provider=mock_provider,\n        code=\"mock-code\",\n        state=result[\"state\"]\n    )\n\n    assert is_new is True\n    assert user.email == \"oauth@example.com\"\n</code></pre>"},{"location":"oauth/#additional-resources","title":"Additional Resources","text":"<ul> <li>OAuth 2.0 RFC 6749</li> <li>PKCE RFC 7636</li> <li>Google OAuth 2.0 Documentation</li> <li>OAuth Security Best Practices</li> </ul>"},{"location":"publishing/","title":"Publishing to PyPI Guide","text":"<p>This guide covers publishing FastAuth to the Python Package Index (PyPI).</p>"},{"location":"publishing/#prerequisites","title":"Prerequisites","text":""},{"location":"publishing/#1-pypi-account-setup","title":"1. PyPI Account Setup","text":"<p>Create accounts on both PyPI and TestPyPI:</p> <ul> <li>PyPI (production): https://pypi.org/account/register/</li> <li>TestPyPI (testing): https://test.pypi.org/account/register/</li> </ul>"},{"location":"publishing/#2-configure-api-tokens","title":"2. Configure API Tokens","text":"<p>Generate API tokens (recommended over passwords):</p> <ol> <li>Go to https://pypi.org/manage/account/token/</li> <li>Click \"Add API token\"</li> <li>Name: \"FastAuth CLI\"</li> <li>Scope: \"Entire account\" (or specific project after first upload)</li> <li>Copy the token (starts with <code>pypi-</code>)</li> </ol> <p>Repeat for TestPyPI: https://test.pypi.org/manage/account/token/</p>"},{"location":"publishing/#3-configure-poetry","title":"3. Configure Poetry","text":"<p>Store tokens in Poetry config:</p> <pre><code># TestPyPI token\npoetry config pypi-token.testpypi your-testpypi-token\n\n# PyPI token\npoetry config pypi-token.pypi your-pypi-token\n</code></pre> <p>Or create <code>~/.pypirc</code>:</p> <pre><code>[distutils]\nindex-servers =\n    pypi\n    testpypi\n\n[pypi]\nusername = __token__\npassword = pypi-your-token-here\n\n[testpypi]\nrepository = https://test.pypi.org/legacy/\nusername = __token__\npassword = pypi-your-testpypi-token-here\n</code></pre>"},{"location":"publishing/#4-install-build-tools","title":"4. Install Build Tools","text":"<pre><code>pip install --upgrade build twine\n</code></pre>"},{"location":"publishing/#pre-publication-checklist","title":"Pre-Publication Checklist","text":"<p>Before publishing, ensure everything is ready:</p>"},{"location":"publishing/#code-quality","title":"Code Quality","text":"<ul> <li> All tests passing (<code>poetry run test-cov</code>)</li> <li> Coverage at 85%+</li> <li> Linting passing (<code>poetry run ruff check .</code>)</li> <li> Code formatted (<code>poetry run black .</code>)</li> <li> No security vulnerabilities</li> </ul>"},{"location":"publishing/#documentation","title":"Documentation","text":"<ul> <li> README.md is complete and accurate</li> <li> CHANGELOG.md is updated</li> <li> All docs/ files are current</li> <li> API reference is complete</li> <li> Examples are tested and working</li> </ul>"},{"location":"publishing/#package-configuration","title":"Package Configuration","text":"<ul> <li> Version number bumped in <code>pyproject.toml</code></li> <li> Dependencies are correct and minimal</li> <li> Package metadata is accurate (author, description, keywords, etc.)</li> <li> License is specified (MIT)</li> <li> README is referenced</li> <li> Python version requirement is correct (&gt;=3.11)</li> </ul>"},{"location":"publishing/#manual-testing","title":"Manual Testing","text":"<ul> <li> All endpoints tested manually (see manual-testing.md)</li> <li> OAuth flow tested end-to-end</li> <li> RBAC tested with roles/permissions</li> <li> Session management tested</li> <li> Account management tested</li> <li> Error handling verified</li> </ul>"},{"location":"publishing/#legalcompliance","title":"Legal/Compliance","text":"<ul> <li> No secrets in code</li> <li> No copyrighted material</li> <li> License file included</li> <li> Third-party licenses reviewed</li> </ul>"},{"location":"publishing/#version-numbering","title":"Version Numbering","text":"<p>FastAuth follows Semantic Versioning:</p> <p>Format: <code>MAJOR.MINOR.PATCH</code></p> <ul> <li>MAJOR: Breaking changes</li> <li>MINOR: New features (backward compatible)</li> <li>PATCH: Bug fixes (backward compatible)</li> </ul>"},{"location":"publishing/#current-version-plan","title":"Current Version Plan","text":"<ul> <li>v0.1.0: Initial release (completed)</li> <li>v0.2.0: OAuth 2.0 + test infrastructure (current)</li> <li>v0.3.0: Additional OAuth providers (planned)</li> <li>v1.0.0: Production-ready stable release (future)</li> </ul>"},{"location":"publishing/#bumping-version","title":"Bumping Version","text":"<p>Edit <code>pyproject.toml</code>:</p> <pre><code>[tool.poetry]\nname = \"fastauth\"\nversion = \"0.2.0\"  # Update this\n</code></pre> <p>Also update in:</p> <pre><code>[project]\nversion = \"0.2.0\"  # Update this too\n</code></pre>"},{"location":"publishing/#building-the-package","title":"Building the Package","text":""},{"location":"publishing/#1-clean-previous-builds","title":"1. Clean Previous Builds","text":"<pre><code># Remove old build artifacts\nrm -rf dist/ build/ *.egg-info\n\n# Or on Windows\nrmdir /s dist\nrmdir /s build\n</code></pre>"},{"location":"publishing/#2-build-with-poetry","title":"2. Build with Poetry","text":"<pre><code># Build both wheel and source distribution\npoetry build\n</code></pre> <p>Output: <pre><code>Building fastauth (0.2.0)\n  - Building sdist\n  - Built fastauth-0.2.0.tar.gz\n  - Building wheel\n  - Built fastauth-0.2.0-py3-none-any.whl\n</code></pre></p> <p>Verify build: <pre><code>ls -l dist/\n# Should show:\n# fastauth-0.2.0-py3-none-any.whl\n# fastauth-0.2.0.tar.gz\n</code></pre></p>"},{"location":"publishing/#3-inspect-the-package","title":"3. Inspect the Package","text":"<pre><code># Check package contents\ntar -tzf dist/fastauth-0.2.0.tar.gz | head -20\n\n# Or for wheel\nunzip -l dist/fastauth-0.2.0-py3-none-any.whl | head -20\n</code></pre> <p>Verify: - [ ] Source files included (fastauth/*.py) - [ ] No sensitive files (.env, credentials) - [ ] No unnecessary files (tests/, examples/) - [ ] README included - [ ] LICENSE included</p>"},{"location":"publishing/#testing-on-testpypi","title":"Testing on TestPyPI","text":"<p>Always test on TestPyPI first!</p>"},{"location":"publishing/#1-publish-to-testpypi","title":"1. Publish to TestPyPI","text":"<pre><code>poetry publish -r testpypi\n</code></pre> <p>Or with twine:</p> <pre><code>twine upload --repository testpypi dist/*\n</code></pre> <p>Expected output: <pre><code>Uploading distributions to https://test.pypi.org/legacy/\nUploading fastauth-0.2.0-py3-none-any.whl\n100% \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nUploading fastauth-0.2.0.tar.gz\n100% \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nView at:\nhttps://test.pypi.org/project/fastauth/0.2.0/\n</code></pre></p>"},{"location":"publishing/#2-verify-on-testpypi","title":"2. Verify on TestPyPI","text":"<p>Visit: https://test.pypi.org/project/fastauth/</p> <p>Check: - [ ] Version number is correct - [ ] Description displays properly - [ ] README renders correctly - [ ] Links work (GitHub, documentation) - [ ] Dependencies are listed - [ ] Classifiers are correct - [ ] Files are downloadable</p>"},{"location":"publishing/#3-test-installation-from-testpypi","title":"3. Test Installation from TestPyPI","text":"<pre><code># Create test environment\npython -m venv test-env\nsource test-env/bin/activate  # On Windows: test-env\\Scripts\\activate\n\n# Install from TestPyPI\npip install --index-url https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple/ fastauth\n\n# Verify installation\npython -c \"import fastauth; print(fastauth.__version__)\"\n# Should print: 0.2.0\n\n# Test basic import\npython\n&gt;&gt;&gt; from fastauth import auth_router, Settings\n&gt;&gt;&gt; from fastauth.core.users import create_user\n&gt;&gt;&gt; # Test that imports work\n</code></pre>"},{"location":"publishing/#4-quick-functional-test","title":"4. Quick Functional Test","text":"<p>Create <code>test_install.py</code>:</p> <pre><code>from fastapi import FastAPI\nfrom fastauth import auth_router\n\napp = FastAPI()\napp.include_router(auth_router)\n\n# Run: uvicorn test_install:app\n# Visit: http://localhost:8000/docs\n# Verify: All endpoints appear\n</code></pre> <p>If any issues, fix them, bump version to <code>0.2.1</code>, rebuild, and republish to TestPyPI.</p>"},{"location":"publishing/#publishing-to-pypi-production","title":"Publishing to PyPI (Production)","text":"<p>Only proceed if TestPyPI testing was successful!</p>"},{"location":"publishing/#1-final-checks","title":"1. Final Checks","text":"<ul> <li> TestPyPI version tested and working</li> <li> No issues found during testing</li> <li> CHANGELOG updated with release notes</li> <li> Git tag created for release</li> <li> All tests passing</li> </ul>"},{"location":"publishing/#2-create-git-tag","title":"2. Create Git Tag","text":"<pre><code># Create annotated tag\ngit tag -a v0.2.0 -m \"Release v0.2.0: OAuth 2.0 + Test Infrastructure\"\n\n# Push tag to GitHub\ngit push origin v0.2.0\n</code></pre>"},{"location":"publishing/#3-publish-to-pypi","title":"3. Publish to PyPI","text":"<pre><code>poetry publish\n</code></pre> <p>Or with twine:</p> <pre><code>twine upload dist/*\n</code></pre> <p>Confirmation prompt: <pre><code>Publishing fastauth (0.2.0) to PyPI\nUsername: __token__\nPassword: [hidden]\n</code></pre></p> <p>Expected output: <pre><code>Uploading distributions to https://upload.pypi.org/legacy/\nUploading fastauth-0.2.0-py3-none-any.whl\n100% \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nUploading fastauth-0.2.0.tar.gz\n100% \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nView at:\nhttps://pypi.org/project/fastauth/0.2.0/\n</code></pre></p>"},{"location":"publishing/#4-verify-on-pypi","title":"4. Verify on PyPI","text":"<p>Visit: https://pypi.org/project/fastauth/</p> <p>Check: - [ ] Version is live - [ ] Description correct - [ ] README renders properly - [ ] Badge links work - [ ] Download files available</p>"},{"location":"publishing/#5-test-installation-from-pypi","title":"5. Test Installation from PyPI","text":"<pre><code># New environment\npython -m venv prod-test\nsource prod-test/bin/activate\n\n# Install from PyPI\npip install sreekarnv-fastauth\n\n# Verify\npython -c \"import fastauth; print(fastauth.__version__)\"\n</code></pre>"},{"location":"publishing/#post-publication-tasks","title":"Post-Publication Tasks","text":""},{"location":"publishing/#1-create-github-release","title":"1. Create GitHub Release","text":"<ol> <li>Go to: https://github.com/yourusername/fastauth/releases/new</li> <li>Tag: <code>v0.2.0</code></li> <li>Title: <code>v0.2.0 - OAuth 2.0 + Test Infrastructure</code></li> <li>Description: Copy from CHANGELOG.md</li> <li>Attach: dist files (optional)</li> <li>Publish release</li> </ol>"},{"location":"publishing/#2-update-documentation","title":"2. Update Documentation","text":"<p>Update README.md: <pre><code>## Installation\n\n```bash\npip install sreekarnv-fastauth\n</code></pre> <pre><code>**Update main README** to reference version `0.2.0`.\n\n### 3. Announce Release\n\n**GitHub Discussions**:\n- Announce new release\n- Highlight key features\n- Link to documentation\n\n**Social Media** (if applicable):\n- Twitter/X\n- Reddit (r/Python, r/FastAPI)\n- Dev.to\n- LinkedIn\n\n### 4. Monitor\n\n**Check**:\n- [ ] Download stats on PyPI\n- [ ] GitHub issues for installation problems\n- [ ] User feedback\n- [ ] Error reports\n\n## Common Issues and Solutions\n\n### \"Version already exists\"\n\n**Cause**: Version number already published.\n\n**Solution**: Bump version number and rebuild.\n\n```bash\n# In pyproject.toml\nversion = \"0.2.1\"  # Increment patch version\n\n# Rebuild and republish\npoetry build\npoetry publish\n</code></pre></p>"},{"location":"publishing/#authentication-failed","title":"\"Authentication failed\"","text":"<p>Cause: Invalid or expired API token.</p> <p>Solution: Generate new token and update config.</p> <pre><code>poetry config pypi-token.pypi your-new-token\n</code></pre>"},{"location":"publishing/#invalid-package-metadata","title":"\"Invalid package metadata\"","text":"<p>Cause: Missing or incorrect fields in <code>pyproject.toml</code>.</p> <p>Solution: Validate with:</p> <pre><code>poetry check\n</code></pre> <p>Fix any errors in <code>pyproject.toml</code>.</p>"},{"location":"publishing/#readme-not-rendering","title":"\"README not rendering\"","text":"<p>Cause: Markdown issues or invalid format.</p> <p>Solution: - Check README locally with Markdown viewer - Validate on https://commonmark.org/help/ - Ensure <code>readme = \"README.md\"</code> in pyproject.toml</p>"},{"location":"publishing/#dependencies-not-installing","title":"\"Dependencies not installing\"","text":"<p>Cause: Missing or incorrect dependency specifications.</p> <p>Solution: Check dependency versions:</p> <pre><code>dependencies = [\n    \"fastapi[all] (&gt;=0.125.0,&lt;0.126.0)\",\n    \"sqlmodel (&gt;=0.0.27,&lt;0.0.28)\",\n    # etc.\n]\n</code></pre>"},{"location":"publishing/#file-too-large","title":"\"File too large\"","text":"<p>Cause: Package includes large files.</p> <p>Solution: Update <code>.gitignore</code> and exclude from package:</p> <pre><code>[tool.poetry]\nexclude = [\n    \"tests\",\n    \"examples\",\n    \"docs\",\n    \".github\",\n    \"*.log\",\n]\n</code></pre>"},{"location":"publishing/#updating-an-existing-release","title":"Updating an Existing Release","text":"<p>You cannot replace a published version. Must publish new version.</p>"},{"location":"publishing/#for-critical-bugs","title":"For Critical Bugs","text":"<ol> <li>Fix bug</li> <li>Bump patch version: <code>0.2.0</code> \u2192 <code>0.2.1</code></li> <li>Update CHANGELOG</li> <li>Build and publish</li> <li>(Optional) Yank old version if critically broken</li> </ol>"},{"location":"publishing/#yanking-a-release","title":"Yanking a Release","text":"<p>Use only for critical issues (security, broken package).</p> <pre><code># Via PyPI web interface\n# Project &gt; Manage &gt; Options &gt; Delete/Yank\n\n# Mark as \"yanked\" (users can still install with specific version)\n# Or delete permanently (NOT recommended)\n</code></pre>"},{"location":"publishing/#automation-optional","title":"Automation (Optional)","text":""},{"location":"publishing/#github-actions-for-auto-publish","title":"GitHub Actions for Auto-Publish","text":"<p><code>.github/workflows/publish.yml</code>:</p> <pre><code>name: Publish to PyPI\n\non:\n  release:\n    types: [created]\n\njobs:\n  publish:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Set up Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.11'\n\n      - name: Install Poetry\n        run: |\n          pip install poetry\n          poetry config pypi-token.pypi ${{ secrets.PYPI_TOKEN }}\n\n      - name: Build and publish\n        run: |\n          poetry build\n          poetry publish\n</code></pre> <p>Setup: 1. Add PyPI token as GitHub secret: <code>PYPI_TOKEN</code> 2. Create GitHub release 3. Package auto-publishes</p>"},{"location":"publishing/#checklist-ready-to-publish","title":"Checklist: Ready to Publish?","text":""},{"location":"publishing/#pre-build","title":"Pre-Build","text":"<ul> <li> Version bumped</li> <li> CHANGELOG updated</li> <li> All tests passing</li> <li> Manual testing complete</li> <li> Documentation updated</li> <li> Git committed and pushed</li> </ul>"},{"location":"publishing/#build","title":"Build","text":"<ul> <li> Old builds cleaned</li> <li> <code>poetry build</code> successful</li> <li> Package contents verified</li> <li> No sensitive files included</li> </ul>"},{"location":"publishing/#test-on-testpypi","title":"Test on TestPyPI","text":"<ul> <li> Published to TestPyPI</li> <li> TestPyPI page looks correct</li> <li> Installation from TestPyPI works</li> <li> Basic functionality tested</li> </ul>"},{"location":"publishing/#publish-to-pypi","title":"Publish to PyPI","text":"<ul> <li> Git tag created</li> <li> <code>poetry publish</code> successful</li> <li> PyPI page verified</li> <li> Installation from PyPI works</li> <li> GitHub release created</li> </ul>"},{"location":"publishing/#post-publish","title":"Post-Publish","text":"<ul> <li> Announcement posted</li> <li> Monitoring set up</li> <li> README reflects new version</li> <li> Celebrate! \ud83c\udf89</li> </ul>"},{"location":"publishing/#quick-reference-commands","title":"Quick Reference Commands","text":"<pre><code># Bump version in pyproject.toml first\n\n# Clean build\nrm -rf dist/ build/ *.egg-info\n\n# Build\npoetry build\n\n# Test on TestPyPI\npoetry publish -r testpypi\n\n# Test install\npip install --index-url https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple/ fastauth\n\n# Create git tag\ngit tag -a v0.2.0 -m \"Release v0.2.0\"\ngit push origin v0.2.0\n\n# Publish to PyPI\npoetry publish\n\n# Verify\npip install sreekarnv-fastauth\npython -c \"import fastauth; print(fastauth.__version__)\"\n</code></pre> <p>You're now ready to publish FastAuth to PyPI! \ud83d\ude80</p> <p>Good luck with your first (or next) release!</p>"},{"location":"quickstart/","title":"Quick Start Guide","text":"<p>Get up and running with FastAuth in under 10 minutes. This guide covers installation, basic setup, and common use cases.</p>"},{"location":"quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11 or higher</li> <li>Basic knowledge of FastAPI</li> <li>(Optional) PostgreSQL, MySQL, or SQLite for production</li> </ul>"},{"location":"quickstart/#installation","title":"Installation","text":""},{"location":"quickstart/#from-pypi-recommended","title":"From PyPI (Recommended)","text":"<pre><code>pip install sreekarnv-fastauth\n</code></pre>"},{"location":"quickstart/#from-source","title":"From Source","text":"<pre><code>git clone https://github.com/sreekarnv/fastauth.git\ncd fastauth\npip install .\n</code></pre>"},{"location":"quickstart/#with-poetry","title":"With Poetry","text":"<pre><code>poetry add fastauth\n</code></pre>"},{"location":"quickstart/#basic-setup","title":"Basic Setup","text":""},{"location":"quickstart/#step-1-create-fastapi-application","title":"Step 1: Create FastAPI Application","text":"<p>Create <code>main.py</code>:</p> <pre><code>from fastapi import FastAPI, Depends\nfrom sqlmodel import Session, SQLModel, create_engine\nfrom fastauth import auth_router, sessions_router, account_router\nfrom fastauth.api import dependencies\nfrom fastauth.adapters.sqlalchemy.models import User\n\n# Database configuration\nDATABASE_URL = \"sqlite:///./app.db\"\nengine = create_engine(DATABASE_URL, connect_args={\"check_same_thread\": False})\n\ndef init_db():\n    \"\"\"Initialize database tables\"\"\"\n    SQLModel.metadata.create_all(engine)\n\ndef get_session():\n    \"\"\"Database session dependency\"\"\"\n    with Session(engine) as session:\n        yield session\n\n# Create FastAPI app\napp = FastAPI(title=\"My Auth App\")\n\n# Initialize database on startup\n@app.on_event(\"startup\")\ndef on_startup():\n    init_db()\n\n# Include FastAuth routers\napp.include_router(auth_router)\napp.include_router(sessions_router)\napp.include_router(account_router)\n\n# Override session dependency\napp.dependency_overrides[dependencies.get_session] = get_session\n\n# Health check endpoint\n@app.get(\"/\")\ndef root():\n    return {\"message\": \"Welcome to My Auth App\"}\n\n# Protected route example\nfrom fastauth.api.dependencies import get_current_user\n\n@app.get(\"/protected\")\ndef protected_route(current_user: User = Depends(get_current_user)):\n    return {\n        \"message\": f\"Hello {current_user.email}!\",\n        \"user_id\": str(current_user.id)\n    }\n</code></pre>"},{"location":"quickstart/#step-2-configure-environment-variables","title":"Step 2: Configure Environment Variables","text":"<p>Create <code>.env</code> file:</p> <pre><code># JWT Configuration\nJWT_SECRET_KEY=your-super-secret-key-change-this-in-production\nJWT_ALGORITHM=HS256\nACCESS_TOKEN_EXPIRE_MINUTES=30\nREFRESH_TOKEN_EXPIRE_DAYS=7\n\n# Email Configuration\nEMAIL_PROVIDER=console\nREQUIRE_EMAIL_VERIFICATION=false\n\n# Database (optional, defaults to SQLite)\nDATABASE_URL=sqlite:///./app.db\n</code></pre> <p>Generate secure secret key:</p> <pre><code># Option 1: Python\npython -c \"import secrets; print(secrets.token_urlsafe(32))\"\n\n# Option 2: OpenSSL\nopenssl rand -hex 32\n</code></pre>"},{"location":"quickstart/#step-3-install-dependencies","title":"Step 3: Install Dependencies","text":"<pre><code>pip install fastapi uvicorn sqlmodel python-dotenv\n</code></pre>"},{"location":"quickstart/#step-4-run-the-application","title":"Step 4: Run the Application","text":"<pre><code>uvicorn main:app --reload\n</code></pre> <p>Visit http://localhost:8000/docs to see the interactive API documentation.</p>"},{"location":"quickstart/#common-use-cases","title":"Common Use Cases","text":""},{"location":"quickstart/#1-user-registration-and-login","title":"1. User Registration and Login","text":"<p>Register a new user:</p> <pre><code>curl -X POST \"http://localhost:8000/auth/register\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"user@example.com\",\n    \"password\": \"securepassword123\"\n  }'\n</code></pre> <p>Login:</p> <pre><code>curl -X POST \"http://localhost:8000/auth/login\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"user@example.com\",\n    \"password\": \"securepassword123\"\n  }'\n</code></pre> <p>Response: <pre><code>{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p>"},{"location":"quickstart/#2-accessing-protected-routes","title":"2. Accessing Protected Routes","text":"<pre><code>curl -X GET \"http://localhost:8000/protected\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\"\n</code></pre>"},{"location":"quickstart/#3-refresh-token","title":"3. Refresh Token","text":"<pre><code>curl -X POST \"http://localhost:8000/auth/refresh\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"refresh_token\": \"YOUR_REFRESH_TOKEN\"\n  }'\n</code></pre>"},{"location":"quickstart/#4-logout","title":"4. Logout","text":"<pre><code>curl -X POST \"http://localhost:8000/auth/logout\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"refresh_token\": \"YOUR_REFRESH_TOKEN\"\n  }'\n</code></pre>"},{"location":"quickstart/#5-password-reset","title":"5. Password Reset","text":"<p>Request reset:</p> <pre><code>curl -X POST \"http://localhost:8000/auth/password-reset/request\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"user@example.com\"\n  }'\n</code></pre> <p>Confirm reset:</p> <pre><code>curl -X POST \"http://localhost:8000/auth/password-reset/confirm\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"token\": \"RESET_TOKEN\",\n    \"new_password\": \"newpassword123\"\n  }'\n</code></pre>"},{"location":"quickstart/#adding-email-verification","title":"Adding Email Verification","text":""},{"location":"quickstart/#step-1-update-environment-variables","title":"Step 1: Update Environment Variables","text":"<pre><code># Enable email verification\nREQUIRE_EMAIL_VERIFICATION=true\n\n# Configure email provider (console for development)\nEMAIL_PROVIDER=console\n</code></pre>"},{"location":"quickstart/#step-2-verify-email-endpoint","title":"Step 2: Verify Email Endpoint","text":"<p>Request verification email:</p> <pre><code>curl -X POST \"http://localhost:8000/auth/email-verification/resend\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"user@example.com\"\n  }'\n</code></pre> <p>Confirm email:</p> <pre><code>curl -X POST \"http://localhost:8000/auth/email-verification/confirm\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"token\": \"VERIFICATION_TOKEN\"\n  }'\n</code></pre>"},{"location":"quickstart/#adding-role-based-access-control-rbac","title":"Adding Role-Based Access Control (RBAC)","text":""},{"location":"quickstart/#step-1-create-roles-and-permissions","title":"Step 1: Create Roles and Permissions","text":"<pre><code>from fastauth.core.roles import create_role, create_permission, assign_role, assign_permission_to_role\nfrom fastauth.adapters.sqlalchemy import SQLAlchemyRoleAdapter\n\n@app.on_event(\"startup\")\ndef setup_roles():\n    with Session(engine) as session:\n        roles = SQLAlchemyRoleAdapter(session)\n\n        # Create admin role\n        admin_role = create_role(\n            roles=roles,\n            name=\"admin\",\n            description=\"Administrator role\"\n        )\n\n        # Create permissions\n        delete_users = create_permission(\n            roles=roles,\n            name=\"delete:users\",\n            description=\"Delete users\"\n        )\n\n        # Assign permission to role\n        assign_permission_to_role(\n            roles=roles,\n            role_name=\"admin\",\n            permission_name=\"delete:users\"\n        )\n\n        session.commit()\n</code></pre>"},{"location":"quickstart/#step-2-protect-routes-with-roles","title":"Step 2: Protect Routes with Roles","text":"<pre><code>from fastauth.api.dependencies import require_role, require_permission\n\n# Require admin role\n@app.get(\"/admin/dashboard\", dependencies=[Depends(require_role(\"admin\"))])\ndef admin_dashboard():\n    return {\"message\": \"Admin dashboard\"}\n\n# Require specific permission\n@app.delete(\"/users/{user_id}\", dependencies=[Depends(require_permission(\"delete:users\"))])\ndef delete_user(user_id: str):\n    return {\"message\": f\"User {user_id} deleted\"}\n</code></pre>"},{"location":"quickstart/#step-3-assign-roles-to-users","title":"Step 3: Assign Roles to Users","text":"<pre><code>from fastauth.core.roles import assign_role\n\n@app.post(\"/admin/users/{user_id}/roles/{role_name}\")\ndef assign_user_role(\n    user_id: str,\n    role_name: str,\n    current_user: User = Depends(get_current_user)\n):\n    with Session(engine) as session:\n        roles = SQLAlchemyRoleAdapter(session)\n        assign_role(roles=roles, user_id=user_id, role_name=role_name)\n        session.commit()\n    return {\"message\": f\"Role {role_name} assigned to user\"}\n</code></pre>"},{"location":"quickstart/#adding-oauth-20-authentication","title":"Adding OAuth 2.0 Authentication","text":""},{"location":"quickstart/#step-1-configure-oauth-provider","title":"Step 1: Configure OAuth Provider","text":"<p>Add to <code>.env</code>:</p> <pre><code># Google OAuth\nOAUTH_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com\nOAUTH_GOOGLE_CLIENT_SECRET=your-client-secret\nOAUTH_GOOGLE_REDIRECT_URI=http://localhost:8000/auth/oauth/google/callback\n</code></pre>"},{"location":"quickstart/#step-2-include-oauth-router","title":"Step 2: Include OAuth Router","text":"<pre><code>from fastauth import oauth_router\n\napp.include_router(oauth_router)\n</code></pre>"},{"location":"quickstart/#step-3-test-oauth-flow","title":"Step 3: Test OAuth Flow","text":"<p>Visit http://localhost:8000/docs and test: 1. <code>POST /oauth/google/authorize</code> - Get authorization URL 2. Visit the URL and complete OAuth 3. <code>POST /oauth/google/callback</code> - Exchange code for tokens</p> <p>See OAuth Guide for detailed setup.</p>"},{"location":"quickstart/#session-management","title":"Session Management","text":""},{"location":"quickstart/#list-active-sessions","title":"List Active Sessions","text":"<pre><code>curl -X GET \"http://localhost:8000/sessions\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\"\n</code></pre>"},{"location":"quickstart/#delete-specific-session","title":"Delete Specific Session","text":"<pre><code>curl -X DELETE \"http://localhost:8000/sessions/SESSION_ID\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\"\n</code></pre>"},{"location":"quickstart/#delete-all-sessions","title":"Delete All Sessions","text":"<pre><code>curl -X DELETE \"http://localhost:8000/sessions/all\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\"\n</code></pre>"},{"location":"quickstart/#account-management","title":"Account Management","text":""},{"location":"quickstart/#change-password","title":"Change Password","text":"<pre><code>curl -X POST \"http://localhost:8000/account/change-password\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"current_password\": \"oldpassword123\",\n    \"new_password\": \"newpassword456\"\n  }'\n</code></pre>"},{"location":"quickstart/#request-email-change","title":"Request Email Change","text":"<pre><code>curl -X POST \"http://localhost:8000/account/request-email-change\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"new_email\": \"newemail@example.com\"\n  }'\n</code></pre>"},{"location":"quickstart/#delete-account","title":"Delete Account","text":"<pre><code># Soft delete (deactivate)\ncurl -X DELETE \"http://localhost:8000/account/delete\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"password\": \"userpassword\",\n    \"hard_delete\": false\n  }'\n\n# Hard delete (permanent)\ncurl -X DELETE \"http://localhost:8000/account/delete\" \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"password\": \"userpassword\",\n    \"hard_delete\": true\n  }'\n</code></pre>"},{"location":"quickstart/#frontend-integration","title":"Frontend Integration","text":""},{"location":"quickstart/#react-example","title":"React Example","text":"<pre><code>// Auth service\nclass AuthService {\n  async register(email, password) {\n    const response = await fetch('http://localhost:8000/auth/register', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password })\n    });\n    return response.json();\n  }\n\n  async login(email, password) {\n    const response = await fetch('http://localhost:8000/auth/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password })\n    });\n    const data = await response.json();\n\n    // Store tokens\n    localStorage.setItem('access_token', data.access_token);\n    localStorage.setItem('refresh_token', data.refresh_token);\n\n    return data;\n  }\n\n  async getProtectedData() {\n    const token = localStorage.getItem('access_token');\n    const response = await fetch('http://localhost:8000/protected', {\n      headers: { 'Authorization': `Bearer ${token}` }\n    });\n    return response.json();\n  }\n\n  async refreshToken() {\n    const refresh_token = localStorage.getItem('refresh_token');\n    const response = await fetch('http://localhost:8000/auth/refresh', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ refresh_token })\n    });\n    const data = await response.json();\n\n    // Update tokens\n    localStorage.setItem('access_token', data.access_token);\n    localStorage.setItem('refresh_token', data.refresh_token);\n\n    return data;\n  }\n\n  logout() {\n    const refresh_token = localStorage.getItem('refresh_token');\n    fetch('http://localhost:8000/auth/logout', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ refresh_token })\n    });\n\n    // Clear tokens\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n  }\n}\n\nexport default new AuthService();\n</code></pre>"},{"location":"quickstart/#vuejs-example","title":"Vue.js Example","text":"<pre><code>// composables/useAuth.js\nimport { ref } from 'vue';\n\nexport function useAuth() {\n  const user = ref(null);\n  const token = ref(localStorage.getItem('access_token'));\n\n  async function login(email, password) {\n    const response = await fetch('http://localhost:8000/auth/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password })\n    });\n\n    const data = await response.json();\n    token.value = data.access_token;\n    localStorage.setItem('access_token', data.access_token);\n    localStorage.setItem('refresh_token', data.refresh_token);\n\n    return data;\n  }\n\n  async function fetchProtected(url) {\n    return fetch(url, {\n      headers: { 'Authorization': `Bearer ${token.value}` }\n    });\n  }\n\n  function logout() {\n    token.value = null;\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n  }\n\n  return { user, token, login, fetchProtected, logout };\n}\n</code></pre>"},{"location":"quickstart/#testing","title":"Testing","text":"<p>Run the test suite:</p> <pre><code># Install dev dependencies\npoetry install\n\n# Run all tests\npoetry run pytest\n\n# Run with coverage\npoetry run test-cov\n\n# Open coverage report\nopen test-results/$(ls -t test-results | head -1)/htmlcov/index.html\n</code></pre> <p>See Testing Guide for detailed information.</p>"},{"location":"quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Architecture Guide - Understand FastAuth's design</li> <li>API Reference - Detailed API documentation</li> <li>OAuth Guide - Set up OAuth 2.0 authentication</li> <li>Deployment Guide - Deploy to production</li> <li>Testing Guide - Write and run tests</li> </ul>"},{"location":"quickstart/#common-issues","title":"Common Issues","text":""},{"location":"quickstart/#invalid-credentials","title":"\"Invalid credentials\"","text":"<p>Cause: Wrong email or password.</p> <p>Solution: Verify credentials or use password reset flow.</p>"},{"location":"quickstart/#email-not-verified","title":"\"Email not verified\"","text":"<p>Cause: Email verification is enabled but user hasn't verified.</p> <p>Solution: Either: - Disable verification: <code>REQUIRE_EMAIL_VERIFICATION=false</code> - Send verification email: <code>POST /auth/email-verification/resend</code></p>"},{"location":"quickstart/#token-expired","title":"\"Token expired\"","text":"<p>Cause: Access token has expired (default: 30 minutes).</p> <p>Solution: Use refresh token to get new access token: <code>POST /auth/refresh</code></p>"},{"location":"quickstart/#database-connection-errors","title":"Database connection errors","text":"<p>Cause: Database not initialized or connection string incorrect.</p> <p>Solution: - Verify <code>DATABASE_URL</code> in <code>.env</code> - Ensure <code>init_db()</code> is called on startup - Check database server is running (for PostgreSQL/MySQL)</p>"},{"location":"quickstart/#getting-help","title":"Getting Help","text":"<ul> <li>Documentation: https://github.com/sreekarnv/fastauth/tree/main/docs</li> <li>Issues: https://github.com/sreekarnv/fastauth/issues</li> <li>Discussions: https://github.com/sreekarnv/fastauth/discussions</li> </ul>"},{"location":"quickstart/#example-projects","title":"Example Projects","text":"<p>Check out example implementations:</p> <ul> <li>Basic Auth: <code>examples/basic/</code> - Minimal setup</li> <li>With RBAC: <code>examples/rbac/</code> - Role-based access control</li> <li>With OAuth: <code>examples/oauth/</code> - Google OAuth integration</li> <li>Full Stack: <code>examples/fullstack/</code> - React + FastAuth</li> </ul> <p>Congratulations! You now have a fully functional authentication system. \ud83c\udf89</p>"},{"location":"testing/","title":"Testing Guide","text":"<p>This guide covers testing practices, running tests, and understanding test coverage for FastAuth.</p>"},{"location":"testing/#quick-reference","title":"Quick Reference","text":""},{"location":"testing/#run-all-tests","title":"Run All Tests","text":"<pre><code># Basic test run\npoetry run pytest\n\n# With coverage (recommended)\npoetry run test-cov\n\n# Quiet mode\npoetry run test-cov -q\n\n# Verbose mode\npoetry run pytest -v\n</code></pre>"},{"location":"testing/#run-specific-tests","title":"Run Specific Tests","text":"<pre><code># Single test file\npoetry run pytest tests/core/test_oauth.py\n\n# Single test function\npoetry run pytest tests/core/test_oauth.py::test_initiate_oauth_flow_basic\n\n# Test pattern matching\npoetry run pytest -k \"oauth\"\n\n# Test by marker\npoetry run pytest -m \"slow\"\n</code></pre>"},{"location":"testing/#test-organization","title":"Test Organization","text":""},{"location":"testing/#directory-structure","title":"Directory Structure","text":"<pre><code>tests/\n\u251c\u2500\u2500 adapters/\n\u2502   \u2514\u2500\u2500 sqlalchemy/         # SQLAlchemy adapter tests\n\u2502       \u251c\u2500\u2500 test_user_adapter.py\n\u2502       \u251c\u2500\u2500 test_oauth_accounts.py\n\u2502       \u2514\u2500\u2500 conftest.py     # Shared fixtures\n\u251c\u2500\u2500 api/                    # API endpoint tests\n\u2502   \u251c\u2500\u2500 test_auth_flow.py\n\u2502   \u251c\u2500\u2500 test_oauth.py\n\u2502   \u2514\u2500\u2500 conftest.py\n\u251c\u2500\u2500 core/                   # Core business logic tests\n\u2502   \u251c\u2500\u2500 test_users.py\n\u2502   \u251c\u2500\u2500 test_oauth.py\n\u2502   \u2514\u2500\u2500 test_roles.py\n\u251c\u2500\u2500 security/               # Security module tests\n\u2502   \u251c\u2500\u2500 test_jwt.py\n\u2502   \u251c\u2500\u2500 test_oauth_security.py\n\u2502   \u2514\u2500\u2500 test_rate_limit.py\n\u2514\u2500\u2500 fakes/                  # Fake/mock adapters for testing\n    \u251c\u2500\u2500 oauth_accounts.py\n    \u2514\u2500\u2500 oauth_states.py\n</code></pre>"},{"location":"testing/#test-categories","title":"Test Categories","text":"<p>Unit Tests (<code>tests/core/</code>) - Test business logic in isolation - Use fake adapters to avoid database - Fast execution - Example: <code>tests/core/test_users.py</code></p> <p>Integration Tests (<code>tests/adapters/</code>) - Test adapter implementations - Use in-memory SQLite database - Verify database operations - Example: <code>tests/adapters/sqlalchemy/test_user_adapter.py</code></p> <p>API Tests (<code>tests/api/</code>) - Test HTTP endpoints end-to-end - Use FastAPI TestClient - Verify request/response handling - Example: <code>tests/api/test_auth_flow.py</code></p>"},{"location":"testing/#test-reports","title":"Test Reports","text":""},{"location":"testing/#report-structure","title":"Report Structure","text":"<p>All test reports are automatically generated in timestamped folders:</p> <pre><code>test-results/\n\u2514\u2500\u2500 YYYYMMDD_HHMMSS/\n    \u251c\u2500\u2500 report.html          # Interactive HTML test report\n    \u251c\u2500\u2500 junit.xml            # JUnit XML (for CI/CD)\n    \u251c\u2500\u2500 pytest.log           # Detailed test execution log\n    \u251c\u2500\u2500 coverage.xml         # Machine-readable coverage\n    \u251c\u2500\u2500 .coverage            # Coverage database file\n    \u2514\u2500\u2500 htmlcov/             # Interactive HTML coverage browser\n        \u2514\u2500\u2500 index.html\n</code></pre>"},{"location":"testing/#viewing-reports","title":"Viewing Reports","text":"<p>Test Results: <pre><code># Open latest HTML test report\nopen test-results/$(ls -t test-results | head -1)/report.html\n\n# On Windows\nstart test-results/YYYYMMDD_HHMMSS/report.html\n</code></pre></p> <p>Coverage: <pre><code># Open interactive coverage browser\nopen test-results/$(ls -t test-results | head -1)/htmlcov/index.html\n\n# On Windows\nstart test-results/YYYYMMDD_HHMMSS/htmlcov/index.html\n</code></pre></p>"},{"location":"testing/#cicd-integration","title":"CI/CD Integration","text":"<p>The <code>junit.xml</code> file can be used in CI/CD pipelines:</p> <pre><code># GitHub Actions example\n- name: Run tests\n  run: poetry run test-cov\n\n- name: Upload test results\n  uses: actions/upload-artifact@v3\n  with:\n    name: test-results\n    path: test-results/*/junit.xml\n</code></pre>"},{"location":"testing/#coverage","title":"Coverage","text":""},{"location":"testing/#current-coverage","title":"Current Coverage","text":"<ul> <li>Total Coverage: 85%</li> <li>Total Tests: 195</li> <li>All Tests Passing: \u2705</li> </ul>"},{"location":"testing/#coverage-goals","title":"Coverage Goals","text":"<ul> <li>Minimum: 80% (\u2705 Achieved)</li> <li>Target: 85% (\u2705 Achieved)</li> <li>Stretch: 90%</li> </ul>"},{"location":"testing/#viewing-coverage","title":"Viewing Coverage","text":"<p>Terminal Summary: <pre><code>poetry run test-cov\n# Coverage summary appears at the end\n</code></pre></p> <p>HTML Report (Recommended): <pre><code>poetry run test-cov\n# Open the latest htmlcov/index.html in your browser\n</code></pre></p> <p>The HTML coverage report shows: - Line-by-line coverage visualization - Branch coverage - Missing lines highlighted in red - Partial coverage in yellow</p>"},{"location":"testing/#coverage-by-module","title":"Coverage by Module","text":"<p>100% Coverage (38 files): - All core authentication flows - All test fixtures and fakes - Session management - Account management - RBAC functions</p> <p>85%+ Coverage: - Core OAuth flows (82%) - API dependencies (85%) - Account API (92%) - Email verification (89%)</p> <p>Areas for Improvement (&lt;40%): - OAuth API endpoints (32%) - OAuth adapters (33-39%) - Email providers (38-70%) - Google OAuth provider (39%)</p>"},{"location":"testing/#writing-tests","title":"Writing Tests","text":""},{"location":"testing/#test-structure","title":"Test Structure","text":"<p>Follow the Arrange-Act-Assert pattern:</p> <pre><code>def test_create_user_success():\n    # Arrange\n    users = FakeUserAdapter()\n    email = \"test@example.com\"\n    password = \"password123\"\n\n    # Act\n    user = create_user(users=users, email=email, password=password)\n\n    # Assert\n    assert user.email == email\n    assert user.hashed_password != password  # Password should be hashed\n    assert user.is_active is True\n</code></pre>"},{"location":"testing/#using-fixtures","title":"Using Fixtures","text":"<p>Session Fixture (database tests): <pre><code>def test_user_adapter(session):\n    # session is an in-memory SQLite database\n    adapter = SQLAlchemyUserAdapter(session)\n    user = adapter.create_user(\n        email=\"test@example.com\",\n        hashed_password=\"hashed...\"\n    )\n    assert user.id is not None\n</code></pre></p> <p>Client Fixture (API tests): <pre><code>def test_register_endpoint(client):\n    # client is a FastAPI TestClient\n    response = client.post(\"/auth/register\", json={\n        \"email\": \"test@example.com\",\n        \"password\": \"password123\"\n    })\n    assert response.status_code == 201\n</code></pre></p>"},{"location":"testing/#testing-async-code","title":"Testing Async Code","text":"<p>For async OAuth flows:</p> <pre><code>import pytest\n\n@pytest.mark.asyncio\nasync def test_complete_oauth_flow_new_user(session):\n    # Test async OAuth completion\n    user, is_new = await complete_oauth_flow(...)\n    assert is_new is True\n</code></pre>"},{"location":"testing/#testing-error-cases","title":"Testing Error Cases","text":"<p>Always test both success and failure paths:</p> <pre><code>def test_create_user_duplicate_email():\n    users = FakeUserAdapter()\n    email = \"test@example.com\"\n\n    # Create first user\n    create_user(users=users, email=email, password=\"pass1\")\n\n    # Attempt to create duplicate\n    with pytest.raises(UserAlreadyExistsError):\n        create_user(users=users, email=email, password=\"pass2\")\n</code></pre>"},{"location":"testing/#best-practices","title":"Best Practices","text":""},{"location":"testing/#1-test-independence","title":"1. Test Independence","text":"<p>Each test should be independent:</p> <pre><code># Good - independent\ndef test_user_creation():\n    users = FakeUserAdapter()  # Fresh adapter\n    user = create_user(users=users, email=\"test@example.com\", password=\"pass\")\n    assert user is not None\n\n# Bad - depends on previous state\nuser_adapter = FakeUserAdapter()  # Shared state\n\ndef test_first():\n    create_user(users=user_adapter, ...)  # Modifies shared state\n\ndef test_second():\n    # Assumes test_first ran first\n    user = user_adapter.get_by_email(...)\n</code></pre>"},{"location":"testing/#2-descriptive-test-names","title":"2. Descriptive Test Names","text":"<p>Use clear, descriptive names:</p> <pre><code># Good\ndef test_login_fails_if_email_not_verified():\n    ...\n\ndef test_refresh_token_rotation_on_use():\n    ...\n\n# Bad\ndef test_login():\n    ...\n\ndef test_token():\n    ...\n</code></pre>"},{"location":"testing/#3-test-one-thing","title":"3. Test One Thing","text":"<p>Each test should verify one specific behavior:</p> <pre><code># Good - tests one thing\ndef test_password_is_hashed_on_user_creation():\n    users = FakeUserAdapter()\n    password = \"plaintext\"\n    user = create_user(users=users, email=\"test@example.com\", password=password)\n    assert user.hashed_password != password\n\n# Bad - tests multiple things\ndef test_user_creation_and_login_and_token_refresh():\n    # Too much in one test\n    ...\n</code></pre>"},{"location":"testing/#4-use-fake-adapters-for-unit-tests","title":"4. Use Fake Adapters for Unit Tests","text":"<p>For core logic tests, use fake adapters:</p> <pre><code># tests/fakes/users.py\nclass FakeUserAdapter(UserAdapter):\n    def __init__(self):\n        self.users = {}\n\n    def create_user(self, email, hashed_password):\n        user = User(email=email, hashed_password=hashed_password)\n        self.users[email] = user\n        return user\n</code></pre> <p>Benefits: - No database required - Faster test execution - Easier to control test scenarios - True unit testing</p>"},{"location":"testing/#5-use-real-database-for-integration-tests","title":"5. Use Real Database for Integration Tests","text":"<p>For adapter tests, use real database:</p> <pre><code>@pytest.fixture\ndef session():\n    engine = create_engine(\n        \"sqlite:///:memory:\",\n        connect_args={\"check_same_thread\": False}\n    )\n    SQLModel.metadata.create_all(engine)\n    with Session(engine) as session:\n        yield session\n    engine.dispose()  # Clean up\n</code></pre>"},{"location":"testing/#continuous-integration","title":"Continuous Integration","text":"<p>FastAuth uses GitHub Actions for CI/CD:</p> <pre><code># .github/workflows/ci.yml\ntest:\n  runs-on: ubuntu-latest\n  strategy:\n    matrix:\n      python-version: [\"3.11\", \"3.12\", \"3.13\"]\n  steps:\n    - uses: actions/checkout@v3\n    - name: Set up Python\n      uses: actions/setup-python@v4\n      with:\n        python-version: ${{ matrix.python-version }}\n    - name: Install dependencies\n      run: |\n        pip install poetry\n        poetry install\n    - name: Run tests\n      run: poetry run pytest --cov=fastauth --cov-report=xml\n    - name: Upload coverage\n      uses: codecov/codecov-action@v3\n</code></pre>"},{"location":"testing/#ci-test-results","title":"CI Test Results","text":"<ul> <li>Tests run on every push and PR</li> <li>Matrix testing across Python 3.11, 3.12, 3.13</li> <li>Coverage reports uploaded to Codecov</li> <li>Status badges in README</li> </ul>"},{"location":"testing/#troubleshooting","title":"Troubleshooting","text":""},{"location":"testing/#resourcewarnings","title":"ResourceWarnings","text":"<p>If you see ResourceWarnings about unclosed database connections:</p> <pre><code># Ensure engine disposal in fixtures\n@pytest.fixture\ndef session():\n    engine = create_engine(\"sqlite:///:memory:\")\n    SQLModel.metadata.create_all(engine)\n    with Session(engine) as session:\n        yield session\n\n    # Important: Dispose engine to close connections\n    engine.dispose()\n</code></pre>"},{"location":"testing/#test-isolation-issues","title":"Test Isolation Issues","text":"<p>If tests pass individually but fail when run together:</p> <pre><code># Use fresh fixtures for each test\n@pytest.fixture\ndef users():\n    return FakeUserAdapter()  # New instance each time\n\n# Not this\nusers = FakeUserAdapter()  # Shared across tests\n</code></pre>"},{"location":"testing/#slow-tests","title":"Slow Tests","text":"<p>For slow tests (e.g., OAuth network requests):</p> <pre><code># Mark slow tests\n@pytest.mark.slow\ndef test_real_oauth_provider():\n    ...\n\n# Skip slow tests by default\npytest -m \"not slow\"\n\n# Run only slow tests\npytest -m \"slow\"\n</code></pre>"},{"location":"testing/#coverage-not-updated","title":"Coverage Not Updated","text":"<p>If coverage isn't updating:</p> <pre><code># Clear coverage cache\nrm -rf .coverage htmlcov/\n\n# Run tests fresh\npoetry run test-cov\n</code></pre>"},{"location":"testing/#additional-resources","title":"Additional Resources","text":"<ul> <li>pytest Documentation</li> <li>Coverage.py Documentation</li> <li>FastAPI Testing Guide</li> <li>Testing Best Practices</li> </ul>"},{"location":"reference/","title":"API Reference","text":"<p>Welcome to the FastAuth API reference documentation. This section provides detailed documentation for all FastAuth modules, classes, and functions.</p>"},{"location":"reference/#core-modules","title":"Core Modules","text":"<p>The core modules provide the main authentication and authorization functionality:</p> <ul> <li>Users: User management and authentication</li> <li>OAuth: OAuth 2.0 provider integration</li> <li>Sessions: Session management</li> <li>Roles: Role-based access control</li> <li>Account: Account management (email changes, password changes)</li> <li>Email Verification: Email verification functionality</li> <li>Password Reset: Password reset functionality</li> <li>Refresh Tokens: JWT refresh token management</li> <li>Hashing: Password hashing utilities</li> </ul>"},{"location":"reference/#adapters","title":"Adapters","text":"<p>Adapters provide database integration:</p>"},{"location":"reference/#base-adapters","title":"Base Adapters","text":"<p>Abstract base classes for implementing custom database adapters.</p>"},{"location":"reference/#sqlalchemy-adapters","title":"SQLAlchemy Adapters","text":"<p>Pre-built SQLAlchemy implementations of all adapters.</p>"},{"location":"reference/#api-routes","title":"API Routes","text":"<p>FastAPI router implementations for authentication endpoints:</p> <ul> <li>Auth Routes: Registration, login, logout</li> <li>OAuth Routes: OAuth provider authentication</li> <li>Account Routes: Account management</li> <li>Session Routes: Session management</li> </ul>"},{"location":"reference/#security","title":"Security","text":"<p>Security utilities and middleware:</p> <ul> <li>JWT: JSON Web Token generation and validation</li> <li>OAuth Security: OAuth-specific security utilities</li> <li>Rate Limiting: Rate limiting middleware</li> <li>Email Verification Security: Email verification token management</li> <li>Password Reset Security: Password reset token management</li> <li>Refresh Token Security: Refresh token validation</li> </ul>"},{"location":"reference/#email","title":"Email","text":"<p>Email sending capabilities:</p> <ul> <li>Base Email: Abstract email provider interface</li> <li>Console Provider: Development email provider (prints to console)</li> <li>SMTP Provider: Production SMTP email provider</li> <li>Email Factory: Factory for creating email providers</li> </ul>"},{"location":"reference/#oauth-providers","title":"OAuth Providers","text":"<p>OAuth provider implementations:</p> <ul> <li>Base Provider: Abstract OAuth provider interface</li> <li>Google: Google OAuth provider</li> </ul>"},{"location":"reference/#settings","title":"Settings","text":"<p>Configuration management for FastAuth.</p>"},{"location":"reference/settings/","title":"Settings","text":""},{"location":"reference/settings/#fastauth.settings","title":"settings","text":""},{"location":"reference/adapters/base/email_change/","title":"Email Change","text":""},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change","title":"email_change","text":""},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change-classes","title":"Classes","text":""},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change.EmailChangeAdapter","title":"EmailChangeAdapter","text":"<p>             Bases: <code>ABC</code></p> <p>Abstract base class for email change token database operations.</p>"},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change.EmailChangeAdapter-functions","title":"Functions","text":""},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change.EmailChangeAdapter.create","title":"create  <code>abstractmethod</code>","text":"<pre><code>create(*, user_id: UUID, new_email: str, token_hash: str, expires_at: datetime)\n</code></pre> <p>Create an email change request with a token.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>new_email</code> <code>str</code> <p>The new email address to change to</p> required <code>token_hash</code> <code>str</code> <p>Hashed verification token</p> required <code>expires_at</code> <code>datetime</code> <p>Token expiration datetime</p> required Source code in <code>fastauth/adapters/base/email_change.py</code> <pre><code>@abstractmethod\ndef create(\n    self,\n    *,\n    user_id: uuid.UUID,\n    new_email: str,\n    token_hash: str,\n    expires_at: datetime,\n):\n    \"\"\"\n    Create an email change request with a token.\n\n    Args:\n        user_id: User's unique identifier\n        new_email: The new email address to change to\n        token_hash: Hashed verification token\n        expires_at: Token expiration datetime\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change.EmailChangeAdapter.get_valid","title":"get_valid  <code>abstractmethod</code>","text":"<pre><code>get_valid(*, token_hash: str)\n</code></pre> <p>Get a valid (not used) email change record by token hash.</p> <p>Parameters:</p> Name Type Description Default <code>token_hash</code> <code>str</code> <p>Hashed token to look up</p> required <p>Returns:</p> Type Description <p>EmailChange record if found and not used, None otherwise</p> Source code in <code>fastauth/adapters/base/email_change.py</code> <pre><code>@abstractmethod\ndef get_valid(self, *, token_hash: str):\n    \"\"\"\n    Get a valid (not used) email change record by token hash.\n\n    Args:\n        token_hash: Hashed token to look up\n\n    Returns:\n        EmailChange record if found and not used, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/email_change/#fastauth.adapters.base.email_change.EmailChangeAdapter.mark_used","title":"mark_used  <code>abstractmethod</code>","text":"<pre><code>mark_used(*, token_hash: str) -&gt; None\n</code></pre> <p>Mark an email change token as used.</p> <p>Parameters:</p> Name Type Description Default <code>token_hash</code> <code>str</code> <p>Hashed token to mark as used</p> required Source code in <code>fastauth/adapters/base/email_change.py</code> <pre><code>@abstractmethod\ndef mark_used(self, *, token_hash: str) -&gt; None:\n    \"\"\"\n    Mark an email change token as used.\n\n    Args:\n        token_hash: Hashed token to mark as used\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/email_verification/","title":"Email Verification","text":""},{"location":"reference/adapters/base/email_verification/#fastauth.adapters.base.email_verification","title":"email_verification","text":""},{"location":"reference/adapters/base/oauth_accounts/","title":"Oauth Accounts","text":""},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts","title":"oauth_accounts","text":""},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts-classes","title":"Classes","text":""},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter","title":"OAuthAccountAdapter","text":"<p>             Bases: <code>ABC</code></p> <p>Abstract base class for OAuth account database operations.</p> <p>Implementations must provide database-specific logic for OAuth account management. The core business logic remains database-agnostic.</p>"},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter-functions","title":"Functions","text":""},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter.create","title":"create  <code>abstractmethod</code>","text":"<pre><code>create(\n    *,\n    user_id: UUID,\n    provider: str,\n    provider_user_id: str,\n    access_token_hash: str,\n    refresh_token_hash: str | None = None,\n    expires_at: datetime | None = None,\n    email: str | None = None,\n    name: str | None = None,\n    avatar_url: str | None = None\n)\n</code></pre> <p>Create a new OAuth account link.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>Internal user ID</p> required <code>provider</code> <code>str</code> <p>OAuth provider name (google, github, etc.)</p> required <code>provider_user_id</code> <code>str</code> <p>User ID from OAuth provider</p> required <code>access_token_hash</code> <code>str</code> <p>Hashed OAuth access token</p> required <code>refresh_token_hash</code> <code>str | None</code> <p>Optional hashed OAuth refresh token</p> <code>None</code> <code>expires_at</code> <code>datetime | None</code> <p>Token expiration time</p> <code>None</code> <code>email</code> <code>str | None</code> <p>Email from provider (for reference)</p> <code>None</code> <code>name</code> <code>str | None</code> <p>Display name from provider</p> <code>None</code> <code>avatar_url</code> <code>str | None</code> <p>Profile picture URL</p> <code>None</code> <p>Returns:</p> Type Description <p>Created OAuth account object</p> Source code in <code>fastauth/adapters/base/oauth_accounts.py</code> <pre><code>@abstractmethod\ndef create(\n    self,\n    *,\n    user_id: uuid.UUID,\n    provider: str,\n    provider_user_id: str,\n    access_token_hash: str,\n    refresh_token_hash: str | None = None,\n    expires_at: datetime | None = None,\n    email: str | None = None,\n    name: str | None = None,\n    avatar_url: str | None = None,\n):\n    \"\"\"\n    Create a new OAuth account link.\n\n    Args:\n        user_id: Internal user ID\n        provider: OAuth provider name (google, github, etc.)\n        provider_user_id: User ID from OAuth provider\n        access_token_hash: Hashed OAuth access token\n        refresh_token_hash: Optional hashed OAuth refresh token\n        expires_at: Token expiration time\n        email: Email from provider (for reference)\n        name: Display name from provider\n        avatar_url: Profile picture URL\n\n    Returns:\n        Created OAuth account object\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter.get_by_provider_user_id","title":"get_by_provider_user_id  <code>abstractmethod</code>","text":"<pre><code>get_by_provider_user_id(*, provider: str, provider_user_id: str)\n</code></pre> <p>Get OAuth account by provider and provider user ID.</p> <p>Parameters:</p> Name Type Description Default <code>provider</code> <code>str</code> <p>OAuth provider name</p> required <code>provider_user_id</code> <code>str</code> <p>User ID from OAuth provider</p> required <p>Returns:</p> Type Description <p>OAuth account if found, None otherwise</p> Source code in <code>fastauth/adapters/base/oauth_accounts.py</code> <pre><code>@abstractmethod\ndef get_by_provider_user_id(self, *, provider: str, provider_user_id: str):\n    \"\"\"\n    Get OAuth account by provider and provider user ID.\n\n    Args:\n        provider: OAuth provider name\n        provider_user_id: User ID from OAuth provider\n\n    Returns:\n        OAuth account if found, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter.get_by_user_id","title":"get_by_user_id  <code>abstractmethod</code>","text":"<pre><code>get_by_user_id(*, user_id: UUID, provider: str | None = None)\n</code></pre> <p>Get OAuth accounts for a user, optionally filtered by provider.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>provider</code> <code>str | None</code> <p>Optional provider name to filter by</p> <code>None</code> <p>Returns:</p> Type Description <p>List of OAuth account objects</p> Source code in <code>fastauth/adapters/base/oauth_accounts.py</code> <pre><code>@abstractmethod\ndef get_by_user_id(self, *, user_id: uuid.UUID, provider: str | None = None):\n    \"\"\"\n    Get OAuth accounts for a user, optionally filtered by provider.\n\n    Args:\n        user_id: User's unique identifier\n        provider: Optional provider name to filter by\n\n    Returns:\n        List of OAuth account objects\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter.update_tokens","title":"update_tokens  <code>abstractmethod</code>","text":"<pre><code>update_tokens(\n    *,\n    account_id: UUID,\n    access_token_hash: str,\n    refresh_token_hash: str | None = None,\n    expires_at: datetime | None = None\n) -&gt; None\n</code></pre> <p>Update OAuth tokens for an account.</p> <p>Parameters:</p> Name Type Description Default <code>account_id</code> <code>UUID</code> <p>OAuth account ID</p> required <code>access_token_hash</code> <code>str</code> <p>New hashed access token</p> required <code>refresh_token_hash</code> <code>str | None</code> <p>New hashed refresh token (if applicable)</p> <code>None</code> <code>expires_at</code> <code>datetime | None</code> <p>New expiration time</p> <code>None</code> Source code in <code>fastauth/adapters/base/oauth_accounts.py</code> <pre><code>@abstractmethod\ndef update_tokens(\n    self,\n    *,\n    account_id: uuid.UUID,\n    access_token_hash: str,\n    refresh_token_hash: str | None = None,\n    expires_at: datetime | None = None,\n) -&gt; None:\n    \"\"\"\n    Update OAuth tokens for an account.\n\n    Args:\n        account_id: OAuth account ID\n        access_token_hash: New hashed access token\n        refresh_token_hash: New hashed refresh token (if applicable)\n        expires_at: New expiration time\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_accounts/#fastauth.adapters.base.oauth_accounts.OAuthAccountAdapter.delete","title":"delete  <code>abstractmethod</code>","text":"<pre><code>delete(*, account_id: UUID) -&gt; None\n</code></pre> <p>Remove OAuth account link.</p> <p>Parameters:</p> Name Type Description Default <code>account_id</code> <code>UUID</code> <p>OAuth account ID to delete</p> required Source code in <code>fastauth/adapters/base/oauth_accounts.py</code> <pre><code>@abstractmethod\ndef delete(self, *, account_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Remove OAuth account link.\n\n    Args:\n        account_id: OAuth account ID to delete\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_states/","title":"Oauth States","text":""},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states","title":"oauth_states","text":""},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states-classes","title":"Classes","text":""},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states.OAuthStateAdapter","title":"OAuthStateAdapter","text":"<p>             Bases: <code>ABC</code></p> <p>Abstract base class for OAuth state token operations.</p> <p>State tokens prevent CSRF attacks in OAuth flows.</p>"},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states.OAuthStateAdapter-functions","title":"Functions","text":""},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states.OAuthStateAdapter.create","title":"create  <code>abstractmethod</code>","text":"<pre><code>create(\n    *,\n    state_hash: str,\n    provider: str,\n    redirect_uri: str,\n    code_challenge: str | None = None,\n    code_challenge_method: str | None = None,\n    user_id: UUID | None = None,\n    expires_at: datetime\n)\n</code></pre> <p>Create a new OAuth state token.</p> <p>Parameters:</p> Name Type Description Default <code>state_hash</code> <code>str</code> <p>Hashed state token</p> required <code>provider</code> <code>str</code> <p>OAuth provider name</p> required <code>redirect_uri</code> <code>str</code> <p>Callback URL after OAuth</p> required <code>code_challenge</code> <code>str | None</code> <p>Optional PKCE code challenge</p> <code>None</code> <code>code_challenge_method</code> <code>str | None</code> <p>PKCE challenge method (e.g., 'S256')</p> <code>None</code> <code>user_id</code> <code>UUID | None</code> <p>Optional user ID for linking existing account</p> <code>None</code> <code>expires_at</code> <code>datetime</code> <p>State token expiration datetime</p> required <p>Returns:</p> Type Description <p>Created OAuth state object</p> Source code in <code>fastauth/adapters/base/oauth_states.py</code> <pre><code>@abstractmethod\ndef create(\n    self,\n    *,\n    state_hash: str,\n    provider: str,\n    redirect_uri: str,\n    code_challenge: str | None = None,\n    code_challenge_method: str | None = None,\n    user_id: uuid.UUID | None = None,\n    expires_at: datetime,\n):\n    \"\"\"\n    Create a new OAuth state token.\n\n    Args:\n        state_hash: Hashed state token\n        provider: OAuth provider name\n        redirect_uri: Callback URL after OAuth\n        code_challenge: Optional PKCE code challenge\n        code_challenge_method: PKCE challenge method (e.g., 'S256')\n        user_id: Optional user ID for linking existing account\n        expires_at: State token expiration datetime\n\n    Returns:\n        Created OAuth state object\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states.OAuthStateAdapter.get_valid","title":"get_valid  <code>abstractmethod</code>","text":"<pre><code>get_valid(*, state_hash: str)\n</code></pre> <p>Get a valid (unused, non-expired) state token.</p> <p>Parameters:</p> Name Type Description Default <code>state_hash</code> <code>str</code> <p>Hashed state token to look up</p> required <p>Returns:</p> Type Description <p>OAuth state record if found and not used, None otherwise</p> Source code in <code>fastauth/adapters/base/oauth_states.py</code> <pre><code>@abstractmethod\ndef get_valid(self, *, state_hash: str):\n    \"\"\"\n    Get a valid (unused, non-expired) state token.\n\n    Args:\n        state_hash: Hashed state token to look up\n\n    Returns:\n        OAuth state record if found and not used, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states.OAuthStateAdapter.mark_used","title":"mark_used  <code>abstractmethod</code>","text":"<pre><code>mark_used(*, state_hash: str) -&gt; None\n</code></pre> <p>Mark a state token as used (one-time use).</p> <p>Parameters:</p> Name Type Description Default <code>state_hash</code> <code>str</code> <p>Hashed state token to mark as used</p> required Source code in <code>fastauth/adapters/base/oauth_states.py</code> <pre><code>@abstractmethod\ndef mark_used(self, *, state_hash: str) -&gt; None:\n    \"\"\"\n    Mark a state token as used (one-time use).\n\n    Args:\n        state_hash: Hashed state token to mark as used\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/oauth_states/#fastauth.adapters.base.oauth_states.OAuthStateAdapter.cleanup_expired","title":"cleanup_expired  <code>abstractmethod</code>","text":"<pre><code>cleanup_expired() -&gt; None\n</code></pre> <p>Remove expired state tokens from database.</p> <p>This can be called periodically to clean up old state tokens.</p> Source code in <code>fastauth/adapters/base/oauth_states.py</code> <pre><code>@abstractmethod\ndef cleanup_expired(self) -&gt; None:\n    \"\"\"\n    Remove expired state tokens from database.\n\n    This can be called periodically to clean up old state tokens.\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/password_reset/","title":"Password Reset","text":""},{"location":"reference/adapters/base/password_reset/#fastauth.adapters.base.password_reset","title":"password_reset","text":""},{"location":"reference/adapters/base/refresh_tokens/","title":"Refresh Tokens","text":""},{"location":"reference/adapters/base/refresh_tokens/#fastauth.adapters.base.refresh_tokens","title":"refresh_tokens","text":""},{"location":"reference/adapters/base/roles/","title":"Roles","text":""},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles","title":"roles","text":""},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles-classes","title":"Classes","text":""},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter","title":"RoleAdapter","text":"<p>             Bases: <code>ABC</code></p> <p>Abstract base class for role and permission database operations.</p> <p>Implementations must provide database-specific logic for RBAC. The core business logic remains database-agnostic.</p>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter-functions","title":"Functions","text":""},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.create_role","title":"create_role  <code>abstractmethod</code>","text":"<pre><code>create_role(*, name: str, description: str | None = None)\n</code></pre> <p>Create a new role.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Unique role name</p> required <code>description</code> <code>str | None</code> <p>Optional role description</p> <code>None</code> <p>Returns:</p> Type Description <p>Created role object</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef create_role(self, *, name: str, description: str | None = None):\n    \"\"\"\n    Create a new role.\n\n    Args:\n        name: Unique role name\n        description: Optional role description\n\n    Returns:\n        Created role object\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.get_role_by_name","title":"get_role_by_name  <code>abstractmethod</code>","text":"<pre><code>get_role_by_name(name: str)\n</code></pre> <p>Retrieve a role by name.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Role name</p> required <p>Returns:</p> Type Description <p>Role object if found, None otherwise</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef get_role_by_name(self, name: str):\n    \"\"\"\n    Retrieve a role by name.\n\n    Args:\n        name: Role name\n\n    Returns:\n        Role object if found, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.create_permission","title":"create_permission  <code>abstractmethod</code>","text":"<pre><code>create_permission(*, name: str, description: str | None = None)\n</code></pre> <p>Create a new permission.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Unique permission name</p> required <code>description</code> <code>str | None</code> <p>Optional permission description</p> <code>None</code> <p>Returns:</p> Type Description <p>Created permission object</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef create_permission(self, *, name: str, description: str | None = None):\n    \"\"\"\n    Create a new permission.\n\n    Args:\n        name: Unique permission name\n        description: Optional permission description\n\n    Returns:\n        Created permission object\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.get_permission_by_name","title":"get_permission_by_name  <code>abstractmethod</code>","text":"<pre><code>get_permission_by_name(name: str)\n</code></pre> <p>Retrieve a permission by name.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Permission name</p> required <p>Returns:</p> Type Description <p>Permission object if found, None otherwise</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef get_permission_by_name(self, name: str):\n    \"\"\"\n    Retrieve a permission by name.\n\n    Args:\n        name: Permission name\n\n    Returns:\n        Permission object if found, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.assign_role_to_user","title":"assign_role_to_user  <code>abstractmethod</code>","text":"<pre><code>assign_role_to_user(*, user_id: UUID, role_id: UUID) -&gt; None\n</code></pre> <p>Assign a role to a user.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>role_id</code> <code>UUID</code> <p>Role's unique identifier</p> required Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef assign_role_to_user(self, *, user_id: uuid.UUID, role_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Assign a role to a user.\n\n    Args:\n        user_id: User's unique identifier\n        role_id: Role's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.remove_role_from_user","title":"remove_role_from_user  <code>abstractmethod</code>","text":"<pre><code>remove_role_from_user(*, user_id: UUID, role_id: UUID) -&gt; None\n</code></pre> <p>Remove a role from a user.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>role_id</code> <code>UUID</code> <p>Role's unique identifier</p> required Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef remove_role_from_user(self, *, user_id: uuid.UUID, role_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Remove a role from a user.\n\n    Args:\n        user_id: User's unique identifier\n        role_id: Role's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.get_user_roles","title":"get_user_roles  <code>abstractmethod</code>","text":"<pre><code>get_user_roles(user_id: UUID)\n</code></pre> <p>Get all roles assigned to a user.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <p>Returns:</p> Type Description <p>List of role objects</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef get_user_roles(self, user_id: uuid.UUID):\n    \"\"\"\n    Get all roles assigned to a user.\n\n    Args:\n        user_id: User's unique identifier\n\n    Returns:\n        List of role objects\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.assign_permission_to_role","title":"assign_permission_to_role  <code>abstractmethod</code>","text":"<pre><code>assign_permission_to_role(*, role_id: UUID, permission_id: UUID) -&gt; None\n</code></pre> <p>Assign a permission to a role.</p> <p>Parameters:</p> Name Type Description Default <code>role_id</code> <code>UUID</code> <p>Role's unique identifier</p> required <code>permission_id</code> <code>UUID</code> <p>Permission's unique identifier</p> required Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef assign_permission_to_role(\n    self, *, role_id: uuid.UUID, permission_id: uuid.UUID\n) -&gt; None:\n    \"\"\"\n    Assign a permission to a role.\n\n    Args:\n        role_id: Role's unique identifier\n        permission_id: Permission's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.get_role_permissions","title":"get_role_permissions  <code>abstractmethod</code>","text":"<pre><code>get_role_permissions(role_id: UUID)\n</code></pre> <p>Get all permissions assigned to a role.</p> <p>Parameters:</p> Name Type Description Default <code>role_id</code> <code>UUID</code> <p>Role's unique identifier</p> required <p>Returns:</p> Type Description <p>List of permission objects</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef get_role_permissions(self, role_id: uuid.UUID):\n    \"\"\"\n    Get all permissions assigned to a role.\n\n    Args:\n        role_id: Role's unique identifier\n\n    Returns:\n        List of permission objects\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/roles/#fastauth.adapters.base.roles.RoleAdapter.get_user_permissions","title":"get_user_permissions  <code>abstractmethod</code>","text":"<pre><code>get_user_permissions(user_id: UUID)\n</code></pre> <p>Get all permissions for a user (from all their roles).</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <p>Returns:</p> Type Description <p>List of permission objects</p> Source code in <code>fastauth/adapters/base/roles.py</code> <pre><code>@abstractmethod\ndef get_user_permissions(self, user_id: uuid.UUID):\n    \"\"\"\n    Get all permissions for a user (from all their roles).\n\n    Args:\n        user_id: User's unique identifier\n\n    Returns:\n        List of permission objects\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/sessions/","title":"Sessions","text":""},{"location":"reference/adapters/base/sessions/#fastauth.adapters.base.sessions","title":"sessions","text":""},{"location":"reference/adapters/base/users/","title":"Users","text":""},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users","title":"users","text":""},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users-classes","title":"Classes","text":""},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter","title":"UserAdapter","text":"<p>             Bases: <code>ABC</code></p> <p>Abstract base class for user database operations.</p> <p>Implementations must provide database-specific logic for user management. The core business logic remains database-agnostic.</p>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter-functions","title":"Functions","text":""},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.get_by_email","title":"get_by_email  <code>abstractmethod</code>","text":"<pre><code>get_by_email(email: str)\n</code></pre> <p>Retrieve a user by email address.</p> <p>Parameters:</p> Name Type Description Default <code>email</code> <code>str</code> <p>User's email address</p> required <p>Returns:</p> Type Description <p>User object if found, None otherwise</p> Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef get_by_email(self, email: str):\n    \"\"\"\n    Retrieve a user by email address.\n\n    Args:\n        email: User's email address\n\n    Returns:\n        User object if found, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.get_by_id","title":"get_by_id  <code>abstractmethod</code>","text":"<pre><code>get_by_id(user_id: UUID)\n</code></pre> <p>Retrieve a user by ID.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <p>Returns:</p> Type Description <p>User object if found, None otherwise</p> Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef get_by_id(self, user_id: uuid.UUID):\n    \"\"\"\n    Retrieve a user by ID.\n\n    Args:\n        user_id: User's unique identifier\n\n    Returns:\n        User object if found, None otherwise\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.create_user","title":"create_user  <code>abstractmethod</code>","text":"<pre><code>create_user(*, email: str, hashed_password: str)\n</code></pre> <p>Create a new user.</p> <p>Parameters:</p> Name Type Description Default <code>email</code> <code>str</code> <p>User's email address</p> required <code>hashed_password</code> <code>str</code> <p>Already hashed password</p> required <p>Returns:</p> Type Description <p>Created user object</p> Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef create_user(self, *, email: str, hashed_password: str):\n    \"\"\"\n    Create a new user.\n\n    Args:\n        email: User's email address\n        hashed_password: Already hashed password\n\n    Returns:\n        Created user object\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.mark_verified","title":"mark_verified  <code>abstractmethod</code>","text":"<pre><code>mark_verified(user_id: UUID) -&gt; None\n</code></pre> <p>Mark a user's email as verified.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef mark_verified(self, user_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Mark a user's email as verified.\n\n    Args:\n        user_id: User's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.set_password","title":"set_password  <code>abstractmethod</code>","text":"<pre><code>set_password(*, user_id, hashed_password: str) -&gt; None\n</code></pre> <p>Update user's password.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <p>User's unique identifier</p> required <code>hashed_password</code> <code>str</code> <p>Already hashed password</p> required Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef set_password(self, *, user_id, hashed_password: str) -&gt; None:\n    \"\"\"\n    Update user's password.\n\n    Args:\n        user_id: User's unique identifier\n        hashed_password: Already hashed password\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.update_last_login","title":"update_last_login  <code>abstractmethod</code>","text":"<pre><code>update_last_login(user_id: UUID) -&gt; None\n</code></pre> <p>Update user's last login timestamp.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef update_last_login(self, user_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Update user's last login timestamp.\n\n    Args:\n        user_id: User's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.update_email","title":"update_email  <code>abstractmethod</code>","text":"<pre><code>update_email(*, user_id: UUID, new_email: str) -&gt; None\n</code></pre> <p>Update user's email address.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>new_email</code> <code>str</code> <p>New email address</p> required Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef update_email(self, *, user_id: uuid.UUID, new_email: str) -&gt; None:\n    \"\"\"\n    Update user's email address.\n\n    Args:\n        user_id: User's unique identifier\n        new_email: New email address\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.soft_delete_user","title":"soft_delete_user  <code>abstractmethod</code>","text":"<pre><code>soft_delete_user(*, user_id: UUID) -&gt; None\n</code></pre> <p>Soft delete a user by setting deleted_at timestamp.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef soft_delete_user(self, *, user_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Soft delete a user by setting deleted_at timestamp.\n\n    Args:\n        user_id: User's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/base/users/#fastauth.adapters.base.users.UserAdapter.hard_delete_user","title":"hard_delete_user  <code>abstractmethod</code>","text":"<pre><code>hard_delete_user(*, user_id: UUID) -&gt; None\n</code></pre> <p>Permanently delete a user from the database.</p> <p>Parameters:</p> Name Type Description Default <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required Source code in <code>fastauth/adapters/base/users.py</code> <pre><code>@abstractmethod\ndef hard_delete_user(self, *, user_id: uuid.UUID) -&gt; None:\n    \"\"\"\n    Permanently delete a user from the database.\n\n    Args:\n        user_id: User's unique identifier\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/adapters/sqlalchemy/email_change/","title":"Email Change","text":""},{"location":"reference/adapters/sqlalchemy/email_change/#fastauth.adapters.sqlalchemy.email_change","title":"email_change","text":""},{"location":"reference/adapters/sqlalchemy/email_change/#fastauth.adapters.sqlalchemy.email_change-classes","title":"Classes","text":""},{"location":"reference/adapters/sqlalchemy/email_verification/","title":"Email Verification","text":""},{"location":"reference/adapters/sqlalchemy/email_verification/#fastauth.adapters.sqlalchemy.email_verification","title":"email_verification","text":""},{"location":"reference/adapters/sqlalchemy/models/","title":"Models","text":""},{"location":"reference/adapters/sqlalchemy/models/#fastauth.adapters.sqlalchemy.models","title":"models","text":""},{"location":"reference/adapters/sqlalchemy/oauth_accounts/","title":"Oauth Accounts","text":""},{"location":"reference/adapters/sqlalchemy/oauth_accounts/#fastauth.adapters.sqlalchemy.oauth_accounts","title":"oauth_accounts","text":""},{"location":"reference/adapters/sqlalchemy/oauth_accounts/#fastauth.adapters.sqlalchemy.oauth_accounts-classes","title":"Classes","text":""},{"location":"reference/adapters/sqlalchemy/oauth_states/","title":"Oauth States","text":""},{"location":"reference/adapters/sqlalchemy/oauth_states/#fastauth.adapters.sqlalchemy.oauth_states","title":"oauth_states","text":""},{"location":"reference/adapters/sqlalchemy/oauth_states/#fastauth.adapters.sqlalchemy.oauth_states-classes","title":"Classes","text":""},{"location":"reference/adapters/sqlalchemy/password_reset/","title":"Password Reset","text":""},{"location":"reference/adapters/sqlalchemy/password_reset/#fastauth.adapters.sqlalchemy.password_reset","title":"password_reset","text":""},{"location":"reference/adapters/sqlalchemy/refresh_tokens/","title":"Refresh Tokens","text":""},{"location":"reference/adapters/sqlalchemy/refresh_tokens/#fastauth.adapters.sqlalchemy.refresh_tokens","title":"refresh_tokens","text":""},{"location":"reference/adapters/sqlalchemy/roles/","title":"Roles","text":""},{"location":"reference/adapters/sqlalchemy/roles/#fastauth.adapters.sqlalchemy.roles","title":"roles","text":""},{"location":"reference/adapters/sqlalchemy/roles/#fastauth.adapters.sqlalchemy.roles-classes","title":"Classes","text":""},{"location":"reference/adapters/sqlalchemy/sessions/","title":"Sessions","text":""},{"location":"reference/adapters/sqlalchemy/sessions/#fastauth.adapters.sqlalchemy.sessions","title":"sessions","text":""},{"location":"reference/adapters/sqlalchemy/users/","title":"Users","text":""},{"location":"reference/adapters/sqlalchemy/users/#fastauth.adapters.sqlalchemy.users","title":"users","text":""},{"location":"reference/adapters/sqlalchemy/users/#fastauth.adapters.sqlalchemy.users-classes","title":"Classes","text":""},{"location":"reference/api/account/","title":"Account","text":""},{"location":"reference/api/account/#fastauth.api.account","title":"account","text":""},{"location":"reference/api/account/#fastauth.api.account-classes","title":"Classes","text":""},{"location":"reference/api/account/#fastauth.api.account-functions","title":"Functions","text":""},{"location":"reference/api/account/#fastauth.api.account.change_user_password","title":"change_user_password","text":"<pre><code>change_user_password(\n    request: ChangePasswordRequest,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>Change the current user's password.</p> <p>Requires the current password for verification. Invalidates all other sessions after password change for security.</p> Source code in <code>fastauth/api/account.py</code> <pre><code>@router.post(\"/change-password\", response_model=MessageResponse)\ndef change_user_password(\n    request: ChangePasswordRequest,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    Change the current user's password.\n\n    Requires the current password for verification.\n    Invalidates all other sessions after password change for security.\n    \"\"\"\n    users_adapter = SQLAlchemyUserAdapter(session=session)\n    sessions_adapter = SQLAlchemySessionAdapter(session=session)\n\n    try:\n        change_password(\n            users=users_adapter,\n            sessions=sessions_adapter,\n            user_id=current_user.id,\n            current_password=request.current_password,\n            new_password=request.new_password,\n            current_session_id=None,\n        )\n    except InvalidPasswordError:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"Current password is incorrect\",\n        )\n    except UserNotFoundError:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"User not found\",\n        )\n\n    return MessageResponse(message=\"Password changed successfully\")\n</code></pre>"},{"location":"reference/api/account/#fastauth.api.account.delete_user_account","title":"delete_user_account","text":"<pre><code>delete_user_account(\n    request: DeleteAccountRequest,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>Delete the current user's account.</p> <p>Requires password for verification. Supports both soft delete (default) and hard delete. Soft delete sets deleted_at timestamp and deactivates the account. Hard delete permanently removes the user from the database.</p> Source code in <code>fastauth/api/account.py</code> <pre><code>@router.delete(\"/delete\", response_model=MessageResponse)\ndef delete_user_account(\n    request: DeleteAccountRequest,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    Delete the current user's account.\n\n    Requires password for verification.\n    Supports both soft delete (default) and hard delete.\n    Soft delete sets deleted_at timestamp and deactivates the account.\n    Hard delete permanently removes the user from the database.\n    \"\"\"\n    users_adapter = SQLAlchemyUserAdapter(session=session)\n    sessions_adapter = SQLAlchemySessionAdapter(session=session)\n\n    try:\n        delete_account(\n            users=users_adapter,\n            sessions=sessions_adapter,\n            user_id=current_user.id,\n            password=request.password,\n            hard_delete=request.hard_delete,\n        )\n    except InvalidPasswordError:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"Password is incorrect\",\n        )\n    except UserNotFoundError:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"User not found\",\n        )\n\n    delete_type = \"permanently deleted\" if request.hard_delete else \"deactivated\"\n    return MessageResponse(message=f\"Account {delete_type} successfully\")\n</code></pre>"},{"location":"reference/api/account/#fastauth.api.account.request_user_email_change","title":"request_user_email_change","text":"<pre><code>request_user_email_change(\n    request: RequestEmailChangeRequest,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>Request an email change for the current user.</p> <p>Generates a verification token that must be confirmed to complete the email change. The token expires in 60 minutes by default.</p> Source code in <code>fastauth/api/account.py</code> <pre><code>@router.post(\"/request-email-change\", response_model=EmailChangeTokenResponse)\ndef request_user_email_change(\n    request: RequestEmailChangeRequest,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    Request an email change for the current user.\n\n    Generates a verification token that must be confirmed to complete the email change.\n    The token expires in 60 minutes by default.\n    \"\"\"\n    users_adapter = SQLAlchemyUserAdapter(session=session)\n    email_changes_adapter = SQLAlchemyEmailChangeAdapter(session=session)\n\n    try:\n        token = request_email_change(\n            users=users_adapter,\n            email_changes=email_changes_adapter,\n            user_id=current_user.id,\n            new_email=request.new_email,\n            expires_in_minutes=60,\n        )\n    except EmailAlreadyExistsError:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"Email already exists\",\n        )\n\n    if not token:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"User not found\",\n        )\n\n    return EmailChangeTokenResponse(\n        message=\"Email change requested. \\\n            Please verify the token to complete the change.\",\n        token=token,\n    )\n</code></pre>"},{"location":"reference/api/account/#fastauth.api.account.confirm_user_email_change","title":"confirm_user_email_change","text":"<pre><code>confirm_user_email_change(\n    request: ConfirmEmailChangeRequest, session: Session = Depends(get_session)\n)\n</code></pre> <p>Confirm an email change with a verification token.</p> <p>Completes the email change process started with request-email-change.</p> Source code in <code>fastauth/api/account.py</code> <pre><code>@router.post(\"/confirm-email-change\", response_model=MessageResponse)\ndef confirm_user_email_change(\n    request: ConfirmEmailChangeRequest,\n    session: Session = Depends(get_session),\n):\n    \"\"\"\n    Confirm an email change with a verification token.\n\n    Completes the email change process started with request-email-change.\n    \"\"\"\n    users_adapter = SQLAlchemyUserAdapter(session=session)\n    email_changes_adapter = SQLAlchemyEmailChangeAdapter(session=session)\n\n    try:\n        confirm_email_change(\n            users=users_adapter,\n            email_changes=email_changes_adapter,\n            token=request.token,\n        )\n    except EmailChangeError as e:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=str(e),\n        )\n    except EmailAlreadyExistsError as e:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=str(e),\n        )\n\n    return MessageResponse(message=\"Email changed successfully\")\n</code></pre>"},{"location":"reference/api/auth/","title":"Auth","text":""},{"location":"reference/api/auth/#fastauth.api.auth","title":"auth","text":""},{"location":"reference/api/auth/#fastauth.api.auth-classes","title":"Classes","text":""},{"location":"reference/api/auth/#fastauth.api.auth-functions","title":"Functions","text":""},{"location":"reference/api/dependencies/","title":"Dependencies","text":""},{"location":"reference/api/dependencies/#fastauth.api.dependencies","title":"dependencies","text":""},{"location":"reference/api/dependencies/#fastauth.api.dependencies-classes","title":"Classes","text":""},{"location":"reference/api/dependencies/#fastauth.api.dependencies-functions","title":"Functions","text":""},{"location":"reference/api/dependencies/#fastauth.api.dependencies.require_role","title":"require_role","text":"<pre><code>require_role(role_name: str) -&gt; Callable\n</code></pre> <p>Create a dependency that requires a user to have a specific role.</p> <p>Parameters:</p> Name Type Description Default <code>role_name</code> <code>str</code> <p>Name of the required role</p> required <p>Returns:</p> Type Description <code>Callable</code> <p>Dependency function that can be used with FastAPI Depends</p> Example <p>@app.get(\"/admin\", dependencies=[Depends(require_role(\"admin\"))]) def admin_endpoint():     return {\"message\": \"Admin access granted\"}</p> Source code in <code>fastauth/api/dependencies.py</code> <pre><code>def require_role(role_name: str) -&gt; Callable:\n    \"\"\"\n    Create a dependency that requires a user to have a specific role.\n\n    Args:\n        role_name: Name of the required role\n\n    Returns:\n        Dependency function that can be used with FastAPI Depends\n\n    Example:\n        @app.get(\"/admin\", dependencies=[Depends(require_role(\"admin\"))])\n        def admin_endpoint():\n            return {\"message\": \"Admin access granted\"}\n    \"\"\"\n\n    def role_checker(\n        current_user: User = Depends(get_current_user),\n        roles: SQLAlchemyRoleAdapter = Depends(get_role_adapter),\n    ):\n        user_roles = roles.get_user_roles(user_id=current_user.id)\n        user_role_names = [role.name for role in user_roles]\n\n        if role_name not in user_role_names:\n            raise HTTPException(\n                status_code=status.HTTP_403_FORBIDDEN,\n                detail=f\"Role '{role_name}' required\",\n            )\n\n        return current_user\n\n    return role_checker\n</code></pre>"},{"location":"reference/api/dependencies/#fastauth.api.dependencies.require_permission","title":"require_permission","text":"<pre><code>require_permission(permission_name: str) -&gt; Callable\n</code></pre> <p>Create a dependency that requires a user to have a specific permission.</p> <p>Parameters:</p> Name Type Description Default <code>permission_name</code> <code>str</code> <p>Name of the required permission</p> required <p>Returns:</p> Type Description <code>Callable</code> <p>Dependency function that can be used with FastAPI Depends</p> Example <p>@app.delete(     \"/users/{id}\",     dependencies=[Depends(require_permission(\"delete:users\"))] ) def delete_user(id: str):     return {\"message\": \"User deleted\"}</p> Source code in <code>fastauth/api/dependencies.py</code> <pre><code>def require_permission(permission_name: str) -&gt; Callable:\n    \"\"\"\n    Create a dependency that requires a user to have a specific permission.\n\n    Args:\n        permission_name: Name of the required permission\n\n    Returns:\n        Dependency function that can be used with FastAPI Depends\n\n    Example:\n        @app.delete(\n            \"/users/{id}\",\n            dependencies=[Depends(require_permission(\"delete:users\"))]\n        )\n        def delete_user(id: str):\n            return {\"message\": \"User deleted\"}\n    \"\"\"\n\n    def permission_checker(\n        current_user: User = Depends(get_current_user),\n        roles: SQLAlchemyRoleAdapter = Depends(get_role_adapter),\n    ):\n        has_permission = check_permission(\n            roles=roles,\n            user_id=current_user.id,\n            permission_name=permission_name,\n        )\n\n        if not has_permission:\n            raise HTTPException(\n                status_code=status.HTTP_403_FORBIDDEN,\n                detail=f\"Permission '{permission_name}' required\",\n            )\n\n        return current_user\n\n    return permission_checker\n</code></pre>"},{"location":"reference/api/oauth/","title":"Oauth","text":""},{"location":"reference/api/oauth/#fastauth.api.oauth","title":"oauth","text":""},{"location":"reference/api/oauth/#fastauth.api.oauth-classes","title":"Classes","text":""},{"location":"reference/api/oauth/#fastauth.api.oauth-functions","title":"Functions","text":""},{"location":"reference/api/oauth/#fastauth.api.oauth.authorize","title":"authorize","text":"<pre><code>authorize(\n    provider_name: str,\n    request: Request,\n    session: Session = Depends(get_session),\n    current_user: User | None = None,\n)\n</code></pre> <p>Initiate OAuth authorization flow.</p> <p>This endpoint generates a state token and authorization URL. If the user is logged in, this will be a linking flow. If not logged in, this will be a login/registration flow.</p> <p>The code_verifier for PKCE is stored in the session.</p> <p>Parameters:</p> Name Type Description Default <code>provider_name</code> <code>str</code> <p>OAuth provider (e.g., 'google', 'github')</p> required <code>request</code> <code>Request</code> <p>FastAPI request object</p> required <code>session</code> <code>Session</code> <p>Database session</p> <code>Depends(get_session)</code> <code>current_user</code> <code>User | None</code> <p>Optional current user (if authenticated)</p> <code>None</code> <p>Returns:</p> Type Description <p>OAuthAuthorizationResponse with authorization_url</p> Source code in <code>fastauth/api/oauth.py</code> <pre><code>@router.get(\"/{provider}/authorize\", response_model=OAuthAuthorizationResponse)\ndef authorize(\n    provider_name: str,\n    request: Request,\n    session: Session = Depends(get_session),\n    current_user: User | None = None,\n):\n    \"\"\"\n    Initiate OAuth authorization flow.\n\n    This endpoint generates a state token and authorization URL.\n    If the user is logged in, this will be a linking flow.\n    If not logged in, this will be a login/registration flow.\n\n    The code_verifier for PKCE is stored in the session.\n\n    Args:\n        provider_name: OAuth provider (e.g., 'google', 'github')\n        request: FastAPI request object\n        session: Database session\n        current_user: Optional current user (if authenticated)\n\n    Returns:\n        OAuthAuthorizationResponse with authorization_url\n    \"\"\"\n    provider = _get_or_register_provider(provider_name)\n\n    states = SQLAlchemyOAuthStateAdapter(session=session)\n\n    redirect_uri = str(request.url_for(\"oauth_callback\", provider=provider_name))\n\n    user_id = current_user.id if current_user else None\n\n    authorization_url, state_token, code_verifier = initiate_oauth_flow(\n        states=states,\n        provider=provider,\n        redirect_uri=redirect_uri,\n        user_id=user_id,\n        use_pkce=True,\n    )\n\n    # NOTE: This requires SessionMiddleware to be configured\n    if code_verifier:\n        if not hasattr(request, \"session\"):\n            raise HTTPException(\n                status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n                detail=\"Session middleware not configured.\\\n                    Please add SessionMiddleware to your app.\",\n            )\n        request.session[\"oauth_code_verifier\"] = code_verifier\n        request.session[\"oauth_state\"] = state_token\n\n    return OAuthAuthorizationResponse(authorization_url=authorization_url)\n</code></pre>"},{"location":"reference/api/oauth/#fastauth.api.oauth.oauth_callback","title":"oauth_callback  <code>async</code>","text":"<pre><code>oauth_callback(\n    provider_name: str,\n    payload: OAuthCallbackRequest,\n    request: Request,\n    session: Session = Depends(get_session),\n)\n</code></pre> <p>Handle OAuth callback after user authorization.</p> <p>This endpoint: 1. Validates the state token (CSRF protection) 2. Exchanges authorization code for tokens 3. Fetches user info from provider 4. Creates or links user account 5. Issues FastAuth tokens (JWT + refresh token)</p> <p>Parameters:</p> Name Type Description Default <code>provider_name</code> <code>str</code> <p>OAuth provider (e.g., 'google', 'github')</p> required <code>payload</code> <code>OAuthCallbackRequest</code> <p>Callback request with code and state</p> required <code>request</code> <code>Request</code> <p>FastAPI request object</p> required <code>session</code> <code>Session</code> <p>Database session</p> <code>Depends(get_session)</code> <p>Returns:</p> Type Description <p>TokenResponse with access_token and refresh_token</p> Source code in <code>fastauth/api/oauth.py</code> <pre><code>@router.post(\"/{provider}/callback\", response_model=TokenResponse)\nasync def oauth_callback(\n    provider_name: str,\n    payload: OAuthCallbackRequest,\n    request: Request,\n    session: Session = Depends(get_session),\n):\n    \"\"\"\n    Handle OAuth callback after user authorization.\n\n    This endpoint:\n    1. Validates the state token (CSRF protection)\n    2. Exchanges authorization code for tokens\n    3. Fetches user info from provider\n    4. Creates or links user account\n    5. Issues FastAuth tokens (JWT + refresh token)\n\n    Args:\n        provider_name: OAuth provider (e.g., 'google', 'github')\n        payload: Callback request with code and state\n        request: FastAPI request object\n        session: Database session\n\n    Returns:\n        TokenResponse with access_token and refresh_token\n    \"\"\"\n    provider = _get_or_register_provider(provider_name)\n\n    code_verifier = None\n    if hasattr(request, \"session\"):\n        code_verifier = request.session.get(\"oauth_code_verifier\")\n        stored_state = request.session.get(\"oauth_state\")\n\n        if stored_state != payload.state:\n            raise HTTPException(\n                status_code=status.HTTP_400_BAD_REQUEST,\n                detail=\"State mismatch - possible CSRF attack\",\n            )\n\n        request.session.pop(\"oauth_code_verifier\", None)\n        request.session.pop(\"oauth_state\", None)\n\n    states = SQLAlchemyOAuthStateAdapter(session=session)\n    oauth_accounts = SQLAlchemyOAuthAccountAdapter(session=session)\n    users = SQLAlchemyUserAdapter(session=session)\n\n    try:\n        user, _ = await complete_oauth_flow(\n            states=states,\n            oauth_accounts=oauth_accounts,\n            users=users,\n            provider=provider,\n            code=payload.code,\n            state=payload.state,\n            code_verifier=code_verifier,\n        )\n\n    except OAuthStateError as e:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=str(e),\n        )\n    except OAuthAccountAlreadyLinkedError as e:\n        raise HTTPException(\n            status_code=status.HTTP_409_CONFLICT,\n            detail=str(e),\n        )\n    except OAuthError as e:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=str(e),\n        )\n\n    refresh_tokens = SQLAlchemyRefreshTokenAdapter(session=session)\n    sessions = SQLAlchemySessionAdapter(session=session)\n\n    access_token = create_access_token(subject=str(user.id))\n    refresh_token = create_refresh_token(\n        refresh_tokens=refresh_tokens,\n        user_id=user.id,\n    )\n\n    create_session(\n        sessions=sessions,\n        users=users,\n        user_id=user.id,\n        ip_address=request.client.host if request.client else None,\n        user_agent=request.headers.get(\"user-agent\"),\n    )\n\n    return TokenResponse(\n        access_token=access_token,\n        refresh_token=refresh_token,\n    )\n</code></pre>"},{"location":"reference/api/oauth/#fastauth.api.oauth.list_linked_accounts","title":"list_linked_accounts","text":"<pre><code>list_linked_accounts(\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>List all OAuth accounts linked to the current user.</p> <p>Requires authentication.</p> <p>Parameters:</p> Name Type Description Default <code>session</code> <code>Session</code> <p>Database session</p> <code>Depends(get_session)</code> <code>current_user</code> <code>User</code> <p>Current authenticated user</p> <code>Depends(get_current_user)</code> <p>Returns:</p> Type Description <p>List of linked OAuth accounts</p> Source code in <code>fastauth/api/oauth.py</code> <pre><code>@router.get(\"/linked\", response_model=list[OAuthLinkResponse])\ndef list_linked_accounts(\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    List all OAuth accounts linked to the current user.\n\n    Requires authentication.\n\n    Args:\n        session: Database session\n        current_user: Current authenticated user\n\n    Returns:\n        List of linked OAuth accounts\n    \"\"\"\n    oauth_accounts = SQLAlchemyOAuthAccountAdapter(session=session)\n\n    accounts = get_linked_accounts(\n        oauth_accounts=oauth_accounts,\n        user_id=current_user.id,\n    )\n\n    return [\n        OAuthLinkResponse(\n            provider=account.provider,\n            email=account.email,\n            name=account.name,\n            linked_at=account.created_at,\n        )\n        for account in accounts\n    ]\n</code></pre>"},{"location":"reference/api/oauth/#fastauth.api.oauth.unlink_provider","title":"unlink_provider","text":"<pre><code>unlink_provider(\n    provider_name: str,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>Unlink an OAuth provider from the current user's account.</p> <p>Requires authentication.</p> <p>Parameters:</p> Name Type Description Default <code>provider_name</code> <code>str</code> <p>OAuth provider to unlink (e.g., 'google', 'github')</p> required <code>session</code> <code>Session</code> <p>Database session</p> <code>Depends(get_session)</code> <code>current_user</code> <code>User</code> <p>Current authenticated user</p> <code>Depends(get_current_user)</code> <p>Returns:</p> Type Description <p>204 No Content on success</p> Source code in <code>fastauth/api/oauth.py</code> <pre><code>@router.delete(\"/{provider}/unlink\", status_code=status.HTTP_204_NO_CONTENT)\ndef unlink_provider(\n    provider_name: str,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    Unlink an OAuth provider from the current user's account.\n\n    Requires authentication.\n\n    Args:\n        provider_name: OAuth provider to unlink (e.g., 'google', 'github')\n        session: Database session\n        current_user: Current authenticated user\n\n    Returns:\n        204 No Content on success\n    \"\"\"\n    oauth_accounts = SQLAlchemyOAuthAccountAdapter(session=session)\n\n    try:\n        unlink_oauth_account(\n            oauth_accounts=oauth_accounts,\n            user_id=current_user.id,\n            provider=provider_name,\n        )\n    except OAuthError as e:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=str(e),\n        )\n\n    return None\n</code></pre>"},{"location":"reference/api/schemas/","title":"Schemas","text":""},{"location":"reference/api/schemas/#fastauth.api.schemas","title":"schemas","text":""},{"location":"reference/api/sessions/","title":"Sessions","text":""},{"location":"reference/api/sessions/#fastauth.api.sessions","title":"sessions","text":""},{"location":"reference/api/sessions/#fastauth.api.sessions-classes","title":"Classes","text":""},{"location":"reference/api/sessions/#fastauth.api.sessions-functions","title":"Functions","text":""},{"location":"reference/api/sessions/#fastauth.api.sessions.list_sessions","title":"list_sessions","text":"<pre><code>list_sessions(\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>List all active sessions for the current user.</p> Source code in <code>fastauth/api/sessions.py</code> <pre><code>@router.get(\"\", response_model=SessionListResponse)\ndef list_sessions(\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    List all active sessions for the current user.\n    \"\"\"\n    sessions_adapter = SQLAlchemySessionAdapter(session=session)\n\n    user_sessions = get_user_sessions(\n        sessions=sessions_adapter,\n        user_id=current_user.id,\n    )\n\n    return SessionListResponse(\n        sessions=[\n            SessionResponse(\n                id=s.id,\n                device=s.device,\n                ip_address=s.ip_address,\n                user_agent=s.user_agent,\n                last_active=s.last_active.isoformat(),\n                created_at=s.created_at.isoformat(),\n            )\n            for s in user_sessions\n        ]\n    )\n</code></pre>"},{"location":"reference/api/sessions/#fastauth.api.sessions.delete_all_sessions","title":"delete_all_sessions","text":"<pre><code>delete_all_sessions(\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>Delete all sessions for the current user except the current one. Note: This will log out the user from all other devices.</p> Source code in <code>fastauth/api/sessions.py</code> <pre><code>@router.delete(\"/all\", response_model=MessageResponse)\ndef delete_all_sessions(\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    Delete all sessions for the current user except the current one.\n    Note: This will log out the user from all other devices.\n    \"\"\"\n    sessions_adapter = SQLAlchemySessionAdapter(session=session)\n\n    delete_all_user_sessions(\n        sessions=sessions_adapter,\n        user_id=current_user.id,\n        except_session_id=None,\n    )\n\n    return MessageResponse(message=\"All sessions deleted successfully\")\n</code></pre>"},{"location":"reference/api/sessions/#fastauth.api.sessions.delete_user_session","title":"delete_user_session","text":"<pre><code>delete_user_session(\n    session_id: UUID,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n)\n</code></pre> <p>Delete a specific session. Users can only delete their own sessions.</p> Source code in <code>fastauth/api/sessions.py</code> <pre><code>@router.delete(\"/{session_id}\", response_model=MessageResponse)\ndef delete_user_session(\n    session_id: uuid.UUID,\n    session: Session = Depends(get_session),\n    current_user: User = Depends(get_current_user),\n):\n    \"\"\"\n    Delete a specific session. Users can only delete their own sessions.\n    \"\"\"\n    sessions_adapter = SQLAlchemySessionAdapter(session=session)\n\n    try:\n        delete_session(\n            sessions=sessions_adapter,\n            session_id=session_id,\n            user_id=current_user.id,\n        )\n    except SessionNotFoundError:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"Session not found\",\n        )\n\n    return MessageResponse(message=\"Session deleted successfully\")\n</code></pre>"},{"location":"reference/core/account/","title":"Account","text":""},{"location":"reference/core/account/#fastauth.core.account","title":"account","text":""},{"location":"reference/core/account/#fastauth.core.account-classes","title":"Classes","text":""},{"location":"reference/core/account/#fastauth.core.account.InvalidPasswordError","title":"InvalidPasswordError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when the current password is incorrect.</p>"},{"location":"reference/core/account/#fastauth.core.account.UserNotFoundError","title":"UserNotFoundError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when the user is not found.</p>"},{"location":"reference/core/account/#fastauth.core.account.EmailChangeError","title":"EmailChangeError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when there's an error with email change.</p>"},{"location":"reference/core/account/#fastauth.core.account.EmailAlreadyExistsError","title":"EmailAlreadyExistsError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when the new email already exists.</p>"},{"location":"reference/core/account/#fastauth.core.account-functions","title":"Functions","text":""},{"location":"reference/core/account/#fastauth.core.account.change_password","title":"change_password","text":"<pre><code>change_password(\n    *,\n    users: UserAdapter,\n    sessions: SessionAdapter,\n    user_id: UUID,\n    current_password: str,\n    new_password: str,\n    current_session_id: UUID | None = None\n) -&gt; None\n</code></pre> <p>Change a user's password.</p> <p>Parameters:</p> Name Type Description Default <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>ID of the user changing their password</p> required <code>current_password</code> <code>str</code> <p>Current password for verification</p> required <code>new_password</code> <code>str</code> <p>New password to set</p> required <code>current_session_id</code> <code>UUID | None</code> <p>Optional session ID to preserve during logout</p> <code>None</code> <p>Raises:</p> Type Description <code>UserNotFoundError</code> <p>If the user doesn't exist</p> <code>InvalidPasswordError</code> <p>If the current password is incorrect</p> Source code in <code>fastauth/core/account.py</code> <pre><code>def change_password(\n    *,\n    users: UserAdapter,\n    sessions: SessionAdapter,\n    user_id: uuid.UUID,\n    current_password: str,\n    new_password: str,\n    current_session_id: uuid.UUID | None = None,\n) -&gt; None:\n    \"\"\"\n    Change a user's password.\n\n    Args:\n        users: User adapter for database operations\n        sessions: Session adapter for database operations\n        user_id: ID of the user changing their password\n        current_password: Current password for verification\n        new_password: New password to set\n        current_session_id: Optional session ID to preserve during logout\n\n    Raises:\n        UserNotFoundError: If the user doesn't exist\n        InvalidPasswordError: If the current password is incorrect\n    \"\"\"\n    user = users.get_by_id(user_id)\n    if not user:\n        raise UserNotFoundError(\"User not found\")\n\n    if not verify_password(user.hashed_password, current_password):\n        raise InvalidPasswordError(\"Current password is incorrect\")\n\n    hashed_new_password = hash_password(new_password)\n    users.set_password(user_id=user_id, hashed_password=hashed_new_password)\n\n    sessions.delete_user_sessions(\n        user_id=user_id,\n        except_session_id=current_session_id,\n    )\n</code></pre>"},{"location":"reference/core/account/#fastauth.core.account.request_email_change","title":"request_email_change","text":"<pre><code>request_email_change(\n    *,\n    users: UserAdapter,\n    email_changes: EmailChangeAdapter,\n    user_id: UUID,\n    new_email: str,\n    expires_in_minutes: int = 60\n) -&gt; str | None\n</code></pre> <p>Request an email change for a user.</p> <p>Parameters:</p> Name Type Description Default <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>email_changes</code> <code>EmailChangeAdapter</code> <p>Email change adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>ID of the user requesting email change</p> required <code>new_email</code> <code>str</code> <p>New email address</p> required <code>expires_in_minutes</code> <code>int</code> <p>Token expiration time in minutes</p> <code>60</code> <p>Returns:</p> Type Description <code>str | None</code> <p>Verification token if successful, None if user not found</p> <p>Raises:</p> Type Description <code>EmailAlreadyExistsError</code> <p>If the new email already exists</p> Source code in <code>fastauth/core/account.py</code> <pre><code>def request_email_change(\n    *,\n    users: UserAdapter,\n    email_changes: EmailChangeAdapter,\n    user_id: uuid.UUID,\n    new_email: str,\n    expires_in_minutes: int = 60,\n) -&gt; str | None:\n    \"\"\"\n    Request an email change for a user.\n\n    Args:\n        users: User adapter for database operations\n        email_changes: Email change adapter for database operations\n        user_id: ID of the user requesting email change\n        new_email: New email address\n        expires_in_minutes: Token expiration time in minutes\n\n    Returns:\n        Verification token if successful, None if user not found\n\n    Raises:\n        EmailAlreadyExistsError: If the new email already exists\n    \"\"\"\n    user = users.get_by_id(user_id)\n    if not user:\n        return None\n\n    existing_user = users.get_by_email(new_email)\n    if existing_user:\n        raise EmailAlreadyExistsError(f\"Email {new_email} already exists\")\n\n    raw_token = generate_refresh_token()\n    token_hash = hash_refresh_token(raw_token)\n\n    expires_at = datetime.now(UTC) + timedelta(minutes=expires_in_minutes)\n\n    email_changes.create(\n        user_id=user_id,\n        new_email=new_email,\n        token_hash=token_hash,\n        expires_at=expires_at,\n    )\n\n    return raw_token\n</code></pre>"},{"location":"reference/core/account/#fastauth.core.account.confirm_email_change","title":"confirm_email_change","text":"<pre><code>confirm_email_change(\n    *, users: UserAdapter, email_changes: EmailChangeAdapter, token: str\n) -&gt; None\n</code></pre> <p>Confirm an email change with a verification token.</p> <p>Parameters:</p> Name Type Description Default <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>email_changes</code> <code>EmailChangeAdapter</code> <p>Email change adapter for database operations</p> required <code>token</code> <code>str</code> <p>Verification token</p> required <p>Raises:</p> Type Description <code>EmailChangeError</code> <p>If token is invalid or expired</p> <code>EmailAlreadyExistsError</code> <p>If the new email already exists</p> Source code in <code>fastauth/core/account.py</code> <pre><code>def confirm_email_change(\n    *,\n    users: UserAdapter,\n    email_changes: EmailChangeAdapter,\n    token: str,\n) -&gt; None:\n    \"\"\"\n    Confirm an email change with a verification token.\n\n    Args:\n        users: User adapter for database operations\n        email_changes: Email change adapter for database operations\n        token: Verification token\n\n    Raises:\n        EmailChangeError: If token is invalid or expired\n        EmailAlreadyExistsError: If the new email already exists\n    \"\"\"\n    token_hash = hash_refresh_token(token)\n\n    record = email_changes.get_valid(token_hash=token_hash)\n    if not record:\n        raise EmailChangeError(\"Invalid or expired email change token\")\n\n    expires_at = record.expires_at\n    if expires_at.tzinfo is None:\n        expires_at = expires_at.replace(tzinfo=UTC)\n\n    if expires_at &lt; datetime.now(UTC):\n        raise EmailChangeError(\"Expired email change token\")\n\n    # Check if email is still available\n    existing_user = users.get_by_email(record.new_email)\n    if existing_user:\n        raise EmailAlreadyExistsError(\n            f\"Email {record.new_email} is no longer available\"\n        )\n\n    users.update_email(user_id=record.user_id, new_email=record.new_email)\n    email_changes.mark_used(token_hash=token_hash)\n</code></pre>"},{"location":"reference/core/account/#fastauth.core.account.delete_account","title":"delete_account","text":"<pre><code>delete_account(\n    *,\n    users: UserAdapter,\n    sessions: SessionAdapter,\n    user_id: UUID,\n    password: str,\n    hard_delete: bool = False\n) -&gt; None\n</code></pre> <p>Delete a user account (soft or hard delete).</p> <p>Parameters:</p> Name Type Description Default <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>ID of the user to delete</p> required <code>password</code> <code>str</code> <p>Password for verification</p> required <code>hard_delete</code> <code>bool</code> <p>If True, permanently delete the user; if False, soft delete</p> <code>False</code> <p>Raises:</p> Type Description <code>UserNotFoundError</code> <p>If the user doesn't exist</p> <code>InvalidPasswordError</code> <p>If the password is incorrect</p> Source code in <code>fastauth/core/account.py</code> <pre><code>def delete_account(\n    *,\n    users: UserAdapter,\n    sessions: SessionAdapter,\n    user_id: uuid.UUID,\n    password: str,\n    hard_delete: bool = False,\n) -&gt; None:\n    \"\"\"\n    Delete a user account (soft or hard delete).\n\n    Args:\n        users: User adapter for database operations\n        sessions: Session adapter for database operations\n        user_id: ID of the user to delete\n        password: Password for verification\n        hard_delete: If True, permanently delete the user; if False, soft delete\n\n    Raises:\n        UserNotFoundError: If the user doesn't exist\n        InvalidPasswordError: If the password is incorrect\n    \"\"\"\n    user = users.get_by_id(user_id)\n    if not user:\n        raise UserNotFoundError(\"User not found\")\n\n    if not verify_password(user.hashed_password, password):\n        raise InvalidPasswordError(\"Password is incorrect\")\n\n    # Delete all user sessions\n    sessions.delete_user_sessions(user_id=user_id)\n\n    # Delete the user\n    if hard_delete:\n        users.hard_delete_user(user_id=user_id)\n    else:\n        users.soft_delete_user(user_id=user_id)\n</code></pre>"},{"location":"reference/core/email_verification/","title":"Email Verification","text":""},{"location":"reference/core/email_verification/#fastauth.core.email_verification","title":"email_verification","text":""},{"location":"reference/core/email_verification/#fastauth.core.email_verification-classes","title":"Classes","text":""},{"location":"reference/core/hashing/","title":"Hashing","text":""},{"location":"reference/core/hashing/#fastauth.core.hashing","title":"hashing","text":""},{"location":"reference/core/hashing/#fastauth.core.hashing-functions","title":"Functions","text":""},{"location":"reference/core/hashing/#fastauth.core.hashing.hash_password","title":"hash_password","text":"<pre><code>hash_password(password: str) -&gt; str\n</code></pre> <p>Hash a plaintext password using Argon2.</p> Source code in <code>fastauth/core/hashing.py</code> <pre><code>def hash_password(password: str) -&gt; str:\n    \"\"\"\n    Hash a plaintext password using Argon2.\n    \"\"\"\n    return _password_hasher.hash(password)\n</code></pre>"},{"location":"reference/core/hashing/#fastauth.core.hashing.verify_password","title":"verify_password","text":"<pre><code>verify_password(hashed_password: str, plain_password: str) -&gt; bool\n</code></pre> <p>Verify a plaintext password against a stored hash.</p> Source code in <code>fastauth/core/hashing.py</code> <pre><code>def verify_password(hashed_password: str, plain_password: str) -&gt; bool:\n    \"\"\"\n    Verify a plaintext password against a stored hash.\n    \"\"\"\n    try:\n        return _password_hasher.verify(hashed_password, plain_password)\n    except VerifyMismatchError:\n        return False\n</code></pre>"},{"location":"reference/core/oauth/","title":"Oauth","text":""},{"location":"reference/core/oauth/#fastauth.core.oauth","title":"oauth","text":""},{"location":"reference/core/oauth/#fastauth.core.oauth-classes","title":"Classes","text":""},{"location":"reference/core/oauth/#fastauth.core.oauth.OAuthError","title":"OAuthError","text":"<p>             Bases: <code>Exception</code></p> <p>Base exception for OAuth errors.</p>"},{"location":"reference/core/oauth/#fastauth.core.oauth.OAuthStateError","title":"OAuthStateError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when OAuth state token is invalid or expired.</p>"},{"location":"reference/core/oauth/#fastauth.core.oauth.OAuthAccountAlreadyLinkedError","title":"OAuthAccountAlreadyLinkedError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when OAuth account is already linked to a different user.</p>"},{"location":"reference/core/oauth/#fastauth.core.oauth.OAuthProviderNotFoundError","title":"OAuthProviderNotFoundError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when OAuth provider is not found.</p>"},{"location":"reference/core/oauth/#fastauth.core.oauth-functions","title":"Functions","text":""},{"location":"reference/core/oauth/#fastauth.core.oauth.initiate_oauth_flow","title":"initiate_oauth_flow","text":"<pre><code>initiate_oauth_flow(\n    *,\n    states: OAuthStateAdapter,\n    provider: OAuthProvider,\n    redirect_uri: str,\n    user_id: UUID | None = None,\n    use_pkce: bool = True,\n    state_ttl_minutes: int = 10\n) -&gt; tuple[str, str, str | None]\n</code></pre> <p>Initiate OAuth authorization flow.</p> <p>Generates state token for CSRF protection and optional PKCE challenge. Stores state in database and builds authorization URL.</p> <p>Parameters:</p> Name Type Description Default <code>states</code> <code>OAuthStateAdapter</code> <p>OAuth state adapter for database operations</p> required <code>provider</code> <code>OAuthProvider</code> <p>OAuth provider instance</p> required <code>redirect_uri</code> <code>str</code> <p>Callback URL after authorization</p> required <code>user_id</code> <code>UUID | None</code> <p>Optional user ID for linking mode (logged-in user)</p> <code>None</code> <code>use_pkce</code> <code>bool</code> <p>Whether to use PKCE for enhanced security (default: True)</p> <code>True</code> <code>state_ttl_minutes</code> <code>int</code> <p>State token time-to-live in minutes (default: 10)</p> <code>10</code> <p>Returns:</p> Type Description <code>str</code> <p>Tuple of (authorization_url, state_token, code_verifier)</p> <code>str</code> <p>code_verifier is None if PKCE is disabled</p> Example <p>auth_url, state, verifier = initiate_oauth_flow( ...     states=state_adapter, ...     provider=google_provider, ...     redirect_uri=\"https://example.com/oauth/callback\", ...     use_pkce=True, ... )</p> Source code in <code>fastauth/core/oauth.py</code> <pre><code>def initiate_oauth_flow(\n    *,\n    states: OAuthStateAdapter,\n    provider: OAuthProvider,\n    redirect_uri: str,\n    user_id: uuid.UUID | None = None,\n    use_pkce: bool = True,\n    state_ttl_minutes: int = 10,\n) -&gt; tuple[str, str, str | None]:\n    \"\"\"\n    Initiate OAuth authorization flow.\n\n    Generates state token for CSRF protection and optional PKCE challenge.\n    Stores state in database and builds authorization URL.\n\n    Args:\n        states: OAuth state adapter for database operations\n        provider: OAuth provider instance\n        redirect_uri: Callback URL after authorization\n        user_id: Optional user ID for linking mode (logged-in user)\n        use_pkce: Whether to use PKCE for enhanced security (default: True)\n        state_ttl_minutes: State token time-to-live in minutes (default: 10)\n\n    Returns:\n        Tuple of (authorization_url, state_token, code_verifier)\n        code_verifier is None if PKCE is disabled\n\n    Example:\n        &gt;&gt;&gt; auth_url, state, verifier = initiate_oauth_flow(\n        ...     states=state_adapter,\n        ...     provider=google_provider,\n        ...     redirect_uri=\"https://example.com/oauth/callback\",\n        ...     use_pkce=True,\n        ... )\n    \"\"\"\n    state_token = generate_state_token()\n    state_hash = hash_state_token(state_token)\n\n    code_verifier = None\n    code_challenge = None\n    code_challenge_method = None\n\n    if use_pkce:\n        code_verifier = generate_code_verifier()\n        code_challenge = generate_code_challenge(code_verifier)\n        code_challenge_method = \"S256\"\n\n    expires_at = datetime.now(UTC) + timedelta(minutes=state_ttl_minutes)\n\n    states.create(\n        state_hash=state_hash,\n        provider=provider.name,\n        redirect_uri=redirect_uri,\n        code_challenge=code_challenge,\n        code_challenge_method=code_challenge_method,\n        user_id=user_id,\n        expires_at=expires_at,\n    )\n\n    authorization_url = build_authorization_url(\n        auth_endpoint=provider.authorization_endpoint,\n        client_id=provider.client_id,\n        redirect_uri=redirect_uri,\n        state=state_token,\n        scope=provider.default_scopes,\n        code_challenge=code_challenge,\n    )\n\n    return authorization_url, state_token, code_verifier\n</code></pre>"},{"location":"reference/core/oauth/#fastauth.core.oauth.complete_oauth_flow","title":"complete_oauth_flow  <code>async</code>","text":"<pre><code>complete_oauth_flow(\n    *,\n    states: OAuthStateAdapter,\n    oauth_accounts: OAuthAccountAdapter,\n    users: UserAdapter,\n    provider: OAuthProvider,\n    code: str,\n    state: str,\n    code_verifier: str | None = None\n) -&gt; tuple[object, bool]\n</code></pre> <p>Complete OAuth authorization flow.</p> <p>Validates state token, exchanges code for tokens, fetches user info, and handles account linking logic.</p> <p>Account Linking Strategy: 1. If OAuth account exists \u2192 update tokens, return existing user 2. If user_id in state (linking mode) \u2192 link OAuth to that user 3. If user exists by email (verified) \u2192 auto-link OAuth account 4. If new user \u2192 create user with random password, mark verified, link OAuth</p> <p>Parameters:</p> Name Type Description Default <code>states</code> <code>OAuthStateAdapter</code> <p>OAuth state adapter</p> required <code>oauth_accounts</code> <code>OAuthAccountAdapter</code> <p>OAuth account adapter</p> required <code>users</code> <code>UserAdapter</code> <p>User adapter</p> required <code>provider</code> <code>OAuthProvider</code> <p>OAuth provider instance</p> required <code>code</code> <code>str</code> <p>Authorization code from OAuth callback</p> required <code>state</code> <code>str</code> <p>State token from OAuth callback</p> required <code>code_verifier</code> <code>str | None</code> <p>Optional PKCE code verifier</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[object, bool]</code> <p>Tuple of (user, is_new_user)</p> <p>Raises:</p> Type Description <code>OAuthStateError</code> <p>If state token is invalid or expired</p> <code>OAuthAccountAlreadyLinkedError</code> <p>If OAuth account is linked to different user</p> <code>OAuthError</code> <p>If OAuth flow fails for any reason</p> Source code in <code>fastauth/core/oauth.py</code> <pre><code>async def complete_oauth_flow(\n    *,\n    states: OAuthStateAdapter,\n    oauth_accounts: OAuthAccountAdapter,\n    users: UserAdapter,\n    provider: OAuthProvider,\n    code: str,\n    state: str,\n    code_verifier: str | None = None,\n) -&gt; tuple[object, bool]:\n    \"\"\"\n    Complete OAuth authorization flow.\n\n    Validates state token, exchanges code for tokens, fetches user info,\n    and handles account linking logic.\n\n    Account Linking Strategy:\n    1. If OAuth account exists \u2192 update tokens, return existing user\n    2. If user_id in state (linking mode) \u2192 link OAuth to that user\n    3. If user exists by email (verified) \u2192 auto-link OAuth account\n    4. If new user \u2192 create user with random password, mark verified, link OAuth\n\n    Args:\n        states: OAuth state adapter\n        oauth_accounts: OAuth account adapter\n        users: User adapter\n        provider: OAuth provider instance\n        code: Authorization code from OAuth callback\n        state: State token from OAuth callback\n        code_verifier: Optional PKCE code verifier\n\n    Returns:\n        Tuple of (user, is_new_user)\n\n    Raises:\n        OAuthStateError: If state token is invalid or expired\n        OAuthAccountAlreadyLinkedError: If OAuth account is linked to different user\n        OAuthError: If OAuth flow fails for any reason\n    \"\"\"\n    state_hash = hash_state_token(state)\n    state_record = states.get_valid(state_hash=state_hash)\n\n    if not state_record:\n        raise OAuthStateError(\"Invalid or expired state token\")\n\n    expires_at = state_record.expires_at\n    if expires_at.tzinfo is None:\n        expires_at = expires_at.replace(tzinfo=UTC)\n\n    if expires_at &lt; datetime.now(UTC):\n        raise OAuthStateError(\"State token has expired\")\n\n    states.mark_used(state_hash=state_hash)\n\n    try:\n        oauth_tokens = await provider.exchange_code_for_tokens(\n            code=code,\n            redirect_uri=state_record.redirect_uri,\n            code_verifier=code_verifier,\n        )\n\n        user_info = await provider.get_user_info(access_token=oauth_tokens.access_token)\n\n    except Exception as e:\n        raise OAuthError(f\"Failed to complete OAuth flow: {e!s}\") from e\n\n    access_token_hash = hash_oauth_token(oauth_tokens.access_token)\n    refresh_token_hash = (\n        hash_oauth_token(oauth_tokens.refresh_token)\n        if oauth_tokens.refresh_token\n        else None\n    )\n\n    token_expires_at = None\n    if oauth_tokens.expires_in:\n        token_expires_at = datetime.now(UTC) + timedelta(\n            seconds=oauth_tokens.expires_in\n        )\n\n    existing_oauth_account = oauth_accounts.get_by_provider_user_id(\n        provider=provider.name,\n        provider_user_id=user_info.provider_user_id,\n    )\n\n    if existing_oauth_account:\n        oauth_accounts.update_tokens(\n            account_id=existing_oauth_account.id,\n            access_token_hash=access_token_hash,\n            refresh_token_hash=refresh_token_hash,\n            expires_at=token_expires_at,\n        )\n\n        user = users.get_by_id(user_id=existing_oauth_account.user_id)\n        if not user:\n            raise OAuthError(\"User not found for existing OAuth account\")\n\n        return user, False\n\n    if state_record.user_id:\n        user = users.get_by_id(user_id=state_record.user_id)\n        if not user:\n            raise OAuthError(\"User not found for linking\")\n\n        oauth_accounts.create(\n            user_id=user.id,\n            provider=provider.name,\n            provider_user_id=user_info.provider_user_id,\n            access_token_hash=access_token_hash,\n            refresh_token_hash=refresh_token_hash,\n            expires_at=token_expires_at,\n            email=user_info.email,\n            name=user_info.name,\n            avatar_url=user_info.avatar_url,\n        )\n\n        return user, False\n\n    existing_user = users.get_by_email(email=user_info.email)\n\n    if existing_user:\n        if not existing_user.is_verified:\n            raise OAuthError(\n                f\"Cannot auto-link OAuth account. User with email {user_info.email} \"\n                \"exists but email is not verified. Please verify email first or \"\n                \"login and manually link the OAuth account.\"\n            )\n\n        if not user_info.email_verified:\n            raise OAuthError(\n                f\"Cannot auto-link OAuth account. Email {user_info.email} is not \"\n                \"verified by the OAuth provider.\"\n            )\n\n        oauth_accounts.create(\n            user_id=existing_user.id,\n            provider=provider.name,\n            provider_user_id=user_info.provider_user_id,\n            access_token_hash=access_token_hash,\n            refresh_token_hash=refresh_token_hash,\n            expires_at=token_expires_at,\n            email=user_info.email,\n            name=user_info.name,\n            avatar_url=user_info.avatar_url,\n        )\n\n        return existing_user, False\n\n    random_password = secrets.token_urlsafe(32)\n    hashed_password = hash_password(random_password)\n\n    user = users.create_user(\n        email=user_info.email,\n        hashed_password=hashed_password,\n    )\n\n    if user_info.email_verified:\n        users.mark_verified(user.id)\n\n    oauth_accounts.create(\n        user_id=user.id,\n        provider=provider.name,\n        provider_user_id=user_info.provider_user_id,\n        access_token_hash=access_token_hash,\n        refresh_token_hash=refresh_token_hash,\n        expires_at=token_expires_at,\n        email=user_info.email,\n        name=user_info.name,\n        avatar_url=user_info.avatar_url,\n    )\n\n    return user, True\n</code></pre>"},{"location":"reference/core/oauth/#fastauth.core.oauth.unlink_oauth_account","title":"unlink_oauth_account","text":"<pre><code>unlink_oauth_account(\n    *, oauth_accounts: OAuthAccountAdapter, user_id: UUID, provider: str\n) -&gt; None\n</code></pre> <p>Unlink an OAuth provider from a user's account.</p> <p>Parameters:</p> Name Type Description Default <code>oauth_accounts</code> <code>OAuthAccountAdapter</code> <p>OAuth account adapter</p> required <code>user_id</code> <code>UUID</code> <p>User ID to unlink from</p> required <code>provider</code> <code>str</code> <p>Provider name (e.g., 'google', 'github')</p> required <p>Raises:</p> Type Description <code>OAuthError</code> <p>If OAuth account not found</p> Source code in <code>fastauth/core/oauth.py</code> <pre><code>def unlink_oauth_account(\n    *,\n    oauth_accounts: OAuthAccountAdapter,\n    user_id: uuid.UUID,\n    provider: str,\n) -&gt; None:\n    \"\"\"\n    Unlink an OAuth provider from a user's account.\n\n    Args:\n        oauth_accounts: OAuth account adapter\n        user_id: User ID to unlink from\n        provider: Provider name (e.g., 'google', 'github')\n\n    Raises:\n        OAuthError: If OAuth account not found\n    \"\"\"\n    accounts = oauth_accounts.get_by_user_id(user_id=user_id, provider=provider)\n\n    if not accounts:\n        raise OAuthError(f\"No {provider} account linked to this user\")\n\n    for account in accounts:\n        oauth_accounts.delete(account_id=account.id)\n</code></pre>"},{"location":"reference/core/oauth/#fastauth.core.oauth.get_linked_accounts","title":"get_linked_accounts","text":"<pre><code>get_linked_accounts(\n    *, oauth_accounts: OAuthAccountAdapter, user_id: UUID\n) -&gt; list\n</code></pre> <p>Get all OAuth accounts linked to a user.</p> <p>Parameters:</p> Name Type Description Default <code>oauth_accounts</code> <code>OAuthAccountAdapter</code> <p>OAuth account adapter</p> required <code>user_id</code> <code>UUID</code> <p>User ID to get linked accounts for</p> required <p>Returns:</p> Type Description <code>list</code> <p>List of OAuth account records</p> Source code in <code>fastauth/core/oauth.py</code> <pre><code>def get_linked_accounts(\n    *,\n    oauth_accounts: OAuthAccountAdapter,\n    user_id: uuid.UUID,\n) -&gt; list:\n    \"\"\"\n    Get all OAuth accounts linked to a user.\n\n    Args:\n        oauth_accounts: OAuth account adapter\n        user_id: User ID to get linked accounts for\n\n    Returns:\n        List of OAuth account records\n    \"\"\"\n    return oauth_accounts.get_by_user_id(user_id=user_id)\n</code></pre>"},{"location":"reference/core/password_reset/","title":"Password Reset","text":""},{"location":"reference/core/password_reset/#fastauth.core.password_reset","title":"password_reset","text":""},{"location":"reference/core/password_reset/#fastauth.core.password_reset-classes","title":"Classes","text":""},{"location":"reference/core/password_reset/#fastauth.core.password_reset-functions","title":"Functions","text":""},{"location":"reference/core/refresh_tokens/","title":"Refresh Tokens","text":""},{"location":"reference/core/refresh_tokens/#fastauth.core.refresh_tokens","title":"refresh_tokens","text":""},{"location":"reference/core/refresh_tokens/#fastauth.core.refresh_tokens-functions","title":"Functions","text":""},{"location":"reference/core/roles/","title":"Roles","text":""},{"location":"reference/core/roles/#fastauth.core.roles","title":"roles","text":""},{"location":"reference/core/roles/#fastauth.core.roles-classes","title":"Classes","text":""},{"location":"reference/core/roles/#fastauth.core.roles.RoleNotFoundError","title":"RoleNotFoundError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when a role is not found.</p>"},{"location":"reference/core/roles/#fastauth.core.roles.PermissionNotFoundError","title":"PermissionNotFoundError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when a permission is not found.</p>"},{"location":"reference/core/roles/#fastauth.core.roles.RoleAlreadyExistsError","title":"RoleAlreadyExistsError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when trying to create a role that already exists.</p>"},{"location":"reference/core/roles/#fastauth.core.roles.PermissionAlreadyExistsError","title":"PermissionAlreadyExistsError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when trying to create a permission that already exists.</p>"},{"location":"reference/core/roles/#fastauth.core.roles-functions","title":"Functions","text":""},{"location":"reference/core/roles/#fastauth.core.roles.create_role","title":"create_role","text":"<pre><code>create_role(*, roles: RoleAdapter, name: str, description: str | None = None)\n</code></pre> <p>Create a new role.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>name</code> <code>str</code> <p>Unique role name</p> required <code>description</code> <code>str | None</code> <p>Optional role description</p> <code>None</code> <p>Returns:</p> Type Description <p>Created role object</p> <p>Raises:</p> Type Description <code>RoleAlreadyExistsError</code> <p>If a role with the name already exists</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def create_role(\n    *,\n    roles: RoleAdapter,\n    name: str,\n    description: str | None = None,\n):\n    \"\"\"\n    Create a new role.\n\n    Args:\n        roles: Role adapter for database operations\n        name: Unique role name\n        description: Optional role description\n\n    Returns:\n        Created role object\n\n    Raises:\n        RoleAlreadyExistsError: If a role with the name already exists\n    \"\"\"\n    existing_role = roles.get_role_by_name(name=name)\n\n    if existing_role:\n        raise RoleAlreadyExistsError(f\"Role with name {name} already exists\")\n\n    role = roles.create_role(name=name, description=description)\n\n    return role\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.create_permission","title":"create_permission","text":"<pre><code>create_permission(\n    *, roles: RoleAdapter, name: str, description: str | None = None\n)\n</code></pre> <p>Create a new permission.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>name</code> <code>str</code> <p>Unique permission name</p> required <code>description</code> <code>str | None</code> <p>Optional permission description</p> <code>None</code> <p>Returns:</p> Type Description <p>Created permission object</p> <p>Raises:</p> Type Description <code>PermissionAlreadyExistsError</code> <p>If a permission with the name already exists</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def create_permission(\n    *,\n    roles: RoleAdapter,\n    name: str,\n    description: str | None = None,\n):\n    \"\"\"\n    Create a new permission.\n\n    Args:\n        roles: Role adapter for database operations\n        name: Unique permission name\n        description: Optional permission description\n\n    Returns:\n        Created permission object\n\n    Raises:\n        PermissionAlreadyExistsError: If a permission with the name already exists\n    \"\"\"\n    existing_permission = roles.get_permission_by_name(name=name)\n\n    if existing_permission:\n        raise PermissionAlreadyExistsError(\n            f\"Permission with name {name} already exists\"\n        )\n\n    permission = roles.create_permission(name=name, description=description)\n\n    return permission\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.assign_role","title":"assign_role","text":"<pre><code>assign_role(*, roles: RoleAdapter, user_id: UUID, role_name: str) -&gt; None\n</code></pre> <p>Assign a role to a user by role name.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>role_name</code> <code>str</code> <p>Name of the role to assign</p> required <p>Raises:</p> Type Description <code>RoleNotFoundError</code> <p>If the role does not exist</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def assign_role(\n    *,\n    roles: RoleAdapter,\n    user_id: uuid.UUID,\n    role_name: str,\n) -&gt; None:\n    \"\"\"\n    Assign a role to a user by role name.\n\n    Args:\n        roles: Role adapter for database operations\n        user_id: User's unique identifier\n        role_name: Name of the role to assign\n\n    Raises:\n        RoleNotFoundError: If the role does not exist\n    \"\"\"\n    role = roles.get_role_by_name(name=role_name)\n\n    if not role:\n        raise RoleNotFoundError(f\"Role {role_name} not found\")\n\n    roles.assign_role_to_user(user_id=user_id, role_id=role.id)\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.remove_role","title":"remove_role","text":"<pre><code>remove_role(*, roles: RoleAdapter, user_id: UUID, role_name: str) -&gt; None\n</code></pre> <p>Remove a role from a user by role name.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>role_name</code> <code>str</code> <p>Name of the role to remove</p> required <p>Raises:</p> Type Description <code>RoleNotFoundError</code> <p>If the role does not exist</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def remove_role(\n    *,\n    roles: RoleAdapter,\n    user_id: uuid.UUID,\n    role_name: str,\n) -&gt; None:\n    \"\"\"\n    Remove a role from a user by role name.\n\n    Args:\n        roles: Role adapter for database operations\n        user_id: User's unique identifier\n        role_name: Name of the role to remove\n\n    Raises:\n        RoleNotFoundError: If the role does not exist\n    \"\"\"\n    role = roles.get_role_by_name(name=role_name)\n\n    if not role:\n        raise RoleNotFoundError(f\"Role {role_name} not found\")\n\n    roles.remove_role_from_user(user_id=user_id, role_id=role.id)\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.assign_permission_to_role","title":"assign_permission_to_role","text":"<pre><code>assign_permission_to_role(\n    *, roles: RoleAdapter, role_name: str, permission_name: str\n) -&gt; None\n</code></pre> <p>Assign a permission to a role by names.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>role_name</code> <code>str</code> <p>Name of the role</p> required <code>permission_name</code> <code>str</code> <p>Name of the permission to assign</p> required <p>Raises:</p> Type Description <code>RoleNotFoundError</code> <p>If the role does not exist</p> <code>PermissionNotFoundError</code> <p>If the permission does not exist</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def assign_permission_to_role(\n    *,\n    roles: RoleAdapter,\n    role_name: str,\n    permission_name: str,\n) -&gt; None:\n    \"\"\"\n    Assign a permission to a role by names.\n\n    Args:\n        roles: Role adapter for database operations\n        role_name: Name of the role\n        permission_name: Name of the permission to assign\n\n    Raises:\n        RoleNotFoundError: If the role does not exist\n        PermissionNotFoundError: If the permission does not exist\n    \"\"\"\n    role = roles.get_role_by_name(name=role_name)\n    if not role:\n        raise RoleNotFoundError(f\"Role {role_name} not found\")\n\n    permission = roles.get_permission_by_name(name=permission_name)\n    if not permission:\n        raise PermissionNotFoundError(f\"Permission {permission_name} not found\")\n\n    roles.assign_permission_to_role(role_id=role.id, permission_id=permission.id)\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.check_permission","title":"check_permission","text":"<pre><code>check_permission(\n    *, roles: RoleAdapter, user_id: UUID, permission_name: str\n) -&gt; bool\n</code></pre> <p>Check if a user has a specific permission through any of their roles.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>permission_name</code> <code>str</code> <p>Name of the permission to check</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if user has the permission, False otherwise</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def check_permission(\n    *,\n    roles: RoleAdapter,\n    user_id: uuid.UUID,\n    permission_name: str,\n) -&gt; bool:\n    \"\"\"\n    Check if a user has a specific permission through any of their roles.\n\n    Args:\n        roles: Role adapter for database operations\n        user_id: User's unique identifier\n        permission_name: Name of the permission to check\n\n    Returns:\n        True if user has the permission, False otherwise\n    \"\"\"\n    user_permissions = roles.get_user_permissions(user_id=user_id)\n\n    return any(perm.name == permission_name for perm in user_permissions)\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.get_user_roles","title":"get_user_roles","text":"<pre><code>get_user_roles(*, roles: RoleAdapter, user_id: UUID)\n</code></pre> <p>Get all roles assigned to a user.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <p>Returns:</p> Type Description <p>List of role objects</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def get_user_roles(\n    *,\n    roles: RoleAdapter,\n    user_id: uuid.UUID,\n):\n    \"\"\"\n    Get all roles assigned to a user.\n\n    Args:\n        roles: Role adapter for database operations\n        user_id: User's unique identifier\n\n    Returns:\n        List of role objects\n    \"\"\"\n    return roles.get_user_roles(user_id=user_id)\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.get_user_permissions","title":"get_user_permissions","text":"<pre><code>get_user_permissions(*, roles: RoleAdapter, user_id: UUID)\n</code></pre> <p>Get all permissions for a user across all their roles.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <p>Returns:</p> Type Description <p>List of permission objects</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def get_user_permissions(\n    *,\n    roles: RoleAdapter,\n    user_id: uuid.UUID,\n):\n    \"\"\"\n    Get all permissions for a user across all their roles.\n\n    Args:\n        roles: Role adapter for database operations\n        user_id: User's unique identifier\n\n    Returns:\n        List of permission objects\n    \"\"\"\n    return roles.get_user_permissions(user_id=user_id)\n</code></pre>"},{"location":"reference/core/roles/#fastauth.core.roles.get_role_permissions","title":"get_role_permissions","text":"<pre><code>get_role_permissions(*, roles: RoleAdapter, role_name: str)\n</code></pre> <p>Get all permissions assigned to a role.</p> <p>Parameters:</p> Name Type Description Default <code>roles</code> <code>RoleAdapter</code> <p>Role adapter for database operations</p> required <code>role_name</code> <code>str</code> <p>Name of the role</p> required <p>Returns:</p> Type Description <p>List of permission objects</p> <p>Raises:</p> Type Description <code>RoleNotFoundError</code> <p>If the role does not exist</p> Source code in <code>fastauth/core/roles.py</code> <pre><code>def get_role_permissions(\n    *,\n    roles: RoleAdapter,\n    role_name: str,\n):\n    \"\"\"\n    Get all permissions assigned to a role.\n\n    Args:\n        roles: Role adapter for database operations\n        role_name: Name of the role\n\n    Returns:\n        List of permission objects\n\n    Raises:\n        RoleNotFoundError: If the role does not exist\n    \"\"\"\n    role = roles.get_role_by_name(name=role_name)\n\n    if not role:\n        raise RoleNotFoundError(f\"Role {role_name} not found\")\n\n    return roles.get_role_permissions(role_id=role.id)\n</code></pre>"},{"location":"reference/core/sessions/","title":"Sessions","text":""},{"location":"reference/core/sessions/#fastauth.core.sessions","title":"sessions","text":""},{"location":"reference/core/sessions/#fastauth.core.sessions-classes","title":"Classes","text":""},{"location":"reference/core/sessions/#fastauth.core.sessions.SessionNotFoundError","title":"SessionNotFoundError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when a session is not found.</p>"},{"location":"reference/core/sessions/#fastauth.core.sessions-functions","title":"Functions","text":""},{"location":"reference/core/sessions/#fastauth.core.sessions.create_session","title":"create_session","text":"<pre><code>create_session(\n    *,\n    sessions: SessionAdapter,\n    users: UserAdapter,\n    user_id: UUID,\n    device: str | None = None,\n    ip_address: str | None = None,\n    user_agent: str | None = None\n)\n</code></pre> <p>Create a new session for a user.</p> <p>Parameters:</p> Name Type Description Default <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>device</code> <code>str | None</code> <p>Device information</p> <code>None</code> <code>ip_address</code> <code>str | None</code> <p>IP address of the client</p> <code>None</code> <code>user_agent</code> <code>str | None</code> <p>User agent string</p> <code>None</code> <p>Returns:</p> Type Description <p>Created session object</p> Source code in <code>fastauth/core/sessions.py</code> <pre><code>def create_session(\n    *,\n    sessions: SessionAdapter,\n    users: UserAdapter,\n    user_id: uuid.UUID,\n    device: str | None = None,\n    ip_address: str | None = None,\n    user_agent: str | None = None,\n):\n    \"\"\"\n    Create a new session for a user.\n\n    Args:\n        sessions: Session adapter for database operations\n        users: User adapter for database operations\n        user_id: User's unique identifier\n        device: Device information\n        ip_address: IP address of the client\n        user_agent: User agent string\n\n    Returns:\n        Created session object\n    \"\"\"\n    session = sessions.create_session(\n        user_id=user_id,\n        device=device,\n        ip_address=ip_address,\n        user_agent=user_agent,\n    )\n\n    users.update_last_login(user_id=user_id)\n\n    return session\n</code></pre>"},{"location":"reference/core/sessions/#fastauth.core.sessions.get_user_sessions","title":"get_user_sessions","text":"<pre><code>get_user_sessions(*, sessions: SessionAdapter, user_id: UUID)\n</code></pre> <p>Get all active sessions for a user.</p> <p>Parameters:</p> Name Type Description Default <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <p>Returns:</p> Type Description <p>List of session objects</p> Source code in <code>fastauth/core/sessions.py</code> <pre><code>def get_user_sessions(\n    *,\n    sessions: SessionAdapter,\n    user_id: uuid.UUID,\n):\n    \"\"\"\n    Get all active sessions for a user.\n\n    Args:\n        sessions: Session adapter for database operations\n        user_id: User's unique identifier\n\n    Returns:\n        List of session objects\n    \"\"\"\n    return sessions.get_user_sessions(user_id)\n</code></pre>"},{"location":"reference/core/sessions/#fastauth.core.sessions.delete_session","title":"delete_session","text":"<pre><code>delete_session(\n    *, sessions: SessionAdapter, session_id: UUID, user_id: UUID\n) -&gt; None\n</code></pre> <p>Delete a specific session.</p> <p>Parameters:</p> Name Type Description Default <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>session_id</code> <code>UUID</code> <p>Session's unique identifier</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier (for authorization)</p> required <p>Raises:</p> Type Description <code>SessionNotFoundError</code> <p>If session doesn't exist or doesn't belong to user</p> Source code in <code>fastauth/core/sessions.py</code> <pre><code>def delete_session(\n    *,\n    sessions: SessionAdapter,\n    session_id: uuid.UUID,\n    user_id: uuid.UUID,\n) -&gt; None:\n    \"\"\"\n    Delete a specific session.\n\n    Args:\n        sessions: Session adapter for database operations\n        session_id: Session's unique identifier\n        user_id: User's unique identifier (for authorization)\n\n    Raises:\n        SessionNotFoundError: If session doesn't exist or doesn't belong to user\n    \"\"\"\n    session = sessions.get_session_by_id(session_id)\n\n    if not session or session.user_id != user_id:\n        raise SessionNotFoundError(\"Session not found\")\n\n    sessions.delete_session(session_id)\n</code></pre>"},{"location":"reference/core/sessions/#fastauth.core.sessions.delete_all_user_sessions","title":"delete_all_user_sessions","text":"<pre><code>delete_all_user_sessions(\n    *,\n    sessions: SessionAdapter,\n    user_id: UUID,\n    except_session_id: UUID | None = None\n) -&gt; None\n</code></pre> <p>Delete all sessions for a user, optionally excluding the current session.</p> <p>Parameters:</p> Name Type Description Default <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>user_id</code> <code>UUID</code> <p>User's unique identifier</p> required <code>except_session_id</code> <code>UUID | None</code> <p>Optional session ID to keep (current session)</p> <code>None</code> Source code in <code>fastauth/core/sessions.py</code> <pre><code>def delete_all_user_sessions(\n    *,\n    sessions: SessionAdapter,\n    user_id: uuid.UUID,\n    except_session_id: uuid.UUID | None = None,\n) -&gt; None:\n    \"\"\"\n    Delete all sessions for a user, optionally excluding the current session.\n\n    Args:\n        sessions: Session adapter for database operations\n        user_id: User's unique identifier\n        except_session_id: Optional session ID to keep (current session)\n    \"\"\"\n    sessions.delete_user_sessions(\n        user_id=user_id,\n        except_session_id=except_session_id,\n    )\n</code></pre>"},{"location":"reference/core/sessions/#fastauth.core.sessions.update_session_activity","title":"update_session_activity","text":"<pre><code>update_session_activity(*, sessions: SessionAdapter, session_id: UUID) -&gt; None\n</code></pre> <p>Update the last active timestamp for a session.</p> <p>Parameters:</p> Name Type Description Default <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>session_id</code> <code>UUID</code> <p>Session's unique identifier</p> required Source code in <code>fastauth/core/sessions.py</code> <pre><code>def update_session_activity(\n    *,\n    sessions: SessionAdapter,\n    session_id: uuid.UUID,\n) -&gt; None:\n    \"\"\"\n    Update the last active timestamp for a session.\n\n    Args:\n        sessions: Session adapter for database operations\n        session_id: Session's unique identifier\n    \"\"\"\n    sessions.update_last_active(session_id)\n</code></pre>"},{"location":"reference/core/sessions/#fastauth.core.sessions.cleanup_inactive_sessions","title":"cleanup_inactive_sessions","text":"<pre><code>cleanup_inactive_sessions(\n    *, sessions: SessionAdapter, inactive_days: int = 30\n) -&gt; None\n</code></pre> <p>Remove sessions that haven't been active for a specified number of days.</p> <p>Parameters:</p> Name Type Description Default <code>sessions</code> <code>SessionAdapter</code> <p>Session adapter for database operations</p> required <code>inactive_days</code> <code>int</code> <p>Number of days of inactivity before cleanup (default: 30)</p> <code>30</code> Source code in <code>fastauth/core/sessions.py</code> <pre><code>def cleanup_inactive_sessions(\n    *,\n    sessions: SessionAdapter,\n    inactive_days: int = 30,\n) -&gt; None:\n    \"\"\"\n    Remove sessions that haven't been active for a specified number of days.\n\n    Args:\n        sessions: Session adapter for database operations\n        inactive_days: Number of days of inactivity before cleanup (default: 30)\n    \"\"\"\n    sessions.cleanup_inactive_sessions(inactive_days)\n</code></pre>"},{"location":"reference/core/users/","title":"Users","text":""},{"location":"reference/core/users/#fastauth.core.users","title":"users","text":""},{"location":"reference/core/users/#fastauth.core.users-classes","title":"Classes","text":""},{"location":"reference/core/users/#fastauth.core.users.UserAlreadyExistsError","title":"UserAlreadyExistsError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when trying to create a user with an existing email.</p>"},{"location":"reference/core/users/#fastauth.core.users.InvalidCredentialsError","title":"InvalidCredentialsError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when login credentials are invalid.</p>"},{"location":"reference/core/users/#fastauth.core.users.EmailNotVerifiedError","title":"EmailNotVerifiedError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when email is not verified</p>"},{"location":"reference/core/users/#fastauth.core.users-functions","title":"Functions","text":""},{"location":"reference/core/users/#fastauth.core.users.create_user","title":"create_user","text":"<pre><code>create_user(*, users: UserAdapter, email: str, password: str)\n</code></pre> <p>Create a new user with a hashed password.</p> <p>Parameters:</p> Name Type Description Default <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>email</code> <code>str</code> <p>User's email address</p> required <code>password</code> <code>str</code> <p>Plain text password (will be hashed)</p> required <p>Returns:</p> Type Description <p>Created user object</p> <p>Raises:</p> Type Description <code>UserAlreadyExistsError</code> <p>If a user with the email already exists</p> Source code in <code>fastauth/core/users.py</code> <pre><code>def create_user(\n    *,\n    users: UserAdapter,\n    email: str,\n    password: str,\n):\n    \"\"\"\n    Create a new user with a hashed password.\n\n    Args:\n        users: User adapter for database operations\n        email: User's email address\n        password: Plain text password (will be hashed)\n\n    Returns:\n        Created user object\n\n    Raises:\n        UserAlreadyExistsError: If a user with the email already exists\n    \"\"\"\n\n    existing_user = users.get_by_email(email=email)\n\n    if existing_user:\n        raise UserAlreadyExistsError(f\"User with email {email} already exists\")\n\n    user = users.create_user(email=email, hashed_password=hash_password(password))\n\n    return user\n</code></pre>"},{"location":"reference/core/users/#fastauth.core.users.authenticate_user","title":"authenticate_user","text":"<pre><code>authenticate_user(*, users: UserAdapter, email: str, password: str)\n</code></pre> <p>Authenticate a user by email and password.</p> <p>Parameters:</p> Name Type Description Default <code>users</code> <code>UserAdapter</code> <p>User adapter for database operations</p> required <code>email</code> <code>str</code> <p>User's email address</p> required <code>password</code> <code>str</code> <p>Plain text password to verify</p> required <p>Returns:</p> Type Description <p>Authenticated user object</p> <p>Raises:</p> Type Description <code>InvalidCredentialsError</code> <p>If email doesn't exist, password is wrong,             or user is inactive</p> <code>EmailNotVerifiedError</code> <p>If email verification is required but not completed</p> Source code in <code>fastauth/core/users.py</code> <pre><code>def authenticate_user(\n    *,\n    users: UserAdapter,\n    email: str,\n    password: str,\n):\n    \"\"\"\n    Authenticate a user by email and password.\n\n    Args:\n        users: User adapter for database operations\n        email: User's email address\n        password: Plain text password to verify\n\n    Returns:\n        Authenticated user object\n\n    Raises:\n        InvalidCredentialsError: If email doesn't exist, password is wrong, \\\n            or user is inactive\n        EmailNotVerifiedError: If email verification is required but not completed\n    \"\"\"\n\n    user = users.get_by_email(email=email)\n\n    if not user:\n        raise InvalidCredentialsError(\"Invalid email or password\")\n\n    if not verify_password(user.hashed_password, password):\n        raise InvalidCredentialsError\n\n    if settings.require_email_verification and not user.is_verified:\n        raise EmailNotVerifiedError\n\n    if not user.is_active:\n        raise InvalidCredentialsError(\"User is inactive\")\n\n    return user\n</code></pre>"},{"location":"reference/email/base/","title":"Base","text":""},{"location":"reference/email/base/#fastauth.email.base","title":"base","text":""},{"location":"reference/email/console/","title":"Console","text":""},{"location":"reference/email/console/#fastauth.email.console","title":"console","text":""},{"location":"reference/email/factory/","title":"Factory","text":""},{"location":"reference/email/factory/#fastauth.email.factory","title":"factory","text":""},{"location":"reference/email/smtp/","title":"Smtp","text":""},{"location":"reference/email/smtp/#fastauth.email.smtp","title":"smtp","text":""},{"location":"reference/providers/base/","title":"Base","text":""},{"location":"reference/providers/base/#fastauth.providers.base","title":"base","text":""},{"location":"reference/providers/base/#fastauth.providers.base-classes","title":"Classes","text":""},{"location":"reference/providers/base/#fastauth.providers.base.OAuthUserInfo","title":"OAuthUserInfo  <code>dataclass</code>","text":"<pre><code>OAuthUserInfo(\n    provider_user_id: str,\n    email: str,\n    email_verified: bool,\n    name: str | None = None,\n    avatar_url: str | None = None,\n)\n</code></pre> <p>User information returned from OAuth provider.</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthTokens","title":"OAuthTokens  <code>dataclass</code>","text":"<pre><code>OAuthTokens(\n    access_token: str,\n    refresh_token: str | None = None,\n    expires_in: int | None = None,\n    token_type: str = \"Bearer\",\n)\n</code></pre> <p>Tokens returned from OAuth provider.</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider","title":"OAuthProvider","text":"<p>             Bases: <code>ABC</code></p> <p>Abstract base class for OAuth providers.</p> <p>Each provider (Google, GitHub, etc.) implements this interface.</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider-attributes","title":"Attributes","text":""},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.name","title":"name  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>name: str\n</code></pre> <p>Provider name (e.g., 'google', 'github').</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.authorization_endpoint","title":"authorization_endpoint  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>authorization_endpoint: str\n</code></pre> <p>OAuth authorization URL.</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.token_endpoint","title":"token_endpoint  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>token_endpoint: str\n</code></pre> <p>OAuth token exchange URL.</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.user_info_endpoint","title":"user_info_endpoint  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>user_info_endpoint: str\n</code></pre> <p>User info API endpoint.</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.default_scopes","title":"default_scopes  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>default_scopes: str\n</code></pre> <p>Default OAuth scopes (space-separated).</p>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider-functions","title":"Functions","text":""},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.exchange_code_for_tokens","title":"exchange_code_for_tokens  <code>abstractmethod</code> <code>async</code>","text":"<pre><code>exchange_code_for_tokens(\n    *, code: str, redirect_uri: str, code_verifier: str | None = None\n) -&gt; OAuthTokens\n</code></pre> <p>Exchange authorization code for access/refresh tokens.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>str</code> <p>Authorization code from callback</p> required <code>redirect_uri</code> <code>str</code> <p>Redirect URI used in authorization</p> required <code>code_verifier</code> <code>str | None</code> <p>Optional PKCE code verifier</p> <code>None</code> <p>Returns:</p> Type Description <code>OAuthTokens</code> <p>OAuthTokens with access token and optional refresh token</p> Source code in <code>fastauth/providers/base.py</code> <pre><code>@abstractmethod\nasync def exchange_code_for_tokens(\n    self,\n    *,\n    code: str,\n    redirect_uri: str,\n    code_verifier: str | None = None,\n) -&gt; OAuthTokens:\n    \"\"\"\n    Exchange authorization code for access/refresh tokens.\n\n    Args:\n        code: Authorization code from callback\n        redirect_uri: Redirect URI used in authorization\n        code_verifier: Optional PKCE code verifier\n\n    Returns:\n        OAuthTokens with access token and optional refresh token\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.get_user_info","title":"get_user_info  <code>abstractmethod</code> <code>async</code>","text":"<pre><code>get_user_info(*, access_token: str) -&gt; OAuthUserInfo\n</code></pre> <p>Fetch user information using access token.</p> <p>Parameters:</p> Name Type Description Default <code>access_token</code> <code>str</code> <p>OAuth access token</p> required <p>Returns:</p> Type Description <code>OAuthUserInfo</code> <p>OAuthUserInfo with user profile data</p> Source code in <code>fastauth/providers/base.py</code> <pre><code>@abstractmethod\nasync def get_user_info(self, *, access_token: str) -&gt; OAuthUserInfo:\n    \"\"\"\n    Fetch user information using access token.\n\n    Args:\n        access_token: OAuth access token\n\n    Returns:\n        OAuthUserInfo with user profile data\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/providers/base/#fastauth.providers.base.OAuthProvider.refresh_access_token","title":"refresh_access_token  <code>abstractmethod</code> <code>async</code>","text":"<pre><code>refresh_access_token(*, refresh_token: str) -&gt; OAuthTokens\n</code></pre> <p>Refresh access token using refresh token.</p> <p>Parameters:</p> Name Type Description Default <code>refresh_token</code> <code>str</code> <p>OAuth refresh token</p> required <p>Returns:</p> Type Description <code>OAuthTokens</code> <p>OAuthTokens with new access token</p> Source code in <code>fastauth/providers/base.py</code> <pre><code>@abstractmethod\nasync def refresh_access_token(self, *, refresh_token: str) -&gt; OAuthTokens:\n    \"\"\"\n    Refresh access token using refresh token.\n\n    Args:\n        refresh_token: OAuth refresh token\n\n    Returns:\n        OAuthTokens with new access token\n    \"\"\"\n    ...\n</code></pre>"},{"location":"reference/providers/google/","title":"Google","text":""},{"location":"reference/providers/google/#fastauth.providers.google","title":"google","text":""},{"location":"reference/providers/google/#fastauth.providers.google-classes","title":"Classes","text":""},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider","title":"GoogleOAuthProvider","text":"<pre><code>GoogleOAuthProvider(*, client_id: str, client_secret: str)\n</code></pre> <p>             Bases: <code>OAuthProvider</code></p> <p>Google OAuth 2.0 provider implementation.</p> <p>Uses Google's OAuth 2.0 endpoints for authorization code flow. Supports PKCE and refresh tokens.</p> <p>Initialize Google OAuth provider.</p> <p>Parameters:</p> Name Type Description Default <code>client_id</code> <code>str</code> <p>Google OAuth client ID</p> required <code>client_secret</code> <code>str</code> <p>Google OAuth client secret</p> required Source code in <code>fastauth/providers/google.py</code> <pre><code>def __init__(self, *, client_id: str, client_secret: str):\n    \"\"\"\n    Initialize Google OAuth provider.\n\n    Args:\n        client_id: Google OAuth client ID\n        client_secret: Google OAuth client secret\n    \"\"\"\n    self.client_id = client_id\n    self.client_secret = client_secret\n</code></pre>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider-attributes","title":"Attributes","text":""},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.name","title":"name  <code>property</code>","text":"<pre><code>name: str\n</code></pre> <p>Provider name.</p>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.authorization_endpoint","title":"authorization_endpoint  <code>property</code>","text":"<pre><code>authorization_endpoint: str\n</code></pre> <p>Google OAuth authorization URL.</p>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.token_endpoint","title":"token_endpoint  <code>property</code>","text":"<pre><code>token_endpoint: str\n</code></pre> <p>Google OAuth token exchange URL.</p>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.user_info_endpoint","title":"user_info_endpoint  <code>property</code>","text":"<pre><code>user_info_endpoint: str\n</code></pre> <p>Google user info API endpoint.</p>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.default_scopes","title":"default_scopes  <code>property</code>","text":"<pre><code>default_scopes: str\n</code></pre> <p>Default OAuth scopes for Google (space-separated).</p>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider-functions","title":"Functions","text":""},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.exchange_code_for_tokens","title":"exchange_code_for_tokens  <code>async</code>","text":"<pre><code>exchange_code_for_tokens(\n    *, code: str, redirect_uri: str, code_verifier: str | None = None\n) -&gt; OAuthTokens\n</code></pre> <p>Exchange authorization code for access/refresh tokens.</p> <p>Parameters:</p> Name Type Description Default <code>code</code> <code>str</code> <p>Authorization code from callback</p> required <code>redirect_uri</code> <code>str</code> <p>Redirect URI used in authorization</p> required <code>code_verifier</code> <code>str | None</code> <p>Optional PKCE code verifier</p> <code>None</code> <p>Returns:</p> Type Description <code>OAuthTokens</code> <p>OAuthTokens with access token and optional refresh token</p> <p>Raises:</p> Type Description <code>HTTPError</code> <p>If token exchange fails</p> Source code in <code>fastauth/providers/google.py</code> <pre><code>async def exchange_code_for_tokens(\n    self,\n    *,\n    code: str,\n    redirect_uri: str,\n    code_verifier: str | None = None,\n) -&gt; OAuthTokens:\n    \"\"\"\n    Exchange authorization code for access/refresh tokens.\n\n    Args:\n        code: Authorization code from callback\n        redirect_uri: Redirect URI used in authorization\n        code_verifier: Optional PKCE code verifier\n\n    Returns:\n        OAuthTokens with access token and optional refresh token\n\n    Raises:\n        httpx.HTTPError: If token exchange fails\n    \"\"\"\n    data = {\n        \"code\": code,\n        \"client_id\": self.client_id,\n        \"client_secret\": self.client_secret,\n        \"redirect_uri\": redirect_uri,\n        \"grant_type\": \"authorization_code\",\n    }\n\n    if code_verifier:\n        data[\"code_verifier\"] = code_verifier\n\n    async with httpx.AsyncClient() as client:\n        response = await client.post(self.token_endpoint, data=data)\n        response.raise_for_status()\n        token_data = response.json()\n\n    return OAuthTokens(\n        access_token=token_data[\"access_token\"],\n        refresh_token=token_data.get(\"refresh_token\"),\n        expires_in=token_data.get(\"expires_in\"),\n        token_type=token_data.get(\"token_type\", \"Bearer\"),\n    )\n</code></pre>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.get_user_info","title":"get_user_info  <code>async</code>","text":"<pre><code>get_user_info(*, access_token: str) -&gt; OAuthUserInfo\n</code></pre> <p>Fetch user information using access token.</p> <p>Parameters:</p> Name Type Description Default <code>access_token</code> <code>str</code> <p>OAuth access token</p> required <p>Returns:</p> Type Description <code>OAuthUserInfo</code> <p>OAuthUserInfo with user profile data</p> <p>Raises:</p> Type Description <code>HTTPError</code> <p>If user info fetch fails</p> Source code in <code>fastauth/providers/google.py</code> <pre><code>async def get_user_info(self, *, access_token: str) -&gt; OAuthUserInfo:\n    \"\"\"\n    Fetch user information using access token.\n\n    Args:\n        access_token: OAuth access token\n\n    Returns:\n        OAuthUserInfo with user profile data\n\n    Raises:\n        httpx.HTTPError: If user info fetch fails\n    \"\"\"\n    headers = {\"Authorization\": f\"Bearer {access_token}\"}\n\n    async with httpx.AsyncClient() as client:\n        response = await client.get(self.user_info_endpoint, headers=headers)\n        response.raise_for_status()\n        user_data = response.json()\n\n    return OAuthUserInfo(\n        provider_user_id=user_data[\"id\"],\n        email=user_data[\"email\"],\n        email_verified=user_data.get(\"verified_email\", False),\n        name=user_data.get(\"name\"),\n        avatar_url=user_data.get(\"picture\"),\n    )\n</code></pre>"},{"location":"reference/providers/google/#fastauth.providers.google.GoogleOAuthProvider.refresh_access_token","title":"refresh_access_token  <code>async</code>","text":"<pre><code>refresh_access_token(*, refresh_token: str) -&gt; OAuthTokens\n</code></pre> <p>Refresh access token using refresh token.</p> <p>Parameters:</p> Name Type Description Default <code>refresh_token</code> <code>str</code> <p>OAuth refresh token</p> required <p>Returns:</p> Type Description <code>OAuthTokens</code> <p>OAuthTokens with new access token</p> <p>Raises:</p> Type Description <code>HTTPError</code> <p>If token refresh fails</p> Source code in <code>fastauth/providers/google.py</code> <pre><code>async def refresh_access_token(self, *, refresh_token: str) -&gt; OAuthTokens:\n    \"\"\"\n    Refresh access token using refresh token.\n\n    Args:\n        refresh_token: OAuth refresh token\n\n    Returns:\n        OAuthTokens with new access token\n\n    Raises:\n        httpx.HTTPError: If token refresh fails\n    \"\"\"\n    data = {\n        \"refresh_token\": refresh_token,\n        \"client_id\": self.client_id,\n        \"client_secret\": self.client_secret,\n        \"grant_type\": \"refresh_token\",\n    }\n\n    async with httpx.AsyncClient() as client:\n        response = await client.post(self.token_endpoint, data=data)\n        response.raise_for_status()\n        token_data = response.json()\n\n    return OAuthTokens(\n        access_token=token_data[\"access_token\"],\n        refresh_token=token_data.get(\"refresh_token\"),\n        expires_in=token_data.get(\"expires_in\"),\n        token_type=token_data.get(\"token_type\", \"Bearer\"),\n    )\n</code></pre>"},{"location":"reference/security/email_verification/","title":"Email Verification","text":""},{"location":"reference/security/email_verification/#fastauth.security.email_verification","title":"email_verification","text":""},{"location":"reference/security/jwt/","title":"Jwt","text":""},{"location":"reference/security/jwt/#fastauth.security.jwt","title":"jwt","text":""},{"location":"reference/security/jwt/#fastauth.security.jwt-classes","title":"Classes","text":""},{"location":"reference/security/jwt/#fastauth.security.jwt.TokenError","title":"TokenError","text":"<p>             Bases: <code>Exception</code></p> <p>Raised when a token is invalid or expired.</p>"},{"location":"reference/security/jwt/#fastauth.security.jwt-functions","title":"Functions","text":""},{"location":"reference/security/jwt/#fastauth.security.jwt.create_access_token","title":"create_access_token","text":"<pre><code>create_access_token(\n    *,\n    subject: str,\n    expires_delta: timedelta | None = None,\n    extra_claims: dict[str, Any] | None = None\n) -&gt; str\n</code></pre> <p>Create a JWT access token.</p> <p>subject: usually user.id</p> Source code in <code>fastauth/security/jwt.py</code> <pre><code>def create_access_token(\n    *,\n    subject: str,\n    expires_delta: timedelta | None = None,\n    extra_claims: dict[str, Any] | None = None,\n) -&gt; str:\n    \"\"\"\n    Create a JWT access token.\n\n    subject: usually user.id\n    \"\"\"\n    expire = datetime.now(UTC) + (\n        expires_delta\n        if expires_delta\n        else timedelta(minutes=settings.access_token_expire_minutes)\n    )\n\n    payload: dict[str, Any] = {\n        \"sub\": subject,\n        \"exp\": expire,\n        \"iat\": datetime.now(UTC),\n    }\n\n    if extra_claims:\n        payload.update(extra_claims)\n\n    encoded_jwt = jwt.encode(\n        payload,\n        settings.jwt_secret_key,\n        algorithm=settings.jwt_algorithm,\n    )\n\n    return encoded_jwt\n</code></pre>"},{"location":"reference/security/jwt/#fastauth.security.jwt.decode_access_token","title":"decode_access_token","text":"<pre><code>decode_access_token(token: str) -&gt; dict[str, Any]\n</code></pre> <p>Decode and validate a JWT access token.</p> Source code in <code>fastauth/security/jwt.py</code> <pre><code>def decode_access_token(token: str) -&gt; dict[str, Any]:\n    \"\"\"\n    Decode and validate a JWT access token.\n    \"\"\"\n    try:\n        payload = jwt.decode(\n            token,\n            settings.jwt_secret_key,\n            algorithms=[settings.jwt_algorithm],\n        )\n        return payload\n    except JWTError as exc:\n        raise TokenError(\"Invalid or expired token\") from exc\n</code></pre>"},{"location":"reference/security/limits/","title":"Limits","text":""},{"location":"reference/security/limits/#fastauth.security.limits","title":"limits","text":""},{"location":"reference/security/limits/#fastauth.security.limits-classes","title":"Classes","text":""},{"location":"reference/security/oauth/","title":"Oauth","text":""},{"location":"reference/security/oauth/#fastauth.security.oauth","title":"oauth","text":""},{"location":"reference/security/oauth/#fastauth.security.oauth-functions","title":"Functions","text":""},{"location":"reference/security/oauth/#fastauth.security.oauth.generate_state_token","title":"generate_state_token","text":"<pre><code>generate_state_token() -&gt; str\n</code></pre> <p>Generate a cryptographically secure state token for CSRF protection.</p> <p>Uses same pattern as refresh tokens.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL-safe random token string</p> Source code in <code>fastauth/security/oauth.py</code> <pre><code>def generate_state_token() -&gt; str:\n    \"\"\"\n    Generate a cryptographically secure state token for CSRF protection.\n\n    Uses same pattern as refresh tokens.\n\n    Returns:\n        URL-safe random token string\n    \"\"\"\n    return secrets.token_urlsafe(48)\n</code></pre>"},{"location":"reference/security/oauth/#fastauth.security.oauth.hash_state_token","title":"hash_state_token","text":"<pre><code>hash_state_token(token: str) -&gt; str\n</code></pre> <p>Hash state token before storing.</p> <p>Uses SHA-256 hashing like other tokens.</p> <p>Parameters:</p> Name Type Description Default <code>token</code> <code>str</code> <p>Raw state token</p> required <p>Returns:</p> Type Description <code>str</code> <p>Hexadecimal hash of the token</p> Source code in <code>fastauth/security/oauth.py</code> <pre><code>def hash_state_token(token: str) -&gt; str:\n    \"\"\"\n    Hash state token before storing.\n\n    Uses SHA-256 hashing like other tokens.\n\n    Args:\n        token: Raw state token\n\n    Returns:\n        Hexadecimal hash of the token\n    \"\"\"\n    return hashlib.sha256(token.encode()).hexdigest()\n</code></pre>"},{"location":"reference/security/oauth/#fastauth.security.oauth.hash_oauth_token","title":"hash_oauth_token","text":"<pre><code>hash_oauth_token(token: str) -&gt; str\n</code></pre> <p>Hash OAuth provider tokens before storing.</p> <p>We store provider access/refresh tokens hashed for security.</p> <p>Parameters:</p> Name Type Description Default <code>token</code> <code>str</code> <p>Raw OAuth token from provider</p> required <p>Returns:</p> Type Description <code>str</code> <p>Hexadecimal hash of the token</p> Source code in <code>fastauth/security/oauth.py</code> <pre><code>def hash_oauth_token(token: str) -&gt; str:\n    \"\"\"\n    Hash OAuth provider tokens before storing.\n\n    We store provider access/refresh tokens hashed for security.\n\n    Args:\n        token: Raw OAuth token from provider\n\n    Returns:\n        Hexadecimal hash of the token\n    \"\"\"\n    return hashlib.sha256(token.encode()).hexdigest()\n</code></pre>"},{"location":"reference/security/oauth/#fastauth.security.oauth.generate_code_verifier","title":"generate_code_verifier","text":"<pre><code>generate_code_verifier() -&gt; str\n</code></pre> <p>Generate a cryptographically random code verifier for PKCE.</p> <p>Per RFC 7636, the code verifier should be 43-128 characters. We use 64 bytes for good entropy (~86 characters base64url encoded).</p> <p>Returns:</p> Type Description <code>str</code> <p>URL-safe random string for PKCE code verifier</p> Source code in <code>fastauth/security/oauth.py</code> <pre><code>def generate_code_verifier() -&gt; str:\n    \"\"\"\n    Generate a cryptographically random code verifier for PKCE.\n\n    Per RFC 7636, the code verifier should be 43-128 characters.\n    We use 64 bytes for good entropy (~86 characters base64url encoded).\n\n    Returns:\n        URL-safe random string for PKCE code verifier\n    \"\"\"\n    return secrets.token_urlsafe(64)\n</code></pre>"},{"location":"reference/security/oauth/#fastauth.security.oauth.generate_code_challenge","title":"generate_code_challenge","text":"<pre><code>generate_code_challenge(verifier: str) -&gt; str\n</code></pre> <p>Generate S256 code challenge from verifier.</p> <p>Challenge = BASE64URL(SHA256(verifier))</p> <p>Parameters:</p> Name Type Description Default <code>verifier</code> <code>str</code> <p>Code verifier string</p> required <p>Returns:</p> Type Description <code>str</code> <p>Base64url-encoded SHA-256 hash of the verifier (without padding)</p> Source code in <code>fastauth/security/oauth.py</code> <pre><code>def generate_code_challenge(verifier: str) -&gt; str:\n    \"\"\"\n    Generate S256 code challenge from verifier.\n\n    Challenge = BASE64URL(SHA256(verifier))\n\n    Args:\n        verifier: Code verifier string\n\n    Returns:\n        Base64url-encoded SHA-256 hash of the verifier (without padding)\n    \"\"\"\n    digest = hashlib.sha256(verifier.encode()).digest()\n    challenge = base64.urlsafe_b64encode(digest).decode().rstrip(\"=\")\n    return challenge\n</code></pre>"},{"location":"reference/security/oauth/#fastauth.security.oauth.build_authorization_url","title":"build_authorization_url","text":"<pre><code>build_authorization_url(\n    *,\n    auth_endpoint: str,\n    client_id: str,\n    redirect_uri: str,\n    state: str,\n    scope: str,\n    code_challenge: str | None = None\n) -&gt; str\n</code></pre> <p>Build OAuth authorization URL with PKCE support.</p> <p>Parameters:</p> Name Type Description Default <code>auth_endpoint</code> <code>str</code> <p>Provider's authorization endpoint URL</p> required <code>client_id</code> <code>str</code> <p>OAuth client ID</p> required <code>redirect_uri</code> <code>str</code> <p>Callback URL after authorization</p> required <code>state</code> <code>str</code> <p>State token for CSRF protection</p> required <code>scope</code> <code>str</code> <p>Space-separated list of OAuth scopes</p> required <code>code_challenge</code> <code>str | None</code> <p>Optional PKCE code challenge</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>Complete authorization URL with query parameters</p> Source code in <code>fastauth/security/oauth.py</code> <pre><code>def build_authorization_url(\n    *,\n    auth_endpoint: str,\n    client_id: str,\n    redirect_uri: str,\n    state: str,\n    scope: str,\n    code_challenge: str | None = None,\n) -&gt; str:\n    \"\"\"\n    Build OAuth authorization URL with PKCE support.\n\n    Args:\n        auth_endpoint: Provider's authorization endpoint URL\n        client_id: OAuth client ID\n        redirect_uri: Callback URL after authorization\n        state: State token for CSRF protection\n        scope: Space-separated list of OAuth scopes\n        code_challenge: Optional PKCE code challenge\n\n    Returns:\n        Complete authorization URL with query parameters\n    \"\"\"\n    params = {\n        \"client_id\": client_id,\n        \"redirect_uri\": redirect_uri,\n        \"response_type\": \"code\",\n        \"scope\": scope,\n        \"state\": state,\n        \"access_type\": \"offline\",  # Request refresh token\n    }\n\n    if code_challenge:\n        params[\"code_challenge\"] = code_challenge\n        params[\"code_challenge_method\"] = \"S256\"\n\n    return f\"{auth_endpoint}?{urlencode(params)}\"\n</code></pre>"},{"location":"reference/security/password_reset/","title":"Password Reset","text":""},{"location":"reference/security/password_reset/#fastauth.security.password_reset","title":"password_reset","text":""},{"location":"reference/security/rate_limit/","title":"Rate Limit","text":""},{"location":"reference/security/rate_limit/#fastauth.security.rate_limit","title":"rate_limit","text":""},{"location":"reference/security/rate_limit/#fastauth.security.rate_limit-classes","title":"Classes","text":""},{"location":"reference/security/rate_limit/#fastauth.security.rate_limit.RateLimiter","title":"RateLimiter","text":"<pre><code>RateLimiter(*, max_attempts: int, window_seconds: int)\n</code></pre> Source code in <code>fastauth/security/rate_limit.py</code> <pre><code>def __init__(\n    self,\n    *,\n    max_attempts: int,\n    window_seconds: int,\n):\n    self.max_attempts = max_attempts\n    self.window_seconds = window_seconds\n    self._store: dict[str, deque[float]] = defaultdict(deque)\n</code></pre>"},{"location":"reference/security/rate_limit/#fastauth.security.rate_limit.RateLimiter-functions","title":"Functions","text":""},{"location":"reference/security/rate_limit/#fastauth.security.rate_limit.RateLimiter.hit","title":"hit","text":"<pre><code>hit(key: str) -&gt; None\n</code></pre> <p>Register an attempt for a given key. Raises RateLimitExceeded if limit is exceeded.</p> Source code in <code>fastauth/security/rate_limit.py</code> <pre><code>def hit(self, key: str) -&gt; None:\n    \"\"\"\n    Register an attempt for a given key.\n    Raises RateLimitExceeded if limit is exceeded.\n    \"\"\"\n    now = time.time()\n    window_start = now - self.window_seconds\n\n    attempts = self._store[key]\n\n    while attempts and attempts[0] &lt; window_start:\n        attempts.popleft()\n\n    if len(attempts) &gt;= self.max_attempts:\n        raise RateLimitExceeded(\"Too many attempts\")\n\n    attempts.append(now)\n</code></pre>"},{"location":"reference/security/rate_limit/#fastauth.security.rate_limit.RateLimiter.reset","title":"reset","text":"<pre><code>reset(key: str) -&gt; None\n</code></pre> <p>Clear attempts after successful auth.</p> Source code in <code>fastauth/security/rate_limit.py</code> <pre><code>def reset(self, key: str) -&gt; None:\n    \"\"\"\n    Clear attempts after successful auth.\n    \"\"\"\n    self._store.pop(key, None)\n</code></pre>"},{"location":"reference/security/refresh/","title":"Refresh","text":""},{"location":"reference/security/refresh/#fastauth.security.refresh","title":"refresh","text":""},{"location":"reference/security/refresh/#fastauth.security.refresh-functions","title":"Functions","text":""},{"location":"reference/security/refresh/#fastauth.security.refresh.generate_refresh_token","title":"generate_refresh_token","text":"<pre><code>generate_refresh_token() -&gt; str\n</code></pre> <p>Generate a cryptographically secure refresh token.</p> Source code in <code>fastauth/security/refresh.py</code> <pre><code>def generate_refresh_token() -&gt; str:\n    \"\"\"\n    Generate a cryptographically secure refresh token.\n    \"\"\"\n    return secrets.token_urlsafe(48)\n</code></pre>"},{"location":"reference/security/refresh/#fastauth.security.refresh.hash_refresh_token","title":"hash_refresh_token","text":"<pre><code>hash_refresh_token(token: str) -&gt; str\n</code></pre> <p>Hash refresh token before storing.</p> Source code in <code>fastauth/security/refresh.py</code> <pre><code>def hash_refresh_token(token: str) -&gt; str:\n    \"\"\"\n    Hash refresh token before storing.\n    \"\"\"\n    return hashlib.sha256(token.encode()).hexdigest()\n</code></pre>"}]}